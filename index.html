<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>IELTS Listening Test</title>

  <!-- Optional: keep your XLSX helper block if you actually use it elsewhere -->
  <script type="text/javascript">
    var gk_isXlsx = false;
    var gk_xlsxFileLookup = {};
    var gk_fileData = {};
    function filledCell(cell) { return cell !== '' && cell != null; }
    function loadFileData(filename) {
      if (gk_isXlsx && gk_xlsxFileLookup[filename]) {
        try {
          var workbook = XLSX.read(gk_fileData[filename], { type: 'base64' });
          var firstSheetName = workbook.SheetNames[0];
          var worksheet = workbook.Sheets[firstSheetName];
          var jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1, blankrows: false, defval: '' });
          var filteredData = jsonData.filter(row => row.some(filledCell));
          var headerRowIndex = filteredData.findIndex((row, index) =>
            row.filter(filledCell).length >= filteredData[index + 1]?.filter(filledCell).length
          );
          if (headerRowIndex === -1 || headerRowIndex > 25) headerRowIndex = 0;
          var csv = XLSX.utils.aoa_to_sheet(filteredData.slice(headerRowIndex));
          csv = XLSX.utils.sheet_to_csv(csv, { header: 1 });
          return csv;
        } catch (e) { console.error(e); return ""; }
      }
      return gk_fileData[filename] || "";
    }
  </script>

  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
    body { background-color: #f5f7fa; color: #333; line-height: 1.6; padding: 20px; }
    .container { max-width: 1000px; margin: 0 auto; background: #fff; border-radius: 10px; box-shadow: 0 0 20px rgba(0,0,0,.1); overflow: hidden; }
    header { background: linear-gradient(135deg, #1a5276 0%, #2e86c1 100%); color: #fff; padding: 15px 20px; display: flex; justify-content: space-between; align-items: center; }
    h1 { font-size: 24px; font-weight: 600; }
    .page { padding: 20px; display: none; }
    #info-page { display: block; }
    .section-title { background-color: #eaf2f8; padding: 10px 15px; margin: 20px -20px 15px -20px; border-left: 5px solid #2e86c1; font-weight: 600; color: #1a5276; }
    .form-group { margin-bottom: 15px; }
    label { display: block; margin-bottom: 5px; font-weight: 500; }
    input[type="text"], input[type="date"], select { width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px; font-size: 16px; }
    .btn { background: #2e86c1; color: #fff; border: none; padding: 12px 20px; border-radius: 4px; cursor: pointer; font-size: 16px; font-weight: 500; transition: background .3s; }
    .btn:hover { background: #1a5276; }
    .btn-container { text-align: center; margin: 20px 0; }

    table { width: 100%; border-collapse: collapse; margin-bottom: 20px; }
    th, td { border: 1px solid #ddd; padding: 10px; text-align: left; }
    th { background-color: #f2f2f2; font-weight: 600; }

    /* Inline inputs used throughout */
    .inline-input { width: 80px; padding: 2px 5px; border: 1px solid #ccc; border-radius: 3px; display: inline-block; margin-left: 5px; font-size: 14px; height: 24px; vertical-align: middle; }

    /* Make Q1â€“Q5 smaller specifically */
    #q1, #q2, #q3, #q4, #q5 { width: 60px; padding: 2px 4px; font-size: 14px; height: 22px; }

    .compact-table input { width: 80px; padding: 4px 6px; font-size: 13px; height: 28px; margin: 0 3px; }
    .compact-table td { padding: 8px 10px; }

    .mcq-options, .radio-options { margin: 10px 0 20px 20px; }
    .mcq-option, .radio-option { margin-bottom: 8px; display: flex; align-items: center; }
    .radio-option input[type="radio"], .mcq-option input[type="checkbox"] { margin-right: 8px; vertical-align: middle; }

    .instructions { background-color: #f9f9f9; padding: 10px 15px; border-left: 4px solid #2e86c1; margin: 15px 0; font-size: 14px; }
    .results-table { width: 100%; margin: 15px 0; }
    .results-table th { background-color: #eaf2f8; }
    .answer-cell { font-weight: 500; color: #1a5276; }
    .compact-results { max-height: 70vh; overflow-y: auto; }
    .section-divider { height: 1px; background-color: #ddd; margin: 25px 0; }

    .map-container { display: flex; margin: 20px 0; gap: 20px; }
    .map-image { flex: 1; background-color: #eaf2f8; border: 1px solid #ddd; border-radius: 4px; display: flex; align-items: center; justify-content: center; min-height: 300px; }
    .map-questions { flex: 1; }
    .map-question { margin-bottom: 15px; }

    .attitude-container { display: flex; gap: 20px; margin: 20px 0; }
    .attitude-box { flex: 1; }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>IELTS Listening Test</h1>
    </header>

    <!-- Candidate info page -->
    <div id="info-page" class="page">
      <h2>Candidate Information</h2>
      <div class="section-divider"></div>

      <div class="form-group">
        <label for="candidateName">Full Name:</label>
        <input type="text" id="candidateName" placeholder="Enter your full name" />
      </div>

      <div class="form-group">
        <label for="candidateNumber">Candidate Number:</label>
        <input type="text" id="candidateNumber" placeholder="Enter your candidate number" />
      </div>

      <div class="form-group">
        <label for="testModule">Test Module:</label>
        <select id="testModule">
          <option value="">Select Module</option>
          <option value="AC">Academic (AC)</option>
          <option value="GT">General Training (GT)</option>
        </select>
      </div>

      <div class="form-group">
        <label for="testDate">Test Date:</label>
        <input type="date" id="testDate" />
      </div>

      <div class="btn-container">
        <button id="start-test" class="btn">Start Test</button>
      </div>
    </div>

    <!-- Test page -->
    <div id="test-page" class="page">
      <div class="section-title">SECTION 1 Questions 1-10</div>
      <p>Complete the form below. Write <strong>ONE WORD AND/OR A NUMBER</strong> for each answer.</p>

      <table>
        <tr><th>Example</th><th>Answer</th></tr>
        <tr><td>Order from</td><td>winter catalogue</td></tr>
      </table>

      <p><strong>Name:</strong> <input type="text" id="q1" class="inline-input" placeholder="1" /> Greening</p>
      <p><strong>Address:</strong> <input type="text" id="q2" class="inline-input" placeholder="2" /> York Terrace</p>
      <p><strong>Delivery address:</strong> 5, York <input type="text" id="q3" class="inline-input" placeholder="3" /></p>
      <p><strong>Payment method:</strong> <input type="text" id="q4" class="inline-input" placeholder="4" /> in advance</p>
      <p><strong>Reason for discount:</strong> address within the <input type="text" id="q5" class="inline-input" placeholder="5" /></p>

      <p>Complete the table below. Write <strong>NO MORE THAN ONE WORD AND/OR A NUMBER</strong> for each answer.</p>

      <table class="compact-table">
        <tr>
          <th>Item</th>
          <th>Catalogue no.</th>
          <th>Catalogue section</th>
          <th>Colour</th>
          <th>Delivery notes</th>
        </tr>
        <tr>
          <td>desk lamp</td>
          <td>664</td>
          <td>6. <input type="text" id="q6" class="inline-input" /></td>
          <td>slate</td>
          <td>customer will 7. <input type="text" id="q7" class="inline-input" /></td>
        </tr>
        <tr>
          <td>chair</td>
          <td>131</td>
          <td>Home Office</td>
          <td>8. <input type="text" id="q8" class="inline-input" /></td>
          <td>our van</td>
        </tr>
        <tr>
          <td>filing cabinet two drawers with 9. <input type="text" id="q9" class="inline-input" /></td>
          <td>153</td>
          <td>Commercial</td>
          <td>grey</td>
          <td>Direct from London to later than 10. <input type="text" id="q10" class="inline-input" /></td>
        </tr>
      </table>

      <div class="section-title">SECTION 2 Questions 11-20</div>
      <p><strong>Questions 11 and 12</strong><br />Choose <strong>TWO</strong> letters <strong>A-E</strong>.<br />Which <strong>TWO</strong> things make the museum unusual?</p>

      <div class="mcq-options">
        <div class="mcq-option"><input type="checkbox" id="q11a" name="q11" value="A" /><label for="q11a">A the guides</label></div>
        <div class="mcq-option"><input type="checkbox" id="q11b" name="q11" value="B" /><label for="q11b">B the events</label></div>
        <div class="mcq-option"><input type="checkbox" id="q11c" name="q11" value="C" /><label for="q11c">C the animals</label></div>
        <div class="mcq-option"><input type="checkbox" id="q11d" name="q11" value="D" /><label for="q11d">D the buildings</label></div>
        <div class="mcq-option"><input type="checkbox" id="q11e" name="q11" value="E" /><label for="q11e">E the objects</label></div>
      </div>

      <p><strong>Questions 13 and 14</strong><br />Choose <strong>TWO</strong> letters <strong>A-E</strong>.<br />Which <strong>TWO</strong> things can visitors do at the museum?</p>

      <div class="mcq-options">
        <div class="mcq-option"><input type="checkbox" id="q13a" name="q13" value="A" /><label for="q13a">A buy home-made bread</label></div>
        <div class="mcq-option"><input type="checkbox" id="q13b" name="q13" value="B" /><label for="q13b">B ride a horse</label></div>
        <div class="mcq-option"><input type="checkbox" id="q13c" name="q13" value="C" /><label for="q13c">C ride on a tram</label></div>
        <div class="mcq-option"><input type="checkbox" id="q13d" name="q13" value="D" /><label for="q13d">D buy copies of original posters</label></div>
        <div class="mcq-option"><input type="checkbox" id="q13e" name="q13" value="E" /><label for="q13e">E go down a coal mine</label></div>
      </div>

      <p><strong>Questions 15-20</strong><br />Label the map below. Write the correct letter A-I next to questions 15-20.</p>

      <div class="map-container">
        <div class="map-image">
          <img src="https://github.com/kawsarahmedeeeee-png/Listening-/blob/79ff6d772902127af2562f13038e7fcb7f50eff1/Test-4-Q15-20.jpg" alt="Italian Trulli">
          <div style="text-align:center;color:#666;font-size:14px;">
            <div>A</div><div>B</div><div>C</div><div>D</div><div>E</div><div>F</div><div>G</div><div>H</div><div>I</div>
          </div>
        </div>
        <div class="map-questions">
          <div class="map-question">15 The exhibition centre
            <select id="q15" class="inline-input">
              <option value="">Select</option><option value="A">A</option><option value="B">B</option><option value="C">C</option><option value="D">D</option><option value="E">E</option><option value="F">F</option><option value="G">G</option><option value="H">H</option><option value="I">I</option>
            </select>
          </div>
          <div class="map-question">16 The High Street
            <select id="q16" class="inline-input">
              <option value="">Select</option><option value="A">A</option><option value="B">B</option><option value="C">C</option><option value="D">D</option><option value="E">E</option><option value="F">F</option><option value="G">G</option><option value="H">H</option><option value="I">I</option>
            </select>
          </div>
          <div class="map-question">17 The farmhouse
            <select id="q17" class="inline-input">
              <option value="">Select</option><option value="A">A</option><option value="B">B</option><option value="C">C</option><option value="D">D</option><option value="E">E</option><option value="F">F</option><option value="G">G</option><option value="H">H</option><option value="I">I</option>
            </select>
          </div>
          <div class="map-question">18 The coal mine
            <select id="q18" class="inline-input">
              <option value="">Select</option><option value="A">A</option><option value="B">B</option><option value="C">C</option><option value="D">D</option><option value="E">E</option><option value="F">F</option><option value="G">G</option><option value="H">H</option><option value="I">I</option>
            </select>
          </div>
          <div class="map-question">19 The Manor House
            <select id="q19" class="inline-input">
              <option value="">Select</option><option value="A">A</option><option value="B">B</option><option value="C">C</option><option value="D">D</option><option value="E">E</option><option value="F">F</option><option value="G">G</option><option value="H">H</option><option value="I">I</option>
            </select>
          </div>
          <div class="map-question">20 The Railway Station
            <select id="q20" class="inline-input">
              <option value="">Select</option><option value="A">A</option><option value="B">B</option><option value="C">C</option><option value="D">D</option><option value="E">E</option><option value="F">F</option><option value="G">G</option><option value="H">H</option><option value="I">I</option>
            </select>
          </div>
        </div>
      </div>

      <div class="section-title">SECTION 3 Questions 21-30</div>
      <p><strong>Questions 21-26</strong><br />Which attitude is associated with the following people during the conversation?<br />Choose SIX answers from the box and write the correct letter, A-H, next to questions 21-26.</p>

      <div class="attitude-container">
        <div class="attitude-box">
          <table>
            <tr><th>Attitudes</th></tr>
            <tr><td>A amused</td></tr>
            <tr><td>B critical</td></tr>
            <tr><td>C forgetful</td></tr>
            <tr><td>D impatient</td></tr>
            <tr><td>E polite</td></tr>
            <tr><td>F relaxed</td></tr>
            <tr><td>G sympathetic</td></tr>
            <tr><td>H unrealistic</td></tr>
          </table>
        </div>
        <div class="attitude-box">
          <p><strong>People</strong></p>
          <p>
            21 Cressida's fellow students
            <select id="q21" class="inline-input"><option value="">Select</option><option value="A">A</option><option value="B">B</option><option value="C">C</option><option value="D">D</option><option value="E">E</option><option value="F">F</option><option value="G">G</option><option value="H">H</option></select><br /><br />

            22 Cressida
            <select id="q22" class="inline-input"><option value="">Select</option><option value="A">A</option><option value="B">B</option><option value="C">C</option><option value="D">D</option><option value="E">E</option><option value="F">F</option><option value="G">G</option><option value="H">H</option></select><br /><br />

            23 Ainsley Webb
            <select id="q23" class="inline-input"><option value="">Select</option><option value="A">A</option><option value="B">B</option><option value="C">C</option><option value="D">D</option><option value="E">E</option><option value="F">F</option><option value="G">G</option><option value="H">H</option></select><br /><br />

            24 Dr Erskine
            <select id="q24" class="inline-input"><option value="">Select</option><option value="A">A</option><option value="B">B</option><option value="C">C</option><option value="D">D</option><option value="E">E</option><option value="F">F</option><option value="G">G</option><option value="H">H</option></select><br /><br />

            25 Professor Jenkins
            <select id="q25" class="inline-input"><option value="">Select</option><option value="A">A</option><option value="B">B</option><option value="C">C</option><option value="D">D</option><option value="E">E</option><option value="F">F</option><option value="G">G</option><option value="H">H</option></select><br /><br />

            26 TV news centre staff
            <select id="q26" class="inline-input"><option value="">Select</option><option value="A">A</option><option value="B">B</option><option value="C">C</option><option value="D">D</option><option value="E">E</option><option value="F">F</option><option value="G">G</option><option value="H">H</option></select>
          </p>
        </div>
      </div>

      <p><strong>Questions 27-30</strong><br />Choose the correct letter A, B or C.</p>

      <div class="radio-options">
        <p><strong>27</strong> What was Cressida asked to do at the beginning of her placement?</p>
        <div class="radio-option"><input type="radio" id="q27a" name="q27" value="A" /><label for="q27a">A go out to buy things for the production team</label></div>
        <div class="radio-option"><input type="radio" id="q27b" name="q27" value="B" /><label for="q27b">B run errands to other parts of the TV news centre</label></div>
        <div class="radio-option"><input type="radio" id="q27c" name="q27" value="C" /><label for="q27c">C meet visitors and escort them to the studio</label></div>
      </div>

      <div class="radio-options">
        <p><strong>28</strong> What was fortunate for Cressida?</p>
        <div class="radio-option"><input type="radio" id="q28a" name="q28" value="A" /><label for="q28a">A She was familiar with a piece of equipment.</label></div>
        <div class="radio-option"><input type="radio" id="q28b" name="q28" value="B" /><label for="q28b">B She spent a lot of time in the editing suite.</label></div>
        <div class="radio-option"><input type="radio" id="q28c" name="q28" value="C" /><label for="q28c">C She was given a chance to interview someone.</label></div>
      </div>

      <div class="radio-options">
        <p><strong>29</strong> What does Cressida feel she needs to improve?</p>
        <div class="radio-option"><input type="radio" id="q29a" name="q29" value="A" /><label for="q29a">A her understanding of business</label></div>
        <div class="radio-option"><input type="radio" id="q29b" name="q29" value="B" /><label for="q29b">B her organisational skills</label></div>
        <div class="radio-option"><input type="radio" id="q29c" name="q29" value="C" /><label for="q29c">C her ability to work in a team</label></div>
      </div>

      <div class="radio-options">
        <p><strong>30</strong> What has given her an idea for her final assignment?</p>
        <div class="radio-option"><input type="radio" id="q30a" name="q30" value="A" /><label for="q30a">A a meeting with a public relations professional</label></div>
        <div class="radio-option"><input type="radio" id="q30b" name="q30" value="B" /><label for="q30b">B seeing a politician speaking to an audience</label></div>
        <div class="radio-option"><input type="radio" id="q30c" name="q30" value="C" /><label for="q30c">C a disagreement with one of the TV presenters</label></div>
      </div>

      <div class="section-title">SECTION 4 Questions 31-40</div>
      <p>Complete the table below. Write <strong>NO MORE THAN TWO WORDS</strong> for each answer.</p>

      <table class="compact-table">
        <tr><th colspan="4">THE HISTORY OF THE ELECTRIC GUITAR</th></tr>
        <tr><th>DATE</th><th>MAKER</th><th>NAME OF GUITAR</th><th>FEATURES</th></tr>
        <tr><td>1890S</td><td>Orville Gibson</td><td>no name</td><td>similar in shape to a 31. <input type="text" id="q31" class="inline-input" /></td></tr>
        <tr><td>1925</td><td>John Dopyera</td><td>The National Guitar</td><td>made of metal, good for playing 32. <input type="text" id="q32" class="inline-input" /> music</td></tr>
        <tr><td>1930S</td><td>C.F. Martin Company</td><td>The Dreadnought</td><td>strings made of 33. <input type="text" id="q33" class="inline-input" /></td></tr>
        <tr><td>1931</td><td>George Beauchamp</td><td>The 34. <input type="text" id="q34" class="inline-input" /></td><td>used two 35. <input type="text" id="q35" class="inline-input" /> shaped like horseshoes to increase sound</td></tr>
        <tr><td>1935</td><td>Adolph Rickenbacker</td><td>The Rickenbacker Electro Spanish</td><td>made from 36. <input type="text" id="q36" class="inline-input" /></td></tr>
        <tr><td>1941</td><td>Les Paul</td><td>The log</td><td>the first to be completely 37. <input type="text" id="q37" class="inline-input" /></td></tr>
        <tr><td>1950</td><td>Leo Fender</td><td>The Fender Broadcaster</td><td>its simplicity made it ideal for 38. <input type="text" id="q38" class="inline-input" /></td></tr>
        <tr><td>1951</td><td>Leo Fender</td><td>The 39. <input type="text" id="q39" class="inline-input" /></td><td>easy to carry around</td></tr>
        <tr><td>1952</td><td>Ted McCarty</td><td>The Gibson Les Paul</td><td>40. <input type="text" id="q40" class="inline-input" /> in colour</td></tr>
        <tr><td>1954</td><td>Leo Fender</td><td>The Fender Stratocaster</td><td>double cutaway design</td></tr>
      </table>

      <div class="btn-container"><button id="submit-test" class="btn">Submit Test</button></div>
    </div>

    <!-- Results page -->
    <div id="results-page" class="page">
      <h2>Test Results</h2>
      <div class="section-divider"></div>

      <div id="candidate-results">
        <h3>Candidate Information</h3>
        <table>
          <tr><th>Name</th><th>Candidate Number</th><th>Test Module</th><th>Test Date</th></tr>
          <tr><td id="result-name"></td><td id="result-number"></td><td id="result-module"></td><td id="result-date"></td></tr>
        </table>
      </div>

      <div class="section-divider"></div>

      <h3>Your Answers</h3>
      <div class="compact-results">
        <table class="results-table">
          <tr><th>Question</th><th>Your Answer</th><th>Question</th><th>Your Answer</th></tr>
        </table>
      </div>

      <div class="btn-container"><button id="restart-test" class="btn">Restart Test</button></div>
    </div>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', function () {
      const infoPage = document.getElementById('info-page');
      const testPage = document.getElementById('test-page');
      const resultsPage = document.getElementById('results-page');
      const startTestBtn = document.getElementById('start-test');
      const submitTestBtn = document.getElementById('submit-test');
      const restartTestBtn = document.getElementById('restart-test');

      startTestBtn.addEventListener('click', function () {
        const name = document.getElementById('candidateName').value.trim();
        const number = document.getElementById('candidateNumber').value.trim();
        const module = document.getElementById('testModule').value;
        const date = document.getElementById('testDate').value;
        if (!name || !number || !module || !date) { alert('Please fill in all candidate information fields.'); return; }
        infoPage.style.display = 'none';
        testPage.style.display = 'block';
        window.scrollTo({ top: 0, behavior: 'smooth' });
      });

      submitTestBtn.addEventListener('click', function () {
        const q11Checks = document.querySelectorAll('input[name="q11"]:checked');
        const q13Checks = document.querySelectorAll('input[name="q13"]:checked');
        if (q11Checks.length !== 2) { alert('Please select exactly 2 options for Questions 11-12.'); return; }
        if (q13Checks.length !== 2) { alert('Please select exactly 2 options for Questions 13-14.'); return; }

        saveAnswers();
        document.getElementById('result-name').textContent = document.getElementById('candidateName').value;
        document.getElementById('result-number').textContent = document.getElementById('candidateNumber').value;
        document.getElementById('result-module').textContent = document.getElementById('testModule').value;
        document.getElementById('result-date').textContent = document.getElementById('testDate').value;
        displayAnswers();
        testPage.style.display = 'none';
        resultsPage.style.display = 'block';
        window.scrollTo({ top: 0, behavior: 'smooth' });
      });

      restartTestBtn.addEventListener('click', function () {
        document.getElementById('candidateName').value = '';
        document.getElementById('candidateNumber').value = '';
        document.getElementById('testModule').value = '';
        document.getElementById('testDate').value = '';
        const inputs = document.querySelectorAll('input, select');
        inputs.forEach(input => {
          if (input.type === 'checkbox' || input.type === 'radio') input.checked = false; else input.value = '';
        });
        localStorage.removeItem('testAnswers');
        resultsPage.style.display = 'none';
        infoPage.style.display = 'block';
        window.scrollTo({ top: 0, behavior: 'smooth' });
      });

      function saveAnswers() {
        const answers = {};
        for (let i = 1; i <= 40; i++) {
          const el = document.getElementById('q' + i);
          if (el) {
            if (el.tagName === 'SELECT') answers['q' + i] = el.value; else answers['q' + i] = el.value;
          }
        }
        const q11Options = document.querySelectorAll('input[name="q11"]:checked');
        answers['q11'] = Array.from(q11Options).map(o => o.value).sort().join(', ');
        const q13Options = document.querySelectorAll('input[name="q13"]:checked');
        answers['q13'] = Array.from(q13Options).map(o => o.value).sort().join(', ');
        for (let i = 27; i <= 30; i++) {
          const selected = document.querySelector(`input[name="q${i}"]:checked`);
          answers['q' + i] = selected ? selected.value : '';
        }
        localStorage.setItem('testAnswers', JSON.stringify(answers));
      }

      function displayAnswers() {
        const answers = JSON.parse(localStorage.getItem('testAnswers') || '{}');
        const resultsTable = document.querySelector('.results-table');
        while (resultsTable.rows.length > 1) resultsTable.deleteRow(1);
        for (let i = 1; i <= 20; i++) {
          const row = resultsTable.insertRow(-1);
          const c1 = row.insertCell(0); const c2 = row.insertCell(1); const c3 = row.insertCell(2); const c4 = row.insertCell(3);
          c1.textContent = i; c2.textContent = answers['q' + i] || '-'; c2.classList.add('answer-cell');
          const rightQ = i + 20; c3.textContent = rightQ; c4.textContent = answers['q' + rightQ] || '-'; c4.classList.add('answer-cell');
        }
      }
    });
  </script>
</body>
</html>
