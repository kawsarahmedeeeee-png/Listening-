    <!DOCTYPE html>
        <html lang="en">
        <head>
            <meta charset="UTF-8">
            <meta name="viewport" content="width=device-width, initial-scale=1.0">
            <title>IELTS CDI Listening Practice</title>
            <style>
                * {
                    margin: 0;
                    padding: 0;
                    box-sizing: border-box;
                }
                #deliver-button {
    pointer-events: none;
    opacity: 0.5;
    cursor: not-allowed;
}


                body {
                    font-family: Arial, sans-serif;
                    background-color: #ffffff;
                    line-height: 1.4;
                    font-size: 16px;
                    padding-bottom: 90px; /* nav-row height (80px) + some extra spacing */
                }

                .header {
                    background-color: #ffffff;
                    padding: 12px 20px;
                    border-bottom: 1px solid #e0e0e0;
                    display: flex;
                    justify-content: space-between;
                    align-items: center;
                    position: fixed;
                    top: 0;
                    left: 0;
                    right: 0;
                    z-index: 100;
                    height: 60px;
                }

                .ielts-logo {
                    display: none;
                }

                .test-info {
                    display: flex;
                    align-items: center;
                    gap: 30px;
                    font-size: 14px;
                    color: #333;
                }

                .audio-indicator {
                    display: flex;
                    align-items: center;
                    gap: 8px;
                    font-size: 16px;
                }

                .audio-icon {
                    width: 16px;
                    height: 16px;
                    background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"></polygon></svg>') no-repeat center;
                }

                .header-icons {
                    display: flex;
                    gap: 10px;
                    align-items: center;
                }

                

                #volume-slider {
                    -webkit-appearance: none;
                    width: 80px;
                    height: 4px;
                    background: #ddd;
                    outline: none;
                    border-radius: 2px;
                    cursor: pointer;
                }

                #volume-slider::-webkit-slider-thumb {
                    -webkit-appearance: none;
                    appearance: none;
                    width: 14px;
                    height: 14px;
                    border-radius: 50%;
                    background: #333;
                    cursor: pointer;
                }

                #volume-slider::-moz-range-thumb {
                    width: 14px;
                    height: 14px;
                    border-radius: 50%;
                    background: #333;
                    cursor: pointer;
                    border: none;
                }

                .icon {
                    width: 20px;
                    height: 20px;
                    cursor: pointer;
                    opacity: 0.7;
                    color: #333;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                }
                
                .icon:hover {
                    opacity: 1;
                }
                
                #play-pause-btn {
                    background: none;
                    border: none;
                    padding: 0;
                }

                .main-container {
                    margin-top: 60px;
                    display: flex;
                    background: #ffffff;
                    padding-bottom: 100px; /* Space for bottom nav */
                }

                /* Left Panel */
                .left-panel {
                    width: 100%;
                    padding: 20px;
                    transition: width 0.4s ease;
                }

                .main-container.results-mode .left-panel {
                    width: 50%;
                    overflow-y: auto;
                    height: calc(100vh - 195px);
                }

                /* Right Panel */
                .right-panel {
                    display: none;
                    width: 50%;
                    padding: 20px;
                    position: relative;
                    border-left: 1px solid #e0e0e0;
                    overflow-y: auto;
                    height: calc(100vh - 195px);
                }

                #transcription-container h2 {
                    font-size: 18px;
                    font-weight: bold;
                    margin-bottom: 10px;
                }

                #transcription-text {
                    white-space: pre-wrap;
                    font-family: inherit;
                    font-size: 15px;
                    line-height: 1.7;
                }
                
                .transcription-instruction {
                    display: block;
                    margin: 1em 0;
                    font-style: italic;
                    color: #444;
                }

                .main-container.results-mode .right-panel {
                    display: block;
                }

                .help-button {
                    background: #4a90e2;
                    color: white;
                    border: none;
                    padding: 6px 12px;
                    border-radius: 4px;
                    font-size: 14px;
                    cursor: pointer;
                    display: inline-flex;
                    align-items: center;
                    gap: 5px;
                    margin-bottom: 20px;
                }

                .correct-answer-text {
                    color: #28a745;
                    font-weight: bold;
                    margin-left: 10px;
                }

                .help-button:hover {
                    background: #357abd;
                }

                .section-title {
                    font-weight: bold;
                    margin-bottom: 15px;
                    font-size: 18px;
                }

                .people-section {
                    margin-bottom: 30px;
                }

                .people-table {
                    width: 100%;
                    border-collapse: collapse;
                    border: 1px solid #ccc;
                }

                .people-table th {
                    text-align: left;
                    padding: 10px;
                    font-weight: bold;
                    border: 1px solid #ddd;
                }

                .people-table td {
                    padding: 8px 10px;
                    border: 1px solid #ddd;
                }

                .person-name {
                    font-size: 16px;
                }

                .question-number {
                    background: white;
                    border: 1px solid #4a90e2;
                    padding: 4px 8px;
                    border-radius: 3px;
                    font-weight: bold;
                    font-size: 14px;
                    color: #4a90e2;
                    min-width: 30px;
                    text-align: center;
                }

                .assigned-responsibility {
                    background: #f0f0f0;
                    padding: 4px 8px;
                    border-radius: 3px;
                    font-size: 14px;
                    border: 1px solid #ddd;
                }

                .responsibilities-section {
                    margin-bottom: 30px;
                }

                .responsibility-grid {
                    display: grid;
                    grid-template-columns: repeat(3, 1fr);
                    gap: 8px;
                    margin-bottom: 20px;
                }

                .responsibility-item {
                    background: #f8f9fa;
                    border: 1px solid #ddd;
                    padding: 8px 12px;
                    border-radius: 4px;
                    cursor: move;
                    font-size: 16px;
                    text-align: center;
                    transition: all 0.2s;
                }

                .responsibility-item:hover {
                    background: #e9ecef;
                    transform: translateY(-1px);
                }

                .responsibility-item.dragging {
                    opacity: 0.5;
                    transform: rotate(2deg);
                }

                .questions-section {
                    margin-bottom: 20px;
                }

                .question-title {
                    font-weight: bold;
                    margin-bottom: 10px;
                    font-size: 16px;
                }

                .instruction {
                    margin-bottom: 20px;
                    font-size: 16px;
                    color: #666;
                }

                .centered-title {
                    text-align: center;
                    font-size: 20px;
                    font-weight: bold;
                    margin-bottom: 15px;
                }

                /* Map Styles */
                .map-container {
                    position: relative;
                    margin: 20px auto;
                    width: 100%;
                    max-width: 600px;
                    display: block;
                }
                .map-container img {
                    width: 100%;
                    display: block;
                }
                .map-drop-zone {
                    position: absolute;
                    width: 13%;
                    height: 15%;
                    border: 2px dashed #999;
                    background-color: rgba(255, 255, 255, 0.5);
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    font-weight: bold;
                    color: #555;
                    border-radius: 4px;
                    padding: 2px;
                }
                .map-drop-zone:hover {
                    background-color: rgba(230, 244, 255, 0.7);
                    border-color: #4a90e2;
                }
                .map-drop-zone .drag-item {
                    font-size: 14px;
                    width: 100%;
                    height: 100%;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    padding: 2px;
                }
                .map-options-list {
                    display: flex;
                    flex-wrap: wrap;
                    gap: 10px;
                    justify-content: center;
                    margin-top: 20px;
                    padding: 10px;
                    border: 1px solid #ddd;
                    border-radius: 5px;
                    background-color: #f9f9f9;
                }
                .map-options-list .drag-item {
                    width: calc(25% - 10px);
                    text-align: center;
                }

                /* Navigation Arrows */
                .nav-arrows {
                    position: fixed;
                    bottom: 100px;
                    right: 20px;
                    display: flex;
                    gap: 5px;
                    z-index: 101;
                }

                .nav-arrow {
                    width: 50px;
                    height: 50px;
                    background: #333;
                    color: white;
                    border: none;
                    cursor: pointer;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    font-size: 22px;
                    font-weight: bold;
                }

                .nav-arrow:hover {
                    background: #555;
                }

                .nav-arrow:disabled {
                    background: #ccc;
                    cursor: not-allowed;
                }

                /* Bottom Navigation - Exact Match */
                .nav-row {
                    position: fixed;
                    bottom: 0;
                    left: 0;
                    right: 0;
                    background: #ffffff;
                
                    padding: 0;
                    display: flex;
                    align-items: center;
                    height: 80px;
                    z-index: 100;

                    /* Allow horizontal scrolling on smaller screens */
                    overflow-x: auto;
                    overflow-y: hidden;
                    white-space: nowrap;
                    -webkit-overflow-scrolling: touch;
                }

                .footer__questionWrapper___1tZ46 {
                    display: flex;
                    align-items: center;
                    margin-right: 20px;
                    flex-shrink: 0;
                }


                .footer__questionNo___3WNct {
                    background: none;
                    border: none;
                    padding: 10px 15px;
                    font-size: 16px;
                    font-weight: 600;
                    color: #333;
                    cursor: pointer;
                    display: flex;
                    align-items: center;
                    gap: 5px;
                    transition: background-color 0.2s;
                }

                .footer__questionNo___3WNct:hover {
                    background-color: #f8f9fa;
                }

                .section-prefix {
                    font-size: 16px;
                }

                .sectionNr {
                    font-size: 16px;
                    font-weight: bold;
                }

                .attemptedCount {
                    font-size: 14px;
                    color: #666;
                    margin-left: 5px;
                    font-weight: 400; /* Normal weight */
                }

                @media (max-width: 1024px) {
                    .attemptedCount {
                        display: none;
                    }
                }

                .footer__questionWrapper___1tZ46.selected .attemptedCount {
                    display: none;
                }

                .footer__subquestionWrapper___9GgoP {
                    display: none;
                    gap: 2px;
                    margin-left: 10px;
                }

                .footer__questionWrapper___1tZ46.selected .footer__subquestionWrapper___9GgoP {
                    display: flex;
                }

                .subQuestion {
                    width: 32px;
                    height: 32px;
                    border: 1px solid #ccc;
                    background: white;
                    color: #333;
                    font-size: 14px;
                    font-weight: 500;
                    cursor: pointer;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    transition: all 0.2s;
                    border-radius: 2px;
                }

                .subQuestion.answered {
                    background-color: #e9ecef;
                    border-color: #ddd;
                }
                .subQuestion.correct {
                    background-color: #28a745;
                    color: white;
                    border-color: #28a745;
                }
                .subQuestion.incorrect {
                    background-color: #dc3545;
                    color: white;
                    border-color: #dc3545;
                }

                .subQuestion:hover {
                    background-color: #f0f0f0;
                    border-color: #999;
                }

                .subQuestion.active {
                    background-color: #4a90e2;
                    color: white;
                    border-color: #4a90e2;
                }

                .subQuestion.completed {
                    background-color: #28a745;
                    color: white;
                    border-color: #28a745;
                }

                .sr-only {
                    position: absolute;
                    width: 1px;
                    height: 1px;
                    padding: 0;
                    margin: -1px;
                    overflow: hidden;
                    clip: rect(0, 0, 0, 0);
                    white-space: nowrap;
                    border: 0;
                }

                .footer__deliverButton___3FM07 {
                    margin-left: auto;
                    margin-right: 20px;
                    background-color: #f0f0f0;
                    color: #333;
                    border: 1px solid #ccc;
                    padding: 12px 20px;
                    border-radius: 4px;
                    font-size: 16px;
                    font-weight: 600;
                    cursor: pointer;
                    display: flex;
                    align-items: center;
                    gap: 8px;
                    transition: background-color 0.2s, border-color 0.2s;
                    min-width: 170px;
                    justify-content: center;
                }

                .footer__deliverButton___3FM07:hover {
                    background-color: #e0e0e0;
                    border-color: #bbb;
                }

                .footer__deliverButton___3FM07:disabled {
                    background: #e9ecef;
                    color: #6c757d;
                    cursor: not-allowed;
                    border-color: #ddd;
                }

                .fa-check::before {
                    content: "✓";
                }

                .hidden {
                    display: none;
                }

                /* Context Menu */
                .context-menu {
                    position: absolute;
                    background: white;
                    border: 1px solid #ccc;
                    border-radius: 6px;
                    box-shadow: 0 4px 12px rgba(0,0,0,0.15);
                    z-index: 1000;
                    display: none;
                    min-width: 140px;
                }

                .context-menu-item {
                    padding: 12px 16px;
                    cursor: pointer;
                    font-size: 16px;
                    border-bottom: 1px solid #f0f0f0;
                    transition: background-color 0.2s;
                    display: flex;
                    align-items: center;
                    gap: 8px;
                }

                .context-menu-item:hover {
                    background-color: #f8f9fa;
                }

                .context-menu-item:last-child {
                    border-bottom: none;
                }

                .highlight {
                    background-color: #ffff00;
                }

                .comment-highlight {
                    background-color: #90EE90;
                    position: relative;
                    cursor: help;
                }

                .comment-tooltip {
                    position: absolute;
                    bottom: 100%;
                    left: 50%;
                    transform: translateX(-50%);
                    background: #333;
                    color: white;
                    padding: 8px 12px;
                    border-radius: 4px;
                    font-size: 14px;
                    white-space: nowrap;
                    z-index: 1000;
                    opacity: 0;
                    pointer-events: none;
                    transition: opacity 0.3s;
                }

                .comment-highlight:hover .comment-tooltip {
                    opacity: 1;
                }

                .question {
                    margin-bottom: 40px;
                }
                .question p {
                    margin-bottom: 10px;
                }
                .question ul, .question .people-table {
                    margin-top: 0;
                }
                .question-prompt {
                    margin-bottom: 20px;
                }
                .question ul {
                    list-style: none;
                    padding-left: 0;
                }
                .question ul li {
                    margin-bottom: 5px;
                }
                .answer-input {
                    border: 1px solid #888;
                    border-radius: 4px;
                    background-color: #fff;
                    padding: 2px 5px;
                    font-size: 16px;
                    text-align: center;
                    margin-right: 4px;
                    margin-left: 4px;
                    width: 150px;
                }
                .answer-input::placeholder {
                    color: #999;
                    font-weight: bold;
                    text-align: center;
                }
                .answer-input.correct {
                    border-color: #28a745;
                    background-color: #e9f7ef;
                }
                .answer-input.incorrect {
                    border-color: #dc3545;
                    background-color: #f8d7da;
                    color: #721c24;
                }
                .answer-input {
        z-index: 10;
        position: relative;
        pointer-events: auto;
    }
                .drag-drop-container {
                    display: flex;
                    gap: 30px;
                    margin-top: 20px;
                    align-items: flex-start;
                }
                .recommendations-box {
                    display: flex;
                    flex-direction: column;
                    gap: 8px;
                    padding: 10px;
                    border: 1px solid #ccc;
                    border-radius: 5px;
                    background-color: #f9f9f9;
                    min-height: 200px;
                }
                .drag-item {
                    background: white;
                    border: 1px solid #ddd;
                    padding: 6px 12px;
                    border-radius: 4px;
                    cursor: move;
                    font-size: 16px;
                    transition: all 0.2s;
                    user-select: none;
                }
                .drag-item:hover {
                    background: #e9ecef;
                }
                .drag-item.dragging {
                    opacity: 0.5;
                    transform: rotate(2deg);
                }
                .drop-zone {
                    border: 1px dashed #ccc;
                    border-radius: 4px;
                    height: 40px;
                    transition: background-color 0.2s, border-color 0.2s;
                    padding: 5px;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                }
                .drop-zone.drag-over {
                    background-color: #e6f4ff;
                    border-color: #4a90e2;
                }
                .drop-zone.correct {
                    background-color: #e9f7ef;
                    border-color: #28a745;
                    border-style: solid;
                }
                .drop-zone.incorrect {
                    background-color: #f8d7da;
                    border-color: #dc3545;
                    border-style: solid;
                }
                .drop-zone .drag-item {
                    cursor: default;
                }
                .drag-item.selected {
                    border-color: #4a90e2;
                    box-shadow: 0 0 0 1px #4a90e2;
                }
                .questions-container {
                    width: 50%;
                }
                audio {
                    width: 100%;
                    margin-bottom: 20px;
                }
                .part-header {
                    background-color: #f1f2ec;
                    padding: 15px;
                    border-radius: 5px;
                    margin-bottom: 20px;
                    border: 1px solid #e0e0e0;
                }
                .part-header p {
                    margin: 0;
                }

                .question li.correct {
                    color: #155724;
                    font-weight: bold;
                }
                .question li.incorrect {
                    color: #721c24;
                }
                .question li.correct::before {
                    content: '✔ ';
                    color: #28a745;
                }
                .question li.incorrect::before {
                    content: '✖ ';
                    color: #dc3545;
                }

                .example-box {
                    border: 1px solid #ddd;
                    background-color: #f9f9f9;
                    padding: 15px;
                    border-radius: 5px;
                    margin: 20px 0;
                }

                .timer-container {
                    display: none; /* Timer hidden */
                    color: #333;
                    font-size: 16px;
                    font-weight: 500;
                }
                .timer-container .timer-tooltip {
                    display: none;
                }

                .audio-modal-overlay {
                    position: fixed;
                    top: 0;
                    left: 0;
                    width: 100%;
                    height: 100%;
                    background-color: rgba(40, 40, 40, 0.9);
                    z-index: 2000;
                    display: flex;
                    justify-content: center;
                    align-items: center;
                    color: white;
                    text-align: center;
                }
                .audio-modal-content {
                    display: flex;
                    flex-direction: column;
                    align-items: center;
                    gap: 20px;
                    max-width: 500px;
                    padding: 20px;
                }
                .audio-modal-content p {
                    font-size: 16px;
                    line-height: 1.5;
                    color: #eee;
                }
                .audio-modal-icon {
                    margin-bottom: 20px;
                }
                .modal-play-btn {
                    background-color: #000;
                    color: white;
                    border: 1px solid white;
                    padding: 12px 24px;
                    border-radius: 6px;
                    font-size: 18px;
                    font-weight: 600;
                    cursor: pointer;
                    display: flex;
                    align-items: center;
                    gap: 8px;
                    transition: background-color 0.2s;
                }
                .modal-play-btn:hover {
                    background-color: #333;
                }
                #goto-widget {
                    display: flex;
                    align-items: center;
                    gap: 5px;
                }
                #goto-input {
                    width: 80px;
                    padding: 4px 8px;
                    border: 1px solid #ccc;
                    border-radius: 4px;
                }
                #goto-btn {
                    padding: 4px 10px;
                    border: 1px solid #ccc;
                    background-color: #f0f0f0;
                    border-radius: 4px;
                    cursor: pointer;
                }

                @keyframes flash {
                    0% { background-color: #e6f4ff; }
                    100% { background-color: transparent; }
                }

                .question.flash {
                    animation: flash 1s ease-out;
                }

                .modal-overlay {
                    position: fixed;
                    top: 0;
                    left: 0;
                    width: 100%;
                    height: 100%;
                    background-color: rgba(0,0,0,0.6);
                    z-index: 2000;
                    display: flex;
                    justify-content: center;
                    align-items: center;
                    padding: 20px;
                }
                .modal-content {
                    background: white;
                    padding: 25px;
                    border-radius: 8px;
                    width: 100%;
                    max-width: 800px;
                    max-height: 90vh;
                    overflow-y: auto;
                    box-shadow: 0 5px 15px rgba(0,0,0,0.3);
                }
                .modal-header {
                    display: flex;
                    justify-content: space-between;
                    align-items: center;
                    border-bottom: 1px solid #ddd;
                    padding-bottom: 15px;
                    margin-bottom: 20px;
                }
                .modal-header h2 {
                    font-size: 24px;
                    color: #333;
                }
                .modal-close-btn {
                    background: none;
                    border: none;
                    font-size: 28px;
                    cursor: pointer;
                    color: #888;
                    line-height: 1;
                }
                .modal-close-btn:hover {
                    color: #333;
                }
                #score-summary {
                    font-size: 18px;
                    font-weight: bold;
                    margin-bottom: 20px;
                }
                #result-details table {
                    width: 100%;
                    border-collapse: collapse;
                    font-size: 14px;
                }
                #result-details th, #result-details td {
                    border: 1px solid #ddd;
                    padding: 10px;
                    text-align: left;
                    vertical-align: middle;
                }
                #result-details th {
                    background-color: #f8f9fa;
                    font-weight: 600;
                }
                #result-details td:nth-child(1) {
                    font-weight: bold;
                    text-align: center;
                }
                .result-correct {
                    color: #28a745;
                    font-weight: bold;
                }
                .result-incorrect {
                    color: #dc3545;
                    font-weight: bold;
                }

                .context-menu-icon {
                    width: 16px;
                    height: 16px;
                    display: inline-block;
                    vertical-align: middle;
                    margin-right: 8px;
                }

                .matching-container {
                    display: flex;
                    justify-content: space-between;
                    gap: 40px;
                    margin-top: 20px;
                    align-items: flex-start;
                }
                .matching-table {
                    flex: 4;
                    border-collapse: collapse;
                }
                .matching-table th, .matching-table td {
                    border: 1px solid #ddd;
                    padding: 6px 12px;
                    text-align: left;
                    vertical-align: middle;
                }
                .matching-table th {
                    background-color: #f8f9fa;
                    font-weight: 600;
                }
                .matching-table .drop-zone {
                    height: 36px; /* narrower height to save space */
                    min-width: 240px; /* provide larger area to drop options */
                    padding: 5px;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    background-color: #fff;
                    border: 1px dashed #ccc;
                    border-radius: 4px;
                }
                .matching-table .drop-zone .drag-item {
                    width: 100%;
                    text-align: center;
                    padding: 4px 5px; /* reduce padding for narrower height */
                }
                .matching-options-list {
                    display: flex;
                    flex-direction: column;
                    gap: 10px;
                    flex: 1;
                    background-color: transparent;
                    padding: 0;
                    border: none;
                    min-height: 250px;
                    min-width: 280px; /* ensure enough width for long option text to stay on one line */
                }
                .matching-options-list .drag-item {
                    width: 100%;
                }
                .matching-question-item .drop-zone .placeholder {
                    color: #999;
                    font-weight: bold;
                }

                .option strong,
                .question ul li label strong {
                    display: none;
                }

                /* Mobile selection toolbar */
                .mobile-selection-menu {
                    position: absolute;
                    background: #333;
                    color: #fff;
                    padding: 6px 10px;
                    border-radius: 6px;
                    display: flex;
                    gap: 8px;
                    z-index: 3000;
                    box-shadow: 0 2px 6px rgba(0,0,0,0.25);
                }
                .mobile-selection-menu button {
                    background: transparent;
                    border: 1px solid #fff;
                    color: #fff;
                    padding: 4px 8px;
                    border-radius: 4px;
                    font-size: 14px;
                }
                .mobile-selection-menu.hidden {
                    display: none;
                }

                /* === MCQ table styling for Questions 11-15 === */
                .mcq-table {
                    width: 100%;
                    border-collapse: collapse;
                }
                .mcq-table th,
                .mcq-table td {
                    border: 1px solid #ddd;
                    padding: 8px 12px;
                    vertical-align: middle;
                    text-align: center;
                }
                .mcq-table th {
                    background-color: #1e6de6; /* vibrant blue header like screenshot */
                    color: #ffffff;
                    font-weight: 600;
                    text-align: center;
                }
                .mcq-table th:first-child {
                    text-align: left;
                }
                .mcq-table tbody td:first-child {
                    font-weight: 500;
                    text-align: left;
                }
                .mcq-table tr:nth-child(even) td {
                    background-color: #f8faff; /* subtle alternating row colour */
                }
                .mcq-table input[type="radio"] {
                    transform: scale(1.1);
                    cursor: pointer;
                }
                /* list of options (A, B, C) shown above the table */
                .mcq-options {
                    list-style: none;
                    padding-left: 0;
                    margin: 10px 0;
                }
                .mcq-options li {
                    margin-bottom: 4px;
                    font-size: 16px;
                }

                /* Compact single-choice list */
                .single-choice-container { margin: 10px 0; display: flex; flex-direction: column; gap: 18px; }
                .single-choice label { display: block; margin-left: 20px; margin-top: 4px; font-size: 16px; }

                .aligned-form .question-row {
                    display: flex;
                    align-items: center;
                    margin-bottom: 8px;
                }
                .aligned-form .question-label {
                    width: 230px;
                    padding-right: 10px;
                }

                /* Responsive adjustments for tablets */
                @media (max-width: 1024px) {
                    .main-container {
                        flex-direction: column;
                    }
                    .right-panel, .main-container.results-mode .right-panel {
                        display: none;
                    }
                    .left-panel, .main-container.results-mode .left-panel {
                        width: 100%;
                        padding: 20px 10px;
                        height: auto; /* Reset height for mobile */
                    }
                    .questions-container {
                        width: 100%;
                    }
                }

                .single-choice > label.correct {
                    color: #155724;
                    font-weight: bold;
                }
                .single-choice > label.correct::before {
                    content: '✔ ';
                    color: #28a745;
                }
                .single-choice > label.incorrect {
                    color: #721c24;
                    text-decoration: line-through;
                }
                .single-choice > label.incorrect::before {
                    content: '✖ ';
                    color: #dc3545;
                }
                .mcq-table tbody tr.correct {
                    background-color: #d4edda !important;
                    color: #155724;
                    font-weight: bold;
                }
                .mcq-table tbody tr.incorrect {
                    background-color: #f8d7da !important;
                    text-decoration: line-through;
                }
                .mcq-table tbody tr.incorrect td {
                    color: #721c24;
                }

                /* New Audio Player Styles */
                .audio-player-container {
                    position: fixed;
                    top: 65px;
                    left: 50%;
                    transform: translateX(-50%);
                    width: 500px;
                    max-width: 90%;
                    height: 40px;
                    background: #f9f9f9;
                    border: 1px solid #ddd;
                    border-radius: 8px;
                    display: flex;
                    align-items: center;
                    padding: 0 15px;
                    z-index: 99;
                    gap: 10px;
                    box-shadow: 0 4px 12px rgba(0,0,0,0.1);
                }
                .main-container {
                    margin-top: 115px;
                }
                .player-btn {
                    background: none;
                    border: none;
                    cursor: pointer;
                    padding: 5px;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                }
                .player-btn svg {
                    width: 20px;
                    height: 20px;
                    fill: #333;
                }
                .progress-container {
                    flex-grow: 1;
                    display: flex;
                    align-items: center;
                    gap: 10px;
                }
                #progress-bar {
                    flex-grow: 1;
                    -webkit-appearance: none;
                    appearance: none;
                    height: 4px;
                    background: #ddd;
                    outline: none;
                    border-radius: 3px;
                    cursor: pointer;
                }
                #progress-bar::-webkit-slider-thumb {
                    -webkit-appearance: none;
                    appearance: none;
                    width: 12px;
                    height: 12px;
                    border-radius: 50%;
                    background: #4a90e2;
                    cursor: pointer;
                }
                #progress-bar::-moz-range-thumb {
                    width: 12px;
                    height: 12px;
                    border-radius: 50%;
                    background: #4a90e2;
                    cursor: pointer;
                    border: none;
                }
                #current-time, #total-duration {
                    font-size: 12px;
                    color: #555;
                    min-width: 35px;
                    text-align: center;
                }
                .controls-container {
                    display: flex;
                    align-items: center;
                    gap: 10px;
                }
                .volume-container {
                    display: flex;
                    align-items: center;
                    position: relative;
                }
                #new-volume-slider {
                    -webkit-appearance: none;
                    appearance: none;
                    width: 60px;
                    height: 3px;
                    background: #ccc;
                    outline: none;
                    border-radius: 2px;
                    cursor: pointer;
                    margin-left: 8px;
                    display: block; 
                }
            
                #new-volume-slider::-webkit-slider-thumb {
                    -webkit-appearance: none;
                    appearance: none;
                    width: 12px;
                    height: 12px;
                    border-radius: 50%;
                    background: #333;
                }
                #new-volume-slider::-moz-range-thumb {
                    width: 12px;
                    height: 12px;
                    border-radius: 50%;
                    background: #333;
                    border: none;
                }
                .speed-container {
                    position: relative;
                }
                #speed-btn {
                    font-size: 12px;
                    font-weight: 600;
                    color: #333;
                    background-color: #e9ecef;
                    border: 1px solid #ced4da;
                    border-radius: 4px;
                    padding: 4px 8px;
                }
                #speed-options {
                    position: absolute;
                    top: calc(100% + 5px); /* Position below the button with a small gap */
                    right: 0;
                    background: white;
                    border: 1px solid #ccc;
                    border-radius: 4px;
                    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
                    z-index: 100;
                }
                #speed-options div {
                    padding: 8px 15px;
                    cursor: pointer;
                }
                #speed-options div:hover {
                    background-color: #f0f0f0;
                }
            </style>
        </head>
        <body>
            <div class="header">
                <div class="timer-container">
                    <span class="timer-display">60:00</span>
                </div>
                <h2>JUNED ACADEMY</h2>
                <div class="header-icons">
                
                </div>
            </div>

            <div class="audio-player-container">
                <button id="play-pause-btn" class="player-btn">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8 5v14l11-7z"/></svg>
                </button>
                <div class="progress-container">
                    <span id="current-time">0:00</span>
                    <input type="range" id="progress-bar" value="0" step="1" style="width: 100%;">
                    <span id="total-duration">0:00</span>
                </div>
                <div class="controls-container">
                    <div class="volume-container">
                        <button id="volume-btn" class="player-btn">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"></polygon><path d="M19.07 4.93a10 10 0 0 1 0 14.14M15.54 8.46a5 5 0 0 1 0 7.07"></path></svg>
                        </button>
                        <input type="range" id="new-volume-slider" min="0" max="1" step="0.01" value="1">
                    </div>
                    <div class="speed-container">
                        <button id="speed-btn" class="player-btn">1x</button>
                        <div id="speed-options" class="hidden">
                            <div data-speed="0.5">0.5x</div>
                            <div data-speed="0.75">0.75x</div>
                            <div data-speed="1">1x</div>
                            <div data-speed="1.25">1.25x</div>
                            <div data-speed="1.5">1.5x</div>
                            <div data-speed="2">2x</div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="main-container">
                <!-- Left Panel -->
                <div class="left-panel">
                    
                    <div id="part-1" class="question-part">
                        <div class="part-header">
                            <p><strong>Part 1</strong> </p>
                            <p>Listen and answer questions 1–10.</p>
                        </div>
                        <div class="questions-container">
                            <div class="question">
                                <div class="question-prompt">
                                    <p><strong>Questions 1-10</strong></p>
                                    <p>Complete the table below.</p>
                                    <p>Write <strong>ONE WORD AND/OR A NUMBER</strong> for each answer.</p>
                                </div>
                                
                                <p class="centered-title">HOSTELS</p>
                                
                                <table class="people-table">
                                    <thead>
                                        <tr>
                                            <th>Name</th>
                                            <th>Location</th>
                                            <th>Cost of double room</th>
                                            <th>notes</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td>Hostelling International West End</td>
                                            <td>Example<br>10 minutes from downtown by <strong>bus</strong>.</td>
                                            <td>$50 per night but only $<input type="text" id="q1" class="answer-input" placeholder="1"> for members</td>
                                            <td>Membership card offers discount on entry to 2 <input type="text" id="q2" class="answer-input" placeholder="2"><br>Internet access costs $3 per <input type="text" id="q3" class="answer-input" placeholder="3"></td>
                                        </tr>
                                        <tr>
                                            <td><input type="text" id="q4" class="answer-input" placeholder="4"> Hostel</td>
                                            <td>Near beach. Two-minute walk to <input type="text" id="q5" class="answer-input" placeholder="5"></td>
                                            <td>$62. Meals extra but only available in <input type="text" id="q6" class="answer-input" placeholder="6"></td>
                                            <td>Was built as a hotel in <input type="text" id="q7" class="answer-input" placeholder="7"><br>Can hire <input type="text" id="q8" class="answer-input" placeholder="8"> from hostel</td>
                                        </tr>
                                        <tr>
                                            <td>Backpackers Hostel</td>
                                            <td>In <input type="text" id="q9" class="answer-input" placeholder="9"> district</td>
                                            <td>$45 plus $5 for breakfast</td>
                                            <td>A <input type="text" id="q10" class="answer-input" placeholder="10"> on every floor for guests to use</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                    <div id="part-2" class="question-part hidden">
                        <div class="part-header">
                            <p><strong>Part 2</strong></p>
                            <p>Listen and answer questions 11–20.</p>
                        </div>
                        <div class="questions-container">
                            <div class="question">
                                <div class="question-prompt">
                                    <p><strong>Questions 11-17</strong><br>Complete the notes below.</p>
                                    <p>Write <strong>NO MORE THAN THREE WORDS</strong> for each answer.</p>
                                </div>
                                <p class="centered-title">"CV and Interview Skills" Seminar</p>
                                <ul>
                                    <li>The speaker suggests that the students use the <input type="text" class="answer-input" id="q11" placeholder="11"> when they begin writing resumes.</li>
                                    <li>The students should be sure not to keep the CV <input type="text" class="answer-input" id="q12" placeholder="12"></li>
                                    <li>A <input type="text" class="answer-input" id="q13" placeholder="13"> cover letter is useful when applying for a job and should be included.</li>
                                    <li>The speaker believes the CV should have a beautiful <input type="text" class="answer-input" id="q14" placeholder="14"></li>
                                    <li>The CV should not have any spelling and grammar <input type="text" class="answer-input" id="q15" placeholder="15"></li>
                                    <li>The words in a CV can describe your <input type="text" class="answer-input" id="q16" placeholder="16"></li>
                                    <li>Don't forget to put down a <input type="text" class="answer-input" id="q17" placeholder="17"> on the CV.</li>
                                </ul>
                            </div>
                            <div class="question">
                                <div class="question-prompt">
                                    <p><strong>Questions 18-20</strong><br>Choose THREE letters, A-G, and write them next to questions 18-20.</p>
                                    <p>What THREE details should job applicants know in the interview?</p>
                                </div>
                                <ul style="list-style: none; padding-left: 0;">
                                    <li><label><input type="checkbox" name="q18-20" value="A"> Working hours</label></li>
                                    <li><label><input type="checkbox" name="q18-20" value="B"> Promotion prospect</label></li>
                                    <li><label><input type="checkbox" name="q18-20" value="C"> Salary range</label></li>
                                    <li><label><input type="checkbox" name="q18-20" value="D"> Pension contribution bonus</label></li>
                                    <li><label><input type="checkbox" name="q18-20" value="E"> Training</label></li>
                                    <li><label><input type="checkbox" name="q18-20" value="F"> Holidays</label></li>
                                    <li><label><input type="checkbox" name="q18-20" value="G"> Location</label></li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <div id="part-3" class="question-part hidden">
                        <div class="part-header">
                            <p><strong>Part 3</strong></p>
                            <p>Listen and answer questions 21–30.</p>
                        </div>
                        <div class="questions-container">
                            <div class="question">
                                <div class="question-prompt">
                                    <p><strong>Questions 21-25</strong><br>Choose the correct letter, <strong>A</strong>, <strong>B</strong> or <strong>C</strong>.</p>
                                </div>
                                <div class="single-choice-container">
                                    <div class="single-choice">
                                        <p><strong>21.</strong> Why did Anita and Lee choose to talk about John Chapman?</p>
                                        <label><input type="radio" name="q21" value="A"> He was Lee's childhood hero.</label>
                                        <label><input type="radio" name="q21" value="B"> They wanted to talk about the USA.</label>
                                        <label><input type="radio" name="q21" value="C"> He was relevant to the topic of their studies.</label>
                                    </div>
                                    <div class="single-choice">
                                        <p><strong>22.</strong> Where did the students record their sources of information?</p>
                                        <label><input type="radio" name="q22" value="A"> on their laptops</label>
                                        <label><input type="radio" name="q22" value="B"> on a handout</label>
                                        <label><input type="radio" name="q22" value="C"> on a database</label>
                                    </div>
                                    <div class="single-choice">
                                        <p><strong>23.</strong> The tutor claims she does not understand whether</p>
                                        <label><input type="radio" name="q23" value="A"> apples grew in America before Europeans arrived.</label>
                                        <label><input type="radio" name="q23" value="B"> the Native Americans had always eaten apples.</label>
                                        <label><input type="radio" name="q23" value="C"> American apples were first bred in Europe.</label>
                                    </div>
                                    <div class="single-choice">
                                        <p><strong>24.</strong> The tutor says the audience was particularly interested to hear about</p>
                                        <label><input type="radio" name="q24" value="A"> grafting techniques in ancient China.</label>
                                        <label><input type="radio" name="q24" value="B"> the cultivation of apples in Kazakhstan.</label>
                                        <label><input type="radio" name="q24" value="C"> the spread of apples along the Silk Route.</label>
                                    </div>
                                    <div class="single-choice">
                                        <p><strong>25.</strong> How will Anita and Lee present their follow-up work?</p>
                                        <label><input type="radio" name="q25" value="A"> on the department website</label>
                                        <label><input type="radio" name="q25" value="B"> as a paper</label>
                                        <label><input type="radio" name="q25" value="C"> as a poster</label>
                                    </div>
                                </div>
                            </div>

                            <div class="question">
                                <div class="question-prompt">
                                    <p><strong>Questions 26-30</strong><br>What do Lee and Anita agree about their presentation skills with their tutor?</p>
                                    <p>Write the correct letter A, B or C next to questions 26-30.</p>
                                    <ul class="mcq-options">
                                        <li><strong>A</strong> excellent</li>
                                        <li><strong>B</strong> acceptable</li>
                                        <li><strong>C</strong> poor</li>
                                    </ul>
                                </div>
                                <table class="mcq-table" style="width: 100%;">
                                    <thead>
                                        <tr>
                                            <th>Presentation skills</th>
                                            <th>A</th>
                                            <th>B</th>
                                            <th>C</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td><strong>26</strong> &nbsp;&nbsp; use of equipment</td>
                                            <td><input type="radio" name="q26" value="A"></td>
                                            <td><input type="radio" name="q26" value="B"></td>
                                            <td><input type="radio" name="q26" value="C"></td>
                                        </tr>
                                        <tr>
                                            <td><strong>27</strong> &nbsp;&nbsp; handling software</td>
                                            <td><input type="radio" name="q27" value="A"></td>
                                            <td><input type="radio" name="q27" value="B"></td>
                                            <td><input type="radio" name="q27" value="C"></td>
                                        </tr>
                                        <tr>
                                            <td><strong>28</strong> &nbsp;&nbsp; timing of sections</td>
                                            <td><input type="radio" name="q28" value="A"></td>
                                            <td><input type="radio" name="q28" value="B"></td>
                                            <td><input type="radio" name="q28" value="C"></td>
                                        </tr>
                                        <tr>
                                            <td><strong>29</strong> &nbsp;&nbsp; design of handout</td>
                                            <td><input type="radio" name="q29" value="A"></td>
                                            <td><input type="radio" name="q29" value="B"></td>
                                            <td><input type="radio" name="q29" value="C"></td>
                                        </tr>
                                        <tr>
                                            <td><strong>30</strong> &nbsp;&nbsp; clarity of speech</td>
                                            <td><input type="radio" name="q30" value="A"></td>
                                            <td><input type="radio" name="q30" value="B"></td>
                                            <td><input type="radio" name="q30" value="C"></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                    <div id="part-4" class="question-part hidden">
                        <div class="part-header">
                            <p><strong>Part 4</strong></p>
                            <p>Listen and answer questions 31–40.</p>
                        </div>
                        <div class="questions-container">
                            <div class="question">
                                <div class="question-prompt">
                                    <p><strong>Questions 31-40</strong></p>
                                    <p>Complete the table below.</p>
                                    <p>Write <strong>ONE WORD ONLY</strong> for each answer.</p>
                                </div>
                                <p class="centered-title">INVESTIGATING TASTE</p>
                                <table class="people-table">
                                    <thead>
                                        <tr>
                                            <th>Procedure</th>
                                            <th>Result</th>
                                            <th>Cause</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td>more yellow added to green colour of <input type="text" class="answer-input" id="q31" placeholder="31"></td>
                                            <td>subjects believed extra <input type="text" class="answer-input" id="q32" placeholder="32"> added to drink</td>
                                            <td>brain influenced by product presentation</td>
                                        </tr>
                                        <tr>
                                            <td>gum chewed until it is <input type="text" class="answer-input" id="q33" placeholder="33"> then again with sugar</td>
                                            <td>mint flavor <input type="text" class="answer-input" id="q34" placeholder="34"></td>
                                            <td>sweetness necessary for mintiness</td>
                                        </tr>
                                        <tr>
                                            <td>same drink tasted cold and at room temperature</td>
                                            <td><input type="text" class="answer-input" id="q35" placeholder="35"> drink seems sweeter</td>
                                            <td>temperature affects sweetness</td>
                                        </tr>
                                        <tr>
                                            <td>crisps eaten in rooms which were <input type="text" class="answer-input" id="q36" placeholder="36"></td>
                            <td>with louder crunch, subjects believed crisps taste <input type="text" class="answer-input" id="q37" placeholder="37"></td>
                                            <td>sound affects taste perceptions</td>
                                        </tr>
                                        <tr>
                                            <td>variety of cheese sauces prepared</td>
                                            <td>subjects believed some sauces tasted less strong</td>
                            <td><input type="text" class="answer-input" id="q38" placeholder="38"> affects taste perceptions</td>
                                        </tr>
                                        <tr>
                            <td>two different flavoured <input type="text" class="answer-input" id="q39" placeholder="39"> tasted together</td>
                            <td>subjects still tasted <input type="text" class="answer-input" id="q40" placeholder="40"> when no longer there</td>
                                            <td>brain is filling the taste 'gap'</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Right Panel -->
                <div class="right-panel">
                    <div id="transcription-container">
                        <h2>Transcription</h2>
                        <pre id="transcription-text"></pre>
                    </div>
                </div>
            </div>

            <div id="transcription-data" style="display:none;">
                <div data-part="1">
    <span class="transcription-instruction">Section 1. You will hear a woman talking to a man who works in a tourist information office.</span>
    <span class="transcription-instruction">First, you have some time to look at questions 1 to 6. Pause the recording for 30 seconds. You will see that there is an example that has been done for you.</span>
    <span class="transcription-instruction">On this occasion only, the conversation relating to this will be played first.</span> 
    Good morning. Can I help you? I hope so. 
    I have a friend in Spain and her two daughters are coming to the city to study for a month. So, I thought the tourist information center was the best place to ask about hostels. Can you recommend any? Of course. 
    I usually suggest one of the Hosteling International places. HI West End is a big hostel in a residential area, but is only 10 minutes from downtown if you take a bus. It's really popular.
    <span class="transcription-instruction">The journey time is by bus, so bus has been written in the space. Now we shall begin. You should answer the questions as you listen because you will not hear the recording a second time.</span>
    <span class="transcription-instruction">Listen carefully and answer questions 1 to 6.</span> 
    Good morning. Can I help you? I hope so. I have a friend in Spain and her two daughters are coming to the city to study for a month.
    So, I thought the tourist information center was the best place to ask about hostels. Can you recommend any? Of course. I usually suggest one of the Hosteling International places.
    HI West End is a big hostel in a residential area, but is only 10 minutes from downtown if you take a bus. It's really popular. Okay. 
    Sounds good. I need to know how much it costs. The girls want a double room to themselves. 
    They don't want to share with other people. Well, that makes it more expensive. The price is under $30 for a bed in a dormitory, but they'll be paying $50 a night.
    But if they become members of Hosteling International, the price comes down to $41 a night. Membership costs $35. Right.
    And membership offers them benefits too on all kinds of activities. What kind of things? Oh, uh, skydiving and whitewater rafting. Things like that.
    Hmm. I don't think they're interested in that kind of thing. If they become members, will they get cheaper entrance tickets to museums? Oh, yes. 
    And also discounts on bicycle and car hire. Okay. It's probably worth it. 
    Is the hostel very noisy? They're coming here to do some studying. I think it is quite noisy, as it's a really big hostel. And if they want to use the Internet, this hostel still makes a charge, unfortunately.
    Oh. It's $1 for 15 minutes and $3 for an hour. Hmm. 
    It might not be ideal for them. Mm-hmm. What else can you recommend? Is there anything in a quiet area? There's Ellis Goat Hostel.
    Hmm. How do you spell that? E-L-L-I-S-C-O-A-T. I've never heard that name before. 
    And where is that? It's on the beach looking over the bay. Here, look on the map. Oh.
    It's quiet, but not far from Dragon Island. There's plenty going on there in the evening. Oh, that's a nice area. 
    And if they want to go to Dragon Island, it only takes a couple of minutes to walk down to the ferry. So, how much is a room there? It's in such a nice spot that the rooms are a bit more expensive. Mm-hmm.
    They're $62. Does that include any meals? Unfortunately not. Oh.
    It is possible to buy meals in the hostel at a reasonable price, but because it isn't very busy in the winter, they only cook in summer. 
    <span class="transcription-instruction">Before you hear the rest of the conversation, you have some time to look at questions 7 to 10. Pause the recording for 30 seconds.</span>
    <span class="transcription-instruction">Now listen and answer questions 7 to 10.</span> 
    Oh, I think I know the place you mean. It's an old building, isn't it? Yes, it's well known as it's one of the oldest in the city. 
    There's been a hotel there since 1887 when it was first built. It was turned into a hostel in 1985, and they'veinvested a lot of money restoring it inside. Hmm. 
    They'd like that. But I'm just looking on the map at where their college is. It's right in the center. 
    It is a bit far for them from there. The hostel actually has scooters for hire at a very good price, so they could do that. It would be quicker than cycling or walking to the center.
    Hmm. It is a bit expensive, but it sounds like the best one so far, unless there's something a bit cheaper. Okay. 
    Well, what about the Backpackers Hostel? That's not so expensive. It's in a side street in the Entertainment District. They wouldn't need to go far to find everything they want. 
    They could walk everywhere, and it's very reasonable, only $45 and another $5 if they want to have breakfast. Hmm. But what about other meals? There's no café, but on each floor in this hostel, there's a kitchen for residents to cook in.
    Oh. I'm not sure how well equipped they are, but it should be fine for basic meals. Well, that's really very helpful. 
    I'll pass all this information on now. Do ask your friends to ring me if they need to know anything else. I will. 
    Thank you. 
    <span class="transcription-instruction">That is the end of Section 1. You now have half a minute to check your answers.</span>
    </div>
                <div data-part="2">
    <span class="transcription-instruction">Section 2. You'll hear an introduction about how to make a resume and apply for a job.</span>
    <span class="transcription-instruction">First, you have some time to look at questions 11 to 17.</span>
    <span class="transcription-instruction">Now, listen carefully and answer questions 11 to 17.</span> 
    Welcome, everyone, to today's seminar on CV and interview skills.
    Remember, your CV is probably the most important document you will ever write. It opens the door to your career, and that job interview is probably the most important meeting you will ever attend. It's like stepping through that open door. 
    So let's roll up our sleeves and get down to work, shall we? First of all, I cannot possibly tell you everything you need to know about writing a resume in the time we have. But let me tell you that there are dozens of great websites on the Internet. These will give you all the suggestions you need.
    If you look at the paper I gave you, you will see a list of the dozen most popular sites. I can mention a couple of important points, however. One is that your CV or resume should not be too long. 
    A page is about right. Why? HR departments do not have the time to read long documents. Too many people are sending too many CVs.
    After all, the economic crisis of 2008 is still very much alive. Everyone needs a job now. No matter how short you make that resume, though, you do not want to forget to tell HR how to contact your references.
    References are people who will give you a recommendation for a job. That's usually an ex-boss or a professor who knows you well. Do not use relatives. 
    I don't care how much your mum loves you. Also, when you send that CV, be sure to include a typed cover letter. A cover letter is a letter where you basically are asking for a job.
    It's like introducing yourself. Make it brief. The real information about you is on that CV of yours.
    And please, make sure the letter is typed. It doesn't matter if your handwriting is beautiful or not. Companies only read typed letters.
    Another point about CVs is you should try to have an attractive layout. Maybe use different type fonts or colours to highlight the information. Some people include a photo. 
    You can find dozens of examples on the internet. Whatever layout you decide to use, however, avoid all spelling and grammar errors. I used to be an HR manager. 
    If I saw a mistake, that CV went into the garbage. Something you write in a CV is a description of your skills and experiences in an interesting way. Mention training, too. 
    I mean, these are what get you hired. Do not just say, I have lots of experience or I have many skills. Tell that boss what you did for what company and when.
    Better, tell him how well you did it. Don't just say, I sold houses. Say, I sold two million pounds worth of houses in my first year.
    That is, say something to make the person reading excited and curious. Finally, speaking of CVs, it's sad, but some people actually forget to provide a contact number. That's pretty silly.
    You wrote a great CV. You have HR dying to meet you, and they don't know how. You forgot your phone number.
    Oh, sure, if you apply online, they have your email address, but you just showed them you're forgetful. Why are they going to want to talk to you after that? 
    <span class="transcription-instruction">Before you hear the rest of the talk, you have some time to look at questions 18 to 20.</span>
    <span class="transcription-instruction">Now listen and answer questions 18 to 20.</span>
    All right, moving on to the actual interview. I'll go over what you need to know by the end of it, and what you can discuss and negotiate on later once it looks like you'll be offered the job. First, there's working hours.
    It's not that necessary to hammer out the hours off the bat, especially since it's easy to come off as lazy when the first thing you bring up is how much you're going to have to work. You can also find out more about possible promotions later on. It is important, however, to get a feel for how much you'll be paid.
    You should make sure the salary range is commensurate with what you're worth, and if you're not, you can move on to better opportunities. Being sure you're going to make what you want to live on is much more important than issues like your pension. You're all so young that your pension is not going to matter for quite a long time.
    You should find out about what skills you must know for the job, and what they'll teach you. In addition, if the company will provide training, you should find out how long the training period is, and whether it is paid. Beware of any jobs that want you to train for a long time without appropriate compensation.
    Speaking of compensation, find out about holidays as well. Do you get paid vacation time? Are you allowed to take personal days? Do you have to work on national holidays? Once you work out these main issues, you can move on later to details like the location and expected attire and whatnot. Wow, that's a lot of information. 
    Let's take a break so you can think everything over and ask any questions you may have. Don't hesitate to come and see me if you need any clarification on all this stuff. 
    <span class="transcription-instruction">That is the end of section two. You now have half a minute to check your answers. Now turn to section three.</span>
    </div>
                <div data-part="3">
    <span class="transcription-instruction">Section three.</span>
    <span class="transcription-instruction">You will hear a university tutor talking to two students about a presentation they have made in a recent botany seminar. First, you have some time to look at questions twenty-one to twenty-five. Pause the recording for thirty seconds.</span>
    <span class="transcription-instruction">Now listen carefully and answer questions twenty-one to twenty-five.</span> 
    Well, Anita and Lee, that was an interesting presentation you made about John Chapman. Thanks.
    There are a few points I'd like to run through before you write it up. One thing which you didn't explain was why you decided to do a presentation on this man who spread apple varieties across the US. Well, ages ago, we were chatting about stuff we'd read as children and I told Lee the Johnny Appleseed story.
    I had these American storybooks when I was small. Then when we were looking into the area of domesticated species of plants for our presentation, we realised that the introduction of the apple with the settlers in the US would be a good case study. And I remembered Chapman, so we looked up the real guy behind the legend.
    Right. I think that would have made a good intro. I thought it was too personal.
    Just a couple of minutes would have drawn your listeners in. Anyway, now a more serious point. You didn't mention the sources of some of your information.
    We used some books and journal articles and did an internet search and found some good sites. We've put them on the back of the handout we gave everyone at the end. Oh, I see.
    Oh, here it is. Johnny Appleseed, Man and Myth, 1967. Well, the thing is, you really have to make this explicit when you talk.
    And anything you show, data you project from your laptop, etc., you must have the source on it. Right, OK. At least you have got it all documented. 
    I was a bit concerned about that. Sorry. Anyway, now the content of your talk.
    What your listeners wanted to understand was whether there were apples in the US before the Europeans started to live there. You told us the early settlers had brought young apple trees, but that few of them had thrived because the climate was harsh. But what about native species? I don't think you were very clear about species already there.
    According to what I've read, there were some crab apples, but that was all. Everything that people now think of as traditional American apples was species that the Europeans either introduced or bred by chance. Because they tended to sow seeds rather than use grafting.
    Yes, quite. But what to me was fascinating, and I saw most members of your audience start to take notes, was when you discussed how the apple genes spread via the Silk Route into Europe from the wild apple woods of Kazakhstan. Yes, well, I'd like to have said more about the development of grafting in ancient China as a way of producing predictable varieties.
    It was so early in history. But it's the natural development of the original wild apple into new species that people wanted more about, which says a lot for your presentation. You enthused your audience.
    So now we need to discuss the form your follow-up work will take. Are you going to produce a paper? Or are you thinking of putting it all up on the department website? I felt we could do both, and we could do a poster of some of the data, but Lee wasn't sure. No, I think it would be enough to use the website.
    We can offer a link to our email for queries. That would save time and trees. I think Lee's right.
    A poster would be nice, but it'd take too much time. OK. 
    <span class="transcription-instruction">Before you hear the rest of the conversation, you have some time to look at questions 26 to 30. Pause the recording for 30 seconds.</span>
    <span class="transcription-instruction">Now listen and answer questions 26 to 30.</span> 
    Now, I just want to give you a few pointers about the techniques of your presentation.
    Mostly, it was good. But there are a few things you need to bear in mind next time you do one. You both managed the hardware, I mean the projector and things, very well indeed, which is always a great help.
    Good. Thanks. You'd obviously checked it out carefully.
    Yes. But unfortunately, we hadn't finished our maps when we did the practice on my computer at home. That's why there were some the wrong way up.
    We didn't realise the software on the laptop was a bit different from the one I have. But you sorted out the problem very quickly and didn't let it fluster you, so it wasn't a big problem. We could all read the map when we needed to.
    So, it was OK, but we could have done better, we realise. There was a bit at the end where I felt something didn't go as you'd planned. Am I right? We had a few maps which we ended up leaving out because we needed to get on to our conclusions.
    Yes, it took longer to explain the technical aspects of grafting than we'd expected. So, sticking to the time limit for each part of our presentation is something we didn't manage at all. Which means we've definitely got to improve before we do another one.
    Yes. Apart from that, well, the handout was perfectly adequate for a seminar like this. It gave all the key information and, of course, now I realise the sources are listed at the back.
    But you need to do those references in the correct format, as footnotes, in future. OK. Yes, sorry, we will.
    And finally, other students will be presenting projects later in the course. I shall be reminding them how well you both spoke and that no one had any problem hearing or understanding either of you. In that respect, your talk was a model that the others can follow.
    Thank you. Yes, thanks very much. This feedback has been very helpful.
    Well done, both of you. See you in a fortnight. Bye.
    Yes, thanks. 
    <span class="transcription-instruction">That is the end of section 3. You now have half a minute to check your answers.</span>
    </div>
                <div data-part="4">
    <span class="transcription-instruction">Section 4. You will hear a lecturer describing some investigations into the sense of taste.</span>
    <span class="transcription-instruction">First, you have some time to look at questions 31 to 40. Pause the recording for one minute.</span>
    <span class="transcription-instruction">Now listen carefully and answer questions 31 to 40.</span>
    This morning, I'm going to describe for you a few of the kinds of experiments that have been used to investigate the sense of taste, which is now recognised as being a far more complex and important area of neurological science than was previously believed by most people. The results of some of these experiments can be quite fun, and I shall suggest that you may want to choose one or two to try out in groups before having a go at designing a new experimental procedure of your own and trying to pinpoint the cause of your findings. The first one concerns a marketing exercise by a soft drinks company.
    The green colour of some cans was altered by the addition of yellow, so they were a brighter green. Then, test subjects were asked what they thought about the flavour of the drink in the new style cans, and they stated that there was more lime in the drink if it was in the ones with the new colour. This was because the brain picks up cues from the way the product is presented, as well as the product itself, which trigger taste sensations.
    Before food was packaged, humans used colour to gauge the ripeness of fruit, for example. Next, there's the old problem with chewing gum. Everyone knows that after a few minutes chewing, it loses its minty flavour.
    However, if you ask people to chew up to the point where it becomes tasteless, and then ask them to eat a little sugar and continue chewing, to most people's surprise, what happens is that the original mintiness actually returns, because it is the sweetness which is needed to make the mintiness perceptible. So, combinations of flavours can be significant, as the brain needs one of them in order to recognise the other. Another experiment demonstrates something we've all done.
    Drink half a fizzy drink straight from the fridge, and then leave it at room temperature for a while. Take a sip, and you may well decide you don't like it. The warm drink is too sweet to be refreshing.
    So, put the rest back in the fridge until it's chilled again. Now try it. Much better.
    Of course, the sweetness doesn't change. It is our perception, because how sweet it tastes depends on the temperature. The extent to which the drink is sweetened is less evident if the drink has been cooled.
    Another interesting result has been derived from experiments with sound. One of these involved eating crisps. Subjects were put into soundproof rooms and given batches of crisps to eat.
    As they ate, the sound of crunching which they made as they ate the crisps was played back to them. This was adjusted so that they sometimes heard the crunching as louder, or at other times, more high frequency sounds were audible in the sound feedback that accompanied their eating. Fascinatingly, if the sound level was louder or higher frequency, they reported that the crisps were actually fresher.
    Of course, the crisps were in fact the same every time. So, it was clear that the level and quality of what they were hearing was influencing their taste perceptions. So, we've looked briefly at colour, at complementary flavours, at temperature and sound.
    It seems that all the senses are working together here. But what about the sense of touch? A number of experiments have been done in this area. If you take, for instance, cheese sauce and prepare different versions, some thicker and some thinner, but without any alteration in the strength of flavour, what do you think the subjects perceive? Yep, if the sauce is thicker, they'll say the cheesy flavour is less strong.
    It was clear that the thing that was influencing the subjects' judgement about the flavour of the sauces was the texture of each one. Now, this result is important for dieticians as well as marketing executives. Lastly, another variation on the two flavours theme.
    This concerns the capacity of the brain for bridging a sensory gap. The subjects in this experiment stuck out their tongues so that the testers could drip two liquids onto them simultaneously. One strawberry-flavoured and one sugar-flavoured.
    The testers then took away each flavour in turn. When the sweetness was taken away, the subjects reported they could hardly taste anything. But they continued to think they could taste strawberry even after it was taken away.
    So that taste gap was filled. Well, that's just a quick look at some of the examples in the current literature. The references will be in the handouts you'll get at the end of the session.
    Now, let's see about trying a few of them for ourselves.</div>
            </div>

            <audio id="global-audio-player" class="hidden"></audio>

            <!-- Navigation Arrows -->
            <div class="nav-arrows">
                <button class="nav-arrow" onclick="previousPart()" id="prevBtn">‹</button>
                <button class="nav-arrow" onclick="nextPart()" id="nextBtn">›</button>
            </div>

            <!-- Bottom Navigation -->
            <nav class="nav-row perScorableItem" aria-label="Questions">
                <div class="footer__questionWrapper___1tZ46 multiple" role="tablist">
                    <button role="tab" class="footer__questionNo___3WNct" onclick="switchToPart(1)">
                        <span>
                            <span aria-hidden="true" class="section-prefix">Part </span>
                            <span class="sectionNr" aria-hidden="true">1</span>
                            <span class="attemptedCount" aria-hidden="true">0 of 10</span>
                        </span>
                    </button>
                    <div class="footer__subquestionWrapper___9GgoP">
                        <button class="subQuestion scorable-item" onclick="goToQuestion(1)"><span class="sr-only">Question 1</span><span aria-hidden="true">1</span></button>
                        <button class="subQuestion scorable-item" onclick="goToQuestion(2)"><span class="sr-only">Question 2</span><span aria-hidden="true">2</span></button>
                        <button class="subQuestion scorable-item" onclick="goToQuestion(3)"><span class="sr-only">Question 3</span><span aria-hidden="true">3</span></button>
                        <button class="subQuestion scorable-item" onclick="goToQuestion(4)"><span class="sr-only">Question 4</span><span aria-hidden="true">4</span></button>
                        <button class="subQuestion scorable-item" onclick="goToQuestion(5)"><span class="sr-only">Question 5</span><span aria-hidden="true">5</span></button>
                        <button class="subQuestion scorable-item" onclick="goToQuestion(6)"><span class="sr-only">Question 6</span><span aria-hidden="true">6</span></button>
                        <button class="subQuestion scorable-item" onclick="goToQuestion(7)"><span class="sr-only">Question 7</span><span aria-hidden="true">7</span></button>
                        <button class="subQuestion scorable-item" onclick="goToQuestion(8)"><span class="sr-only">Question 8</span><span aria-hidden="true">8</span></button>
                        <button class="subQuestion scorable-item" onclick="goToQuestion(9)"><span class="sr-only">Question 9</span><span aria-hidden="true">9</span></button>
                        <button class="subQuestion scorable-item" onclick="goToQuestion(10)"><span class="sr-only">Question 10</span><span aria-hidden="true">10</span></button>
                    </div>
                </div>
                
                <div class="footer__questionWrapper___1tZ46 selected multiple" role="tablist">
                    <button role="tab" class="footer__questionNo___3WNct" onclick="switchToPart(2)">
                        <span>
                            <span aria-hidden="true" class="section-prefix">Part </span>
                            <span class="sectionNr" aria-hidden="true">2</span>
                            <span class="attemptedCount" aria-hidden="true">0 of 10</span>
                        </span>
                    </button>
                    <div class="footer__subquestionWrapper___9GgoP">
                        <button class="subQuestion scorable-item" onclick="goToQuestion(11)"><span class="sr-only">Question 11</span><span aria-hidden="true">11</span></button>
                        <button class="subQuestion scorable-item" onclick="goToQuestion(12)">
                            <span class="sr-only">Question 12</span>
                            <span aria-hidden="true">12</span>
                        </button>
                        <button class="subQuestion scorable-item" onclick="goToQuestion(13)">
                            <span class="sr-only">Question 13</span>
                            <span aria-hidden="true">13</span>
                        </button>
                        <button class="subQuestion scorable-item" onclick="goToQuestion(14)">
                            <span class="sr-only">Question 14</span>
                            <span aria-hidden="true">14</span>
                        </button>
                        <button class="subQuestion scorable-item" onclick="goToQuestion(15)">
                            <span class="sr-only">Question 15</span>
                            <span aria-hidden="true">15</span>
                        </button>
                        <button class="subQuestion scorable-item" onclick="goToQuestion(16)">
                            <span class="sr-only">Question 16</span>
                            <span aria-hidden="true">16</span>
                        </button>
                        <button class="subQuestion active scorable-item" onclick="goToQuestion(17)">
                            <span class="sr-only">Question 17</span>
                            <span aria-hidden="true">17</span>
                        </button>
                        <button class="subQuestion scorable-item" onclick="goToQuestion(18)">
                            <span class="sr-only">Question 18</span>
                            <span aria-hidden="true">18</span>
                        </button>
                        <button class="subQuestion scorable-item" onclick="goToQuestion(19)">
                            <span class="sr-only">Question 19</span>
                            <span aria-hidden="true">19</span>
                        </button>
                        <button class="subQuestion scorable-item" onclick="goToQuestion(20)">
                            <span class="sr-only">Question 20</span>
                            <span aria-hidden="true">20</span>
                        </button>
                    </div>
                </div>
                
                <div class="footer__questionWrapper___1tZ46 multiple" role="tablist">
                    <button role="tab" class="footer__questionNo___3WNct" onclick="switchToPart(3)">
                        <span>
                            <span aria-hidden="true" class="section-prefix">Part </span>
                            <span class="sectionNr" aria-hidden="true">3</span>
                            <span class="attemptedCount" aria-hidden="true">0 of 10</span>
                        </span>
                    </button>
                    <div class="footer__subquestionWrapper___9GgoP">
                        <button class="subQuestion scorable-item" onclick="goToQuestion(21)"><span class="sr-only">Question 21</span><span aria-hidden="true">21</span></button>
                        <button class="subQuestion scorable-item" onclick="goToQuestion(22)"><span class="sr-only">Question 22</span><span aria-hidden="true">22</span></button>
                        <button class="subQuestion scorable-item" onclick="goToQuestion(23)"><span class="sr-only">Question 23</span><span aria-hidden="true">23</span></button>
                        <button class="subQuestion scorable-item" onclick="goToQuestion(24)"><span class="sr-only">Question 24</span><span aria-hidden="true">24</span></button>
                        <button class="subQuestion scorable-item" onclick="goToQuestion(25)"><span class="sr-only">Question 25</span><span aria-hidden="true">25</span></button>
                        <button class="subQuestion scorable-item" onclick="goToQuestion(26)"><span class="sr-only">Question 26</span><span aria-hidden="true">26</span></button>
                        <button class="subQuestion scorable-item" onclick="goToQuestion(27)"><span class="sr-only">Question 27</span><span aria-hidden="true">27</span></button>
                        <button class="subQuestion scorable-item" onclick="goToQuestion(28)"><span class="sr-only">Question 28</span><span aria-hidden="true">28</span></button>
                        <button class="subQuestion scorable-item" onclick="goToQuestion(29)"><span class="sr-only">Question 29</span><span aria-hidden="true">29</span></button>
                        <button class="subQuestion scorable-item" onclick="goToQuestion(30)"><span class="sr-only">Question 30</span><span aria-hidden="true">30</span></button>
                    </div>
                </div>
                
                <div class="footer__questionWrapper___1tZ46 multiple" role="tablist">
                    <button role="tab" class="footer__questionNo___3WNct" onclick="switchToPart(4)">
                        <span>
                            <span aria-hidden="true" class="section-prefix">Part </span>
                            <span class="sectionNr" aria-hidden="true">4</span>
                            <span class="attemptedCount" aria-hidden="true">0 of 10</span>
                        </span>
                    </button>
                    <div class="footer__subquestionWrapper___9GgoP">
                        <button class="subQuestion scorable-item" onclick="goToQuestion(31)"><span class="sr-only">Question 31</span><span aria-hidden="true">31</span></button>
                        <button class="subQuestion scorable-item" onclick="goToQuestion(32)"><span class="sr-only">Question 32</span><span aria-hidden="true">32</span></button>
                        <button class="subQuestion scorable-item" onclick="goToQuestion(33)"><span class="sr-only">Question 33</span><span aria-hidden="true">33</span></button>
                        <button class="subQuestion scorable-item" onclick="goToQuestion(34)"><span class="sr-only">Question 34</span><span aria-hidden="true">34</span></button>
                        <button class="subQuestion scorable-item" onclick="goToQuestion(35)"><span class="sr-only">Question 35</span><span aria-hidden="true">35</span></button>
                        <button class="subQuestion scorable-item" onclick="goToQuestion(36)"><span class="sr-only">Question 36</span><span aria-hidden="true">36</span></button>
                        <button class="subQuestion scorable-item" onclick="goToQuestion(37)"><span class="sr-only">Question 37</span><span aria-hidden="true">37</span></button>
                        <button class="subQuestion scorable-item" onclick="goToQuestion(38)"><span class="sr-only">Question 38</span><span aria-hidden="true">38</span></button>
                        <button class="subQuestion scorable-item" onclick="goToQuestion(39)"><span class="sr-only">Question 39</span><span aria-hidden="true">39</span></button>
                        <button class="subQuestion scorable-item" onclick="goToQuestion(40)"><span class="sr-only">Question 40</span><span aria-hidden="true">40</span></button>
                    </div>
                </div>
                
                <button id="deliver-button" aria-label="Review your answers" class="footer__deliverButton___3FM07">
                    <i class="fa fa fa-check" aria-hidden="true"></i>
                    <span>Check Answers</span>
                </button>
            </nav>

            <!-- Context Menu -->
            <div id="contextMenu" class="context-menu">
                <div class="context-menu-item" id="highlight-item" onclick="highlightText()">
                    <span class="context-menu-icon">
                        <svg viewBox="0 0 24 24" fill="black"><path d="M15.24 12.32L12.28 9.36l-1.04 1.04-1.04-1.04-1.04 1.04-1.04-1.04-1.04 1.04-1.04-1.04-3.12 3.12c-.59.58-1.54.58-2.12 0l-1.04-1.04c-.58-.59-.58-1.54 0-2.12L7.88.88c.59-.58 1.54-.58 2.12 0l1.04 1.04 1.04-1.04 1.04 1.04 1.04-1.04 1.04 1.04 1.04-1.04 3.12 3.12c.58.59.58 1.54 0 2.12l-1.04 1.04c-.58.59-1.54.59-2.12 0zM12 15l-3 3-7-7 3-3 7 7zm-9-5l-2.29 2.29c-.39.39-.39 1.02 0 1.41l8.29 8.29c.39.39 1.02.39 1.41 0L22.7 8.41c.39-.39.39-1.02 0-1.41L14.42.29c-.39-.39-1.02-.39-1.41 0L3 10z"/></svg>
                    </span>
                    <span>Highlight</span>
                </div>
                <div class="context-menu-item" id="comment-item" onclick="addComment()">
                    <span class="context-menu-icon">
                        <svg viewBox="0 0 24 24" fill="black"><path d="M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-1 12H5.17L4 15.17V4h16v10z"/></svg>
                    </span>
                    <span>Comment</span>
                </div>
                <div class="context-menu-item" id="clear-item" onclick="clearHighlight()" style="display:none;">
                    <span class="context-menu-icon">
                        <svg viewBox="0 0 24 24" fill="black"><path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/></svg>
                    </span>
                    <span>Clear</span>
                </div>
                <div class="context-menu-item" onclick="clearAllHighlights()">
                    <span class="context-menu-icon">
                        <svg viewBox="0 0 24 24" fill="black"><path d="M16 9h-2.29l3-3-1.42-1.42-3 3V5h-2v2.29l-3-3-1.42 1.42 3 3H5v2h2.29l-3 3 1.42 1.42 3-3V17h2v-2.29l3 3 1.42-1.42-3-3H17V9h-2zm-4 4h-2v-2h2v2z"/></svg>
                    </span>
                    <span>Clear All</span>
                </div>
            </div>

            <!-- Mobile highlight/comment toolbar -->
            <div id="mobile-selection-menu" class="mobile-selection-menu hidden">
                <button onclick="highlightText()">Highlight</button>
                <button onclick="addComment()">Comment</button>
            </div>

            <!-- Result Modal -->
            <div id="result-modal" class="modal-overlay" style="display: none;">
                <div class="modal-content">
                    <div class="modal-header">
                        <h2>Your Results</h2>
                        <button id="modal-close-button" class="modal-close-btn">&times;</button>
                    </div>
                    <div class="modal-body">
                        <p id="score-summary"></p>
                        <div id="result-details"></div>
                    </div>
                </div>
            </div>

            <script>
                let currentPart = 1;
                let currentQuestion = 1;
                let selectedText = '';
                let selectedRange = null;
                let draggedElement = null;
                let testStarted = false;
                let timeInSeconds = 3600;
                let isHovering = false;
                let timerInterval;
                let contextElement = null;

                function updateAnsweredIndicators() {
                    for (let qNum = 1; qNum <= 40; qNum++) {
                        const btn = document.querySelector(`.subQuestion[onclick="goToQuestion(${qNum})"]`);
                        if (!btn) continue;

                        // Do not change style if it's already marked correct or incorrect
                        if (btn.classList.contains('correct') || btn.classList.contains('incorrect')) {
                            continue;
                        }

                        let isAnswered = false;
                        const textInput = document.getElementById(`q${qNum}`);
                        const radioInput = document.querySelector(`input[name="q${qNum}"]:checked`);
                        const dropZone = document.querySelector(`.drop-zone[data-question="q${qNum}"]`);

                        if (textInput && textInput.value.trim() !== '') {
                            isAnswered = true;
                        } else if (radioInput) {
                            isAnswered = true;
                        } else if (dropZone && dropZone.children.length > 0) {
                            isAnswered = true;
                        } else if ((qNum >= 17 && qNum <= 18) && document.querySelector('input[name="q17-18"]:checked')) {
                            isAnswered = true;
                        } else if ((qNum >= 19 && qNum <= 20) && document.querySelector('input[name="q19-20"]:checked')) {
                            isAnswered = true;
                        } else if ((qNum >= 21 && qNum <= 23) && document.querySelector('input[name="q21-23"]:checked')) {
                            isAnswered = true;
                        }

                        if (isAnswered) {
                            btn.classList.add('answered');
                        } else {
                            btn.classList.remove('answered');
                        }
                    }
                }

                const audioPlayer = document.getElementById('global-audio-player');
                const timerContainer = document.querySelector('.timer-container');
                const timerDisplay = document.querySelector('.timer-display');
                const volumeSlider = document.getElementById('new-volume-slider');
                const playPauseBtn = document.getElementById('play-pause-btn');
                const progressBar = document.getElementById('progress-bar');
                const currentTimeEl = document.getElementById('current-time');
                const totalDurationEl = document.getElementById('total-duration');
                const speedBtn = document.getElementById('speed-btn');
                const speedOptions = document.getElementById('speed-options');
                const volumeBtn = document.getElementById('volume-btn');

                const audioSource = 'https://archive.org/download/audio-_202507/Audio%20%E2%80%94%20%D0%BA%D0%BE%D0%BF%D0%B8%D1%8F%D0%BA%D0%BE%D0%BF%D0%B8%D1%8F%D0%BA%D0%BE%D0%BF%D0%B8%D1%8F%D0%BA%D0%BE%D0%BF%D0%B8%D1%8F%D0%BA%D0%BE%D0%BF%D0%B8%D1%8F%D0%BA%D0%BE%D0%BF%D0%B8%D1%8F%D0%BA%D0%BE%D0%BF%D0%B8%D1%8F.mp3';
                audioPlayer.src = audioSource;

                const correctAnswers = {
                    // === Section 1 (Questions 1-10) ===
                    'q1': '41',
                    'q2': 'museums',
                    'q3': 'hour',
                    'q4': 'Elliscoat',
                    'q5': 'ferry',
                    'q6': 'summer',
                    'q7': '1887',
                    'q8': 'scooter(s)',
                    'q9': 'entertainment',
                    'q10': 'kitchen',

                    // === Section 2 (Questions 11-20) ===
                    'q11': 'Internet',
                    'q12': 'too long',
                    'q13': 'typed',
                    'q14': 'layout',
                    'q15': 'errors',
                    'q16': 'skills and experiences',
                    'q17': 'contact number',
                    'q18-20': ['C', 'E', 'F'],

                    // === Section 3 (Questions 21-30) ===
                    'q21': 'C',
                    'q22': 'B',
                    'q23': 'A',
                    'q24': 'C',
                    'q25': 'A',
                    'q26': 'A',
                    'q27': 'B',
                    'q28': 'C',
                    'q29': 'B',
                    'q30': 'A',

                    // === Section 4 (Questions 31-40) ===
                    'q31': 'cans',
                    'q32': 'lime',
                    'q33': 'tasteless',
                    'q34': 'returns',
                    'q35': 'warm',
                    'q36': 'soundproofed',
                    'q37': 'fresher',
                    'q38': ['texture', 'thickness'],
                    'q39': 'liquids',
                    'q40': 'strawberry'
                };

                function setupCheckboxLimits() {
                    const checkboxGroups = [
                        { name: 'q18-20', limit: 3 },
                    ];

                    checkboxGroups.forEach(group => {
                        const checkboxes = document.querySelectorAll(`input[name="${group.name}"]`);
                        checkboxes.forEach(checkbox => {
                            checkbox.addEventListener('click', () => {
                                const checkedCount = document.querySelectorAll(`input[name="${group.name}"]:checked`).length;
                                if (checkedCount > group.limit) {
                                    checkbox.checked = false;
                                }
                            });
                        });
                    });
                }

                function switchToPart(partNumber, andPlay = false) {
                    if (currentPart !== partNumber) {
                        const firstQuestionOfPart = (partNumber - 1) * 10 + 1;
                        currentQuestion = firstQuestionOfPart;
                    }
                    
                    currentPart = partNumber;

                    updateNavigation();
                    document.querySelectorAll('.question-part').forEach(part => part.classList.add('hidden'));
                    const partToShow = document.getElementById(`part-${partNumber}`);
                    if (partToShow) {
                        partToShow.classList.remove('hidden');
                    }

                    if (document.querySelector('.main-container.results-mode')) {
                        const transcriptionSource = document.querySelector(`#transcription-data [data-part="${partNumber}"]`);
                        const transcriptionTarget = document.getElementById('transcription-text');
                        if (transcriptionSource && transcriptionTarget) {
                            transcriptionTarget.innerHTML = transcriptionSource.innerHTML;
                        }
                    }

                    updateNavigation();
                }

                function updateNavigation() {
                    document.querySelectorAll('.footer__questionWrapper___1tZ46').forEach((wrapper, index) => {
                        wrapper.classList.remove('selected');
                        updateAttemptedCount(index + 1);
                    });
                    const currentWrapper = document.querySelectorAll('.footer__questionWrapper___1tZ46')[currentPart - 1];
                    if (currentWrapper) {
                        currentWrapper.classList.add('selected');
                    }
                    document.getElementById('prevBtn').disabled = currentQuestion === 1;
                    document.getElementById('nextBtn').disabled = currentQuestion === 40;
                }

                function goToQuestion(questionNumber) {
                    currentQuestion = questionNumber;
                    let partNumber = 1;
                    if (questionNumber > 10 && questionNumber <= 20) partNumber = 2;
                    else if (questionNumber > 20 && questionNumber <= 30) partNumber = 3;
                    else if (questionNumber > 30) partNumber = 4;
                    if (currentPart !== partNumber) {
                        switchToPart(partNumber);
                    }
                    document.querySelectorAll('.subQuestion').forEach(btn => btn.classList.remove('active'));
                    const questionBtn = document.querySelector(`.subQuestion[onclick="goToQuestion(${questionNumber})"]`);
                    if (questionBtn) questionBtn.classList.add('active');

                    // Scroll to the question
                    let questionElement;
                    if (questionNumber >= 18 && questionNumber <= 20) {
                        questionElement = document.querySelector('input[name="q18-20"]');
                    } else if (questionNumber >= 17 && questionNumber <= 18) {
                        questionElement = document.querySelector('input[name="q17-18"]');
                    } else if (questionNumber >= 19 && questionNumber <= 20) {
                        questionElement = document.querySelector('input[name="q19-20"]');
                    } else {
                        questionElement = document.getElementById(`q${questionNumber}`) || // text inputs
                                        document.querySelector(`[data-question="q${questionNumber}"]`) || // drag-drop
                                        document.querySelector(`input[name="q${questionNumber}"]`); // radio buttons
                    }
                    
                    if (questionElement) {
                        const questionContainer = questionElement.closest('.question');
                        if(questionContainer) {
                            questionContainer.scrollIntoView({ behavior: 'smooth', block: 'center' });
                            questionContainer.classList.add('flash');
                            setTimeout(() => {
                                questionContainer.classList.remove('flash');
                            }, 1000);
                        }
                    }
                    updateNavigation();
                }

                function nextPart() {
                    if (currentQuestion < 40) {
                        goToQuestion(currentQuestion + 1);
                    }
                }

                function previousPart() {
                    if (currentQuestion > 1) {
                        goToQuestion(currentQuestion - 1);
                    }
                }

                function highlightText() {
                    if (!selectedRange || selectedRange.collapsed) {
                        closeContextMenu();
                        return;
                    }
                    try {
                        const span = document.createElement('span');
                        span.className = 'highlight';
                        selectedRange.surroundContents(span);
                    } catch(err){
                        console.warn('Complex selection – fallback highlight');
                        document.execCommand('backColor', false, 'yellow');
                    }
                    window.getSelection().removeAllRanges();
                    closeContextMenu();
                }

                function addComment() {
                    const commentText = prompt('Enter your comment:');
                    if (!commentText || !selectedRange || selectedRange.collapsed) {
                        closeContextMenu();
                        return;
                    }
                    try {
                        const span = document.createElement('span');
                        span.className = 'comment-highlight';
                        const tooltip = document.createElement('span');
                        tooltip.className = 'comment-tooltip';
                        tooltip.textContent = commentText;
                        span.appendChild(tooltip);
                        selectedRange.surroundContents(span);
                    }catch(err){
                        console.warn('Complex selection – cannot comment');
                    }
                    window.getSelection().removeAllRanges();
                    closeContextMenu();
                }

                function clearHighlight() {
                    const elementToClear = contextElement; // Set by contextmenu handler
                    if (!elementToClear) {
                        closeContextMenu();
                        return;
                    }

                    const highlightId = elementToClear.getAttribute('data-highlight-id');
                    const elementsToClear = highlightId
                        ? Array.from(document.querySelectorAll(`[data-highlight-id="${highlightId}"]`))
                        : [elementToClear];

                    let commonParent = null;
                    if (elementsToClear.length > 0) {
                        commonParent = elementsToClear[0].parentNode;
                    }

                    elementsToClear.forEach(element => {
                        const parent = element.parentNode;
                        const fragment = document.createDocumentFragment();

                        while (element.firstChild) {
                            // Don't keep the tooltip for comments. Just unwrap everything.
                            if (element.firstChild.nodeType === 1 && element.firstChild.classList.contains('comment-tooltip')) {
                                element.removeChild(element.firstChild);
                            } else {
                                fragment.appendChild(element.firstChild);
                            }
                        }
                        parent.replaceChild(fragment, element);
                    });
                    
                    if (commonParent) {
                        commonParent.normalize(); // Merges adjacent text nodes
                    }
                    
                    closeContextMenu();
                }

                function clearAllHighlights() {
                    document.querySelectorAll('.highlight, .comment-highlight').forEach(element => {
                        const parent = element.parentNode;
                        const fragment = document.createDocumentFragment();

                        while (element.firstChild) {
                            if (element.firstChild.nodeType === 1 && element.firstChild.classList.contains('comment-tooltip')) {
                                element.removeChild(element.firstChild);
                            } else {
                                fragment.appendChild(element.firstChild);
                            }
                        }
                        parent.replaceChild(fragment, element);
                    });
                    closeContextMenu();
                }
                
                function closeContextMenu() {
                    document.getElementById('contextMenu').style.display = 'none';
                    contextElement = null;
                }

                function updateAttemptedCount(partNumber) {
                    const partContainer = document.getElementById(`part-${partNumber}`);
                    if (!partContainer) return;
                    const inputs = partContainer.querySelectorAll('input.answer-input:not([disabled]), input[type="radio"]:not([disabled]), input[type="checkbox"]:not([disabled])');
                    let answeredCount = 0;
                    const answeredGroups = {};
                    inputs.forEach(input => {
                        if (input.type === 'radio' || input.type === 'checkbox') {
                            if (input.checked && !answeredGroups[input.name]) {
                                answeredCount++;
                                answeredGroups[input.name] = true;
                            }
                        } else {
                            if (input.value.trim() !== '') answeredCount++;
                        }
                    });
                    const countDisplay = document.querySelector(`.footer__questionWrapper___1tZ46:nth-child(${partNumber}) .attemptedCount`);
                    if (countDisplay) countDisplay.textContent = `${answeredCount} of 10`;
                }

                function checkAnswers() {
                    let score = 0;
                    let resultsData = [];
                    document.querySelectorAll('.correct, .incorrect').forEach(el => el.classList.remove('correct', 'incorrect'));
                    
                    Object.keys(correctAnswers).forEach(key => {
                        const correctAnswer = correctAnswers[key];
                        let userAnswer = '';
                        let isCorrect = false;

                        if (key.includes('-')) { // Covers q11-12, q13-14 etc.
                            const qNumbers = key.substring(1).split('-').map(Number);
                            const userInputs = document.querySelectorAll(`input[name="${key}"]:checked`);
                            const userAnswers = Array.from(userInputs).map(input => input.value);
                            userAnswer = userAnswers.join(', ');
                            
                            let correctChoices = 0;
                            userAnswers.forEach(answer => {
                                if (correctAnswer.includes(answer)) {
                                    correctChoices++;
                                }
                            });
                            score += correctChoices;

                            const isFullyCorrect = correctChoices === correctAnswer.length && userAnswers.length === correctAnswer.length;

                            qNumbers.forEach(qNum => {
                                const btn = document.querySelector(`.subQuestion[onclick="goToQuestion(${qNum})"]`);
                                if (btn) {
                                    btn.classList.remove('answered');
                                    btn.classList.add(isFullyCorrect ? 'correct' : 'incorrect');
                                }
                            });

                            document.querySelectorAll(`input[name="${key}"]`).forEach(checkbox => {
                                const label = checkbox.closest('li');
                                if (correctAnswer.includes(checkbox.value)) {
                                    if(label) label.classList.add('correct');
                                }
                                if (checkbox.checked && !correctAnswer.includes(checkbox.value)) {
                                    if(label) label.classList.add('incorrect');
                                }
                            });

                            const questionLabel = `${qNumbers[0]}-${qNumbers[qNumbers.length - 1]}`;
                            resultsData.push({
                                question: questionLabel,
                                userAnswer: userAnswer || 'No Answer',
                                correctAnswer: correctAnswer.join(', '),
                                isCorrect: isFullyCorrect
                            });

                        } else { // For single-answer questions
                            const qNum = parseInt(key.replace('q', ''), 10);
                            const btn = document.querySelector(`.subQuestion[onclick="goToQuestion(${qNum})"]`);

                            const element = document.getElementById(key);
                            const radioChecked = document.querySelector(`input[name="${key}"]:checked`);
                            const dropZone = document.querySelector(`.drop-zone[data-question="${key}"]`);

                            if (element) {
                                userAnswer = element.value.trim();
                                const acceptedAnswers = Array.isArray(correctAnswer) ? correctAnswer : [String(correctAnswer)];
                                isCorrect = acceptedAnswers.some(ans => ans.toLowerCase() === userAnswer.toLowerCase());
                                if (isCorrect) {
                                    element.classList.add('correct');
                                } else {
                                    element.classList.add('incorrect');
                                    const correctAnswerSpan = document.createElement('span');
                                    correctAnswerSpan.className = 'correct-answer-text';
                                    correctAnswerSpan.textContent = `(Correct: ${acceptedAnswers[0]})`;
                                    element.parentNode.insertBefore(correctAnswerSpan, element.nextSibling);
                                }
                            } else if (document.querySelector(`input[name="${key}"]`)) { // Radio buttons
                                const radioChecked = document.querySelector(`input[name="${key}"]:checked`);
                                userAnswer = radioChecked ? radioChecked.value : '';
                                isCorrect = userAnswer === correctAnswer;
                                
                                const isTable = document.querySelector(`input[name="${key}"]`).closest('.mcq-table');

                                if (radioChecked) {
                                    const elementToMark = isTable ? radioChecked.closest('tr') : radioChecked.closest('label');
                                    if (elementToMark) {
                                        elementToMark.classList.add(isCorrect ? 'correct' : 'incorrect');
                                    }
                                }

                                
                                if (!isCorrect) {
                                    const correctRadio = document.querySelector(`input[name="${key}"][value="${correctAnswer}"]`);
                                    if (correctRadio) {
                                        const correctElementToMark = isTable ? correctRadio.closest('tr') : correctRadio.closest('label');
                                        if (correctElementToMark) {
                                            correctElementToMark.classList.add('correct');
                                        }
                                    }
                                }
                            } else if (dropZone) {
                                const droppedItem = dropZone.querySelector('.drag-item');
                                userAnswer = droppedItem ? droppedItem.getAttribute('data-value') : '';
                                if (droppedItem && droppedItem.getAttribute('data-value') === correctAnswer) {
                                    isCorrect = true;
                                    dropZone.classList.add('correct');
                                } else {
                                    dropZone.classList.add('incorrect');
                                    const correctAnswerSpan = document.createElement('span');
                                    correctAnswerSpan.className = 'correct-answer-text';
                                    correctAnswerSpan.textContent = `(Correct: ${correctAnswer})`;
                                    dropZone.appendChild(correctAnswerSpan);
                                }
                            }

                            if (isCorrect) score++;

                            if (btn) {
                                btn.classList.remove('answered');
                                btn.classList.add(isCorrect ? 'correct' : 'incorrect');
                            }

                            resultsData.push({
                                question: qNum,
                                userAnswer: userAnswer || 'No Answer',
                                correctAnswer: String(correctAnswer),
                                isCorrect: isCorrect
                            });
                        }
                    });

                    const deliverButton = document.getElementById('deliver-button');
                    const band = (function(raw){
                        if(raw>=39) return 9;
                        if(raw>=37) return 8.5;
                        if(raw>=35) return 8;
                        if(raw>=32) return 7.5;
                        if(raw>=30) return 7;
                        if(raw>=26) return 6.5;
                        if(raw>=23) return 6;
                        if(raw>=18) return 5.5;
                        if(raw>=16) return 5;
                        if(raw>=13) return 4.5;
                        if(raw>=10) return 4;
                        if(raw>=8)  return 3.5;
                        if(raw>=6)  return 3;
                        if(raw>=4)  return 2.5;
                        if(raw>=2)  return 2;
                        if(raw===1) return 1.5;
                        return 0;
                    })(score);
                    deliverButton.innerHTML = `<span>Score: ${score} / 40 (Band ${band})</span><br><span>Estimated Band: ${band}</span>`;
                    deliverButton.disabled = true;
                    document.querySelectorAll('.answer-input, input[type="radio"], input[type="checkbox"]').forEach(input => {
                        input.disabled = true;
                    });
                    document.querySelectorAll('.drag-item').forEach(item => {
                        item.setAttribute('draggable', 'false');
                        item.style.cursor = 'default';
                    });
                    document.querySelectorAll('.drop-zone').forEach(zone => {
                        zone.classList.remove('drag-over'); // Ensure no lingering hover styles
                    });

                    document.querySelector('.main-container').classList.add('results-mode');
                    switchToPart(currentPart); // Show the transcription for the current part

                    // Populate and show modal
                    const modal = document.getElementById('result-modal');
                    const scoreSummary = document.getElementById('score-summary');
                    const resultDetails = document.getElementById('result-details');
                    
                    scoreSummary.textContent = `You scored ${score} out of 40 (Band ${band}).`;
                    
                    let tableHTML = '<table><tr><th>Question</th><th>Your Answer</th><th>Correct Answer</th><th>Result</th></tr>';
                    resultsData.forEach(res => {
                        tableHTML += `
                            <tr>
                                <td>${res.question}</td>
                                <td>${res.userAnswer}</td>
                                <td>${res.correctAnswer}</td>
                                <td class="${res.isCorrect ? 'result-correct' : 'result-incorrect'}">
                                    ${res.isCorrect ? '✔ Correct' : '✖ Incorrect'}
                                </td>
                            </tr>
                        `;
                    });
                    tableHTML += '</table>';
                    resultDetails.innerHTML = tableHTML;

                    modal.style.display = 'flex';
                }
                
                function startTimer() {
                    timerInterval = setInterval(() => {
                        timeInSeconds--;
                        const minutes = Math.floor(timeInSeconds / 60);
                        const seconds = timeInSeconds % 60;
                        timerDisplay.textContent = `${minutes}:${seconds < 10 ? '0' : ''}${seconds}`;
                        if (timeInSeconds <= 0) {
                            clearInterval(timerInterval);
                            timerDisplay.textContent = "Time's up!";
                            checkAnswers();
                        }
                    }, 1000);
                }

                function formatTime(seconds) {
                    const minutes = Math.floor(seconds / 60);
                    const remainingSeconds = Math.floor(seconds % 60);
                    return `${minutes}:${remainingSeconds < 10 ? '0' : ''}${remainingSeconds}`;
                }

                // Event Listeners
                playPauseBtn.addEventListener('click', () => {
                    if (!testStarted) {
                        testStarted = true; // Timer removed, skip startTimer
                        switchToPart(currentPart, true);
                    } else {
                        if (audioPlayer.paused) {
                            // If paused, ensure the audio source is for the current part
                            if (!audioPlayer.src.includes(audioSource)) {
                                audioPlayer.src = audioSource;
                            }
                            audioPlayer.play();
                        } else {
                            audioPlayer.pause();
                        }
                    }
                });
                
                audioPlayer.addEventListener('play', () => {
                    playPauseBtn.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z"/></svg>`;
                });

                audioPlayer.addEventListener('pause', () => {
                    playPauseBtn.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8 5v14l11-7z"/></svg>`;
                });

                audioPlayer.addEventListener('ended', () => {
                    if (currentPart < 4) {
                        switchToPart(currentPart + 1, true);
                    }
                });

                audioPlayer.addEventListener('loadedmetadata', () => {
                    progressBar.max = audioPlayer.duration;
                    totalDurationEl.textContent = formatTime(audioPlayer.duration);
                });

                audioPlayer.addEventListener('timeupdate', () => {
                    progressBar.value = audioPlayer.currentTime;
                    currentTimeEl.textContent = formatTime(audioPlayer.currentTime);
                });

                progressBar.addEventListener('input', () => {
                    audioPlayer.currentTime = progressBar.value;
                });

                volumeSlider.addEventListener('input', (e) => audioPlayer.volume = e.target.value);

                speedBtn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    speedOptions.classList.toggle('hidden');
                });

                speedOptions.addEventListener('click', (e) => {
                    if (e.target.dataset.speed) {
                        const speed = parseFloat(e.target.dataset.speed);
                        audioPlayer.playbackRate = speed;
                        speedBtn.textContent = `${speed}x`;
                        speedOptions.classList.add('hidden');
                    }
                });
                
                document.addEventListener('click', () => {
                    if (!speedOptions.classList.contains('hidden')) {
                        speedOptions.classList.add('hidden');
                    }
                });

                document.getElementById('deliver-button').addEventListener('click', checkAnswers);
                
                // Go To Question Widget Logic
                const gotoWidget = document.getElementById('goto-widget');
                const gotoInput = document.getElementById('goto-input');
                const gotoBtn = document.getElementById('goto-btn');

                document.addEventListener('keydown', (e) => {
                    if (e.key >= '0' && e.key <= '9' && document.activeElement.tagName !== 'INPUT') {
                        e.preventDefault();
                        gotoWidget.classList.remove('hidden');
                        gotoInput.focus();
                        gotoInput.value = e.key;
                    }
                    if (e.key === 'Enter' && document.activeElement === gotoInput) {
                        gotoBtn.click();
                    }
                    if (e.key === 'Escape') {
                        gotoWidget.classList.add('hidden');
                        gotoInput.value = '';
                    }
                });

                if (gotoBtn) {
                    gotoBtn.addEventListener('click', () => {
                        const qNum = parseInt(gotoInput.value, 10);
                        if (qNum >= 1 && qNum <= 40) {
                            goToQuestion(qNum);
                            gotoWidget.classList.add('hidden');
                            gotoInput.value = '';
                        } else {
                            alert('Please enter a number between 1 and 40.');
                        }
                    });
                }

                // Add listener for the modal close button
                document.getElementById('modal-close-button').addEventListener('click', () => {
                    document.getElementById('result-modal').style.display = 'none';
                });

                // === Tap-to-select & tap-to-drop for drag items (mobile support) ===
                document.body.addEventListener('click', function(e){
                    const item = e.target.closest('.drag-item');
                    if(item && item.getAttribute('draggable')){
                        // Toggle selection
                        document.querySelectorAll('.drag-item.selected').forEach(i=>i.classList.remove('selected'));
                        item.classList.add('selected');
                        draggedElement = item;
                        return;
                    }
                    const dz = e.target.closest('.drop-zone');
                    if(dz && draggedElement){
                        // If already filled, move old back
                        const optionsList = document.querySelector('.matching-options-list');
                        if(dz.children.length>0 && dz.firstElementChild!==draggedElement){
                            optionsList.appendChild(dz.firstElementChild);
                        }
                        dz.appendChild(draggedElement);
                        draggedElement.classList.remove('selected');
                        draggedElement=null;
                        updateAnsweredIndicators();
                    }
                });

                // === Mobile highlight/comment toolbar ===
                const mobileToolbar = document.getElementById('mobile-selection-menu');
                function positionToolbar(){
                    const sel = window.getSelection();
                    if(sel.rangeCount===0 || sel.isCollapsed){
                        mobileToolbar.classList.add('hidden');
                        return;
                    }
                    const range = sel.getRangeAt(0);
                    const rect = range.getBoundingClientRect();
                    mobileToolbar.style.top = window.scrollY + rect.top - mobileToolbar.offsetHeight - 8 + 'px';
                    mobileToolbar.style.left = window.scrollX + rect.left + 'px';
                    mobileToolbar.classList.remove('hidden');
                }
                document.addEventListener('selectionchange', () => {
                    const sel = window.getSelection();
                    if(sel && sel.rangeCount>0 && !sel.isCollapsed){
                        selectedRange = sel.getRangeAt(0);
                        selectedText = sel.toString();
                    }
                    if('ontouchstart' in window || navigator.maxTouchPoints>0){
                        setTimeout(positionToolbar, 0);
                    }
                });
                document.addEventListener('click', (e)=>{
                    if(!e.target.closest('#mobile-selection-menu')){
                        mobileToolbar.classList.add('hidden');
                    }
                });

                /* ---------------- Drag and Drop for Matching Questions ---------------- */

                (function initDragAndDrop() {
                    const container = document.querySelector('.left-panel');
                    if (!container) return;

                    container.addEventListener('dragstart', (e) => {
                        if (e.target.classList.contains('drag-item')) {
                            draggedElement = e.target;
                            setTimeout(() => {
                                e.target.classList.add('dragging');
                            }, 0);
                        }
                    });

                    container.addEventListener('dragend', (e) => {
                        if (draggedElement) {
                            draggedElement.classList.remove('dragging');
                            draggedElement = null;
                        }
                    });

                    container.addEventListener('dragover', (e) => {
                        e.preventDefault();
                        const target = e.target;
                        const dropZone = target.closest('.drop-zone');
                        const optionsList = target.closest('.matching-options-list');

                        if (dropZone || optionsList) {
                            const overElement = dropZone || optionsList;
                            document.querySelectorAll('.drag-over').forEach(el => el.classList.remove('drag-over'));
                            overElement.classList.add('drag-over');
                        }
                    });

                    container.addEventListener('dragleave', (e) => {
                        const target = e.target;
                        const dropZone = target.closest('.drop-zone');
                        const optionsList = target.closest('.matching-options-list');
                        if (dropZone || optionsList) {
                            const overElement = dropZone || optionsList;
                            overElement.classList.remove('drag-over');
                        }
                    });


                    container.addEventListener('drop', (e) => {
                        e.preventDefault();
                        if (!draggedElement) return;

                        const dropTarget = e.target.closest('.drop-zone, .matching-options-list');
                        if (!dropTarget) {
                            draggedElement.classList.remove('dragging');
                            draggedElement = null;
                            return;
                        }

                        document.querySelectorAll('.drag-over').forEach(el => el.classList.remove('drag-over'));
                        
                        const existingItem = dropTarget.matches('.drop-zone') ? dropTarget.querySelector('.drag-item') : null;
                        const originalParent = draggedElement.parentNode;

                        // If there's an item in the target dropzone, swap them
                        if (existingItem) {
                            originalParent.appendChild(existingItem);
                        }
                        
                        dropTarget.appendChild(draggedElement);

                        if(dropTarget.matches('.drop-zone')) {
                            const placeholder = dropTarget.querySelector('.placeholder');
                            if (placeholder) placeholder.style.display = 'none';
                        }

                        draggedElement.classList.remove('dragging');
                        draggedElement = null;
                        updateAnsweredIndicators();
                    });
                })();


                document.addEventListener('DOMContentLoaded', () => {
                    switchToPart(1);
                    goToQuestion(1);
                    setupCheckboxLimits();

                    document.body.addEventListener('contextmenu', function (e) {
                        const text = window.getSelection().toString();
                        if (!text) return;
                        e.preventDefault();
                        const menu = document.getElementById('contextMenu');
                        menu.style.left = e.pageX + 'px';
                        menu.style.top = e.pageY + 'px';
                        menu.style.display = 'block';

                        const target = e.target;
                        const clearItem = document.getElementById('clear-item');
                        contextElement = target.closest('.highlight, .comment-highlight');
                        if(contextElement){
                            clearItem.style.display = 'block';
                        } else {
                            clearItem.style.display = 'none';
                        }
                    });
                    
                    document.body.addEventListener('click', function(e) {
                        if (e.target.closest('.context-menu')) return;
                        document.getElementById('contextMenu').style.display = 'none';
                    });
                });

                // Initial setup on DOM load
                document.addEventListener('DOMContentLoaded', updateAnsweredIndicators);

                document.querySelectorAll('.mcq-table td').forEach(cell => {
                    cell.addEventListener('click', (e) => {
                        if (e.target.tagName !== 'INPUT') {
                            const radio = cell.querySelector('input[type="radio"]');
                            if (radio && !radio.disabled) {
                                radio.checked = true;
                            }
                        }
                    });
                });

                document.querySelectorAll('.answer-input, input[type="radio"], input[type="checkbox"]').forEach(input => {
                    input.addEventListener('input', updateAnsweredIndicators);
                    input.addEventListener('change', updateAnsweredIndicators);
                });

                function initAllDragAndDrop() {
                    const dragItems = document.querySelectorAll('.drag-item');
                    const dropZones = document.querySelectorAll('.drop-zone');

                    dragItems.forEach(item => {
                        item.addEventListener('dragstart', handleDragStart);
                        item.addEventListener('dragend', handleDragEnd);
                    });

                    dropZones.forEach(zone => {
                        zone.addEventListener('dragover', handleDragOver);
                        zone.addEventListener('dragleave', handleDragLeave);
                        zone.addEventListener('drop', handleDrop);
                    });

                    function handleDragStart(e) {
                        draggedElement = e.target;
                        setTimeout(() => e.target.classList.add('dragging'), 0);
                    }

                    function handleDragEnd(e) {
                        e.target.classList.remove('dragging');
                    }

                    function handleDragOver(e) {
                        e.preventDefault();
                        const zone = e.target.closest('.drop-zone');
                        if (zone) zone.classList.add('drag-over');
                    }

                    function handleDragLeave(e) {
                        const zone = e.target.closest('.drop-zone');
                        if (zone) zone.classList.remove('drag-over');
                    }

                    function handleDrop(e) {
                        e.preventDefault();
                        const targetZone = e.target.closest('.drop-zone');
                        if (!targetZone || !draggedElement) return;
                        
                        targetZone.classList.remove('drag-over');

                        const sourceContainer = draggedElement.parentNode;
                        const itemInTargetZone = targetZone.querySelector('.drag-item');
                        
                        // Prevent dropping on self or non-droppable area inside zone
                        if (e.target.classList.contains('drag-item') && e.target !== draggedElement) {
                            return; // Or handle swap explicitly here if needed
                        }
                        
                        if (itemInTargetZone && itemInTargetZone !== draggedElement) {
                            // If source is an options list, move the existing item back
                            const optionsList = findParentOptionsList(targetZone);
                            if (sourceContainer.classList.contains('matching-options-list') || sourceContainer.classList.contains('map-options-list')) {
                            optionsList.appendChild(itemInTargetZone);
                            } 
                            // If source is another drop zone (swapping)
                            else if (sourceContainer.classList.contains('drop-zone')) {
                                sourceContainer.appendChild(itemInTargetZone);
                            }
                        }

                        targetZone.appendChild(draggedElement);
                        if (targetZone.querySelector('.placeholder')) {
                            targetZone.querySelector('.placeholder').style.display = 'none';
                        }
                        
                        updateAnsweredIndicators();
                    }

                    function findParentOptionsList(element) {
                        // Specific for map
                        if (element.closest('#map-drag-container')) {
                            return document.getElementById('map-options-q11-15');
                        }
                        // Generic for matching
                        const container = element.closest('.matching-container');
                        if (container) {
                            return container.querySelector('.matching-options-list');
                        }
                        return null;
                    }
                }

                let transcriptionHighlighted = false;
                function highlightAnswersInTranscription() {
                    if (transcriptionHighlighted) return;

                    const highlightedTranscripts = { 1: '', 2: '', 3: '', 4: '' };

                    for (let i = 1; i <= 4; i++) {
                        const partElement = document.querySelector(`#transcription-data [data-part="${i}"]`);
                        if (partElement) highlightedTranscripts[i] = partElement.innerHTML;
                    }

                    for (const key in correctAnswers) {
                        const answers = Array.isArray(correctAnswers[key]) ? correctAnswers[key] : [correctAnswers[key]];
                        if (answers.every(answer => /^[A-G]$/.test(answer))) {
                            continue;
                        }

                        const qNum = parseInt(key.match(/\d+/)[0]);
                        let partNumber = 1;
                        if (qNum > 10 && qNum <= 20) partNumber = 2;
                        else if (qNum > 20 && qNum <= 30) partNumber = 3;
                        else if (qNum > 30) partNumber = 4;

                        if (!highlightedTranscripts[partNumber]) continue;

                        let answersToHighlight = correctAnswers[key];
                        if (!Array.isArray(answersToHighlight)) {
                            answersToHighlight = [answersToHighlight];
                        }

                        for (const answer of answersToHighlight) {
                            if (/^[A-G]$/.test(answer)) continue;
                            
                            let searchTerm = answer.replace(/[-\/\\^$*+?.()|[\]{}]/g, '\\$&');
                            searchTerm = searchTerm.replace(/\\\(s\\\)/g, '(s)?');
                            
                            const regex = new RegExp(`\\b(${searchTerm})\\b`, 'gi');
                            
                            highlightedTranscripts[partNumber] = highlightedTranscripts[partNumber].replace(
                                regex,
                                '<span class="highlight">$1</span>'
                            );
                        }
                    }

                    for (let i = 1; i <= 4; i++) {
                        const partElement = document.querySelector(`#transcription-data [data-part="${i}"]`);
                        if(partElement) partElement.innerHTML = highlightedTranscripts[i];
                    }
                    transcriptionHighlighted = true;
                }
                
                function closeContextMenu() {
                    document.getElementById('contextMenu').style.display = 'none';
                    contextElement = null;
                }
                // ========== SIMPLE AUTOSAVE ==========
(function() {
    console.log('🔄 Autosave initialized');
    
    // Save to localStorage every 30 seconds
    const AUTOSAVE_INTERVAL = 30000; // 30 seconds
    const STORAGE_KEY = 'ielts-reading-autosave';
    
    // Function to save all answers
    function saveAnswers() {
        const saveData = {
            timestamp: new Date().toISOString(),
            answers: {}
        };
        
        // Save text inputs
        document.querySelectorAll('.answer-input[type="text"]').forEach(input => {
            if (input.value.trim()) {
                saveData.answers[input.id] = input.value;
            }
        });
        
        // Save select dropdowns
        document.querySelectorAll('.answer-input[type="select"], select.answer-input').forEach(select => {
            if (select.value) {
                saveData.answers[select.id] = select.value;
            }
        });
        
        // Save radio buttons
        document.querySelectorAll('input[type="radio"]:checked').forEach(radio => {
            saveData.answers[radio.name] = radio.value;
        });
        
        // Save drag & drop answers
        document.querySelectorAll('.drop-zone.filled .drag-item').forEach(item => {
            const dropZone = item.closest('.drop-zone, .summary-drop-zone');
            const questionId = dropZone?.dataset.qStart || dropZone?.dataset.question;
            if (questionId) {
                saveData.answers[`drag-${questionId}`] = item.dataset.value;
            }
        });
        
        // Save to localStorage
        localStorage.setItem(STORAGE_KEY, JSON.stringify(saveData));
        console.log('💾 Autosaved at', new Date().toLocaleTimeString());
    }
    
    // Function to load saved answers
    function loadSavedAnswers() {
        const saved = localStorage.getItem(STORAGE_KEY);
        if (!saved) {
            console.log('📭 No saved data found');
            return;
        }
        
        try {
            const saveData = JSON.parse(saved);
            const answers = saveData.answers;
            
            // Load text inputs
            Object.keys(answers).forEach(key => {
                if (key.startsWith('q')) {
                    const input = document.getElementById(key);
                    if (input && (input.type === 'text' || input.tagName === 'SELECT')) {
                        input.value = answers[key];
                    }
                }
                
                // Load radio buttons
                if (!key.startsWith('drag-')) {
                    const radio = document.querySelector(`input[name="${key}"][value="${answers[key]}"]`);
                    if (radio) radio.checked = true;
                }
                
                // Load drag & drop (simplified - just marks as answered)
                if (key.startsWith('drag-')) {
                    const questionNum = key.replace('drag-', '');
                    const navBtn = document.querySelector(`.subQuestion[onclick="goToQuestion(${questionNum})"]`);
                    if (navBtn) navBtn.classList.add('answered');
                }
            });
            
            console.log('📂 Loaded saved answers from', new Date(saveData.timestamp).toLocaleString());
            updateAllIndicators(); // Update the answer counts
        } catch (error) {
            console.error('❌ Error loading saved answers:', error);
        }
    }
    
    // Auto-save every 30 seconds
    setInterval(saveAnswers, AUTOSAVE_INTERVAL);
    
    // Save when user leaves the page
    window.addEventListener('beforeunload', saveAnswers);
    
    // Save when user interacts with inputs
    document.addEventListener('input', () => {
        clearTimeout(window.saveTimeout);
        window.saveTimeout = setTimeout(saveAnswers, 2000); // Debounce: save 2 seconds after last input
    });
    
    // Load saved answers when page loads
    setTimeout(loadSavedAnswers, 500); // Small delay to ensure DOM is ready
    
    // Add a simple status indicator to the timer area
    const statusIndicator = document.createElement('span');
    statusIndicator.id = 'autosave-status';
    statusIndicator.style.cssText = 'margin-left: 15px; font-size: 12px; color: #666;';
    statusIndicator.innerHTML = '💾 Autosave: <span style="color: green;">ON</span>';
    document.querySelector('.timer-container').appendChild(statusIndicator);
    
    // Visual feedback when saving
    let saveCount = 0;
    setInterval(() => {
        const statusText = statusIndicator.querySelector('span');
        if (saveCount % 2 === 0) {
            statusText.style.color = '#4CAF50';
            statusText.textContent = 'ON';
        } else {
            statusText.style.color = '#666';
            statusText.textContent = 'ON';
        }
        saveCount++;
    }, 15000);
    
    console.log('✅ Autosave enabled - saving every 30 seconds');
})();
            </script>
        </body>
        </html>
