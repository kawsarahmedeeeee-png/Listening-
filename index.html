<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IELTS CDI Listening Practice</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: Arial, sans-serif;
            background-color: #ffffff;
            line-height: 1.4;
            font-size: 16px;
            padding-bottom: 90px; /* nav-row height (80px) + some extra spacing */
        }

        /* Page watermark */
        body::after {
            content: "@MINDLESS_WRITER";
            position: fixed;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%) rotate(-20deg);
            font-size: 72px;
            font-weight: 800;
            letter-spacing: 2px;
            color: #000000;
            opacity: 0.02; /* subtle */
            pointer-events: none;
            z-index: 0;
            white-space: nowrap;
        }

        .header {
            background-color: #ffffff;
            padding: 12px 20px;
            border-bottom: 1px solid #e0e0e0;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 100;
            height: 60px;
        }

        .ielts-logo {
            display: none;
        }
        #deliver-button {
    pointer-events: none;
    opacity: 0.5;
    cursor: not-allowed;
}

        .test-info {
            display: flex;
            align-items: center;
            gap: 30px;
            font-size: 14px;
            color: #333;
        }

        .audio-indicator {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 16px;
        }

        .audio-icon {
            width: 16px;
            height: 16px;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"></polygon></svg>') no-repeat center;
        }

        .header-icons {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        #volume-slider {
            -webkit-appearance: none;
            appearance: none;
            width: 80px;
            height: 4px;
            background: #ddd;
            outline: none;
            border-radius: 2px;
            cursor: pointer;
        }

        #volume-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 14px;
            height: 14px;
            border-radius: 50%;
            background: #333;
            cursor: pointer;
        }

        #volume-slider::-moz-range-thumb {
            width: 14px;
            height: 14px;
            border-radius: 50%;
            background: #333;
            cursor: pointer;
            border: none;
        }

        .icon {
            width: 20px;
            height: 20px;
            cursor: pointer;
            opacity: 0.7;
            color: #333;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .icon:hover {
            opacity: 1;
        }
        
        #play-pause-btn {
            background: none;
            border: none;
            padding: 0;
        }

        .main-container {
            margin-top: 60px;
            display: flex;
            background: #ffffff;
            padding-bottom: 100px; /* Space for bottom nav */
        }

        .main-container.results-mode {
            display: flex;
            flex-direction: row;
        }

        /* Left Panel */
        .left-panel {
            width: 100%;
            padding: 20px;
            transition: width 0.4s ease;
        }

        .main-container.results-mode .left-panel {
            width: 75%;
            overflow-y: auto;
            height: calc(100vh - 195px);
        }

        /* Right Panel */
        .right-panel {
            display: none;
            width: 50%;
            padding: 20px;
            position: relative;
            border-left: 1px solid #e0e0e0;
            overflow-y: auto;
            height: calc(100vh - 195px);
        }

        #transcription-container h2 {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 10px;
        }

        #transcription-text {
            white-space: pre-wrap; /* preserve line breaks from source */
            font-family: inherit;
            font-size: 15px;
            line-height: 1.7;
        }
        
        .transcription-instruction {
            display: block;
            margin: 1em 0;
            font-style: italic;
            color: #444;
        }

        .main-container.results-mode .right-panel {
            display: block;
            width: 25%;
            border-left: 1px solid #e0e0e0;
            border-top: none;
            height: calc(100vh - 195px);
            overflow-y: auto;
        }

        .help-button {
            background: #4a90e2;
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 4px;
            font-size: 14px;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 5px;
            margin-bottom: 20px;
        }

        /* Inline correct answer hint (shown after checking) */
        .correct-inline {
            color: #28a745;
            font-weight: 700;
            margin-left: 10px;
            display: inline-block;
            vertical-align: middle;
            white-space: nowrap;
        }
        .correct-inline::before {
            content: "\2192  "; /* right arrow */
            font-weight: 700;
        }

        .help-button:hover {
            background: #357abd;
        }

        .section-title {
            font-weight: bold;
            margin-bottom: 15px;
            font-size: 18px;
        }

        .people-section {
            margin-bottom: 30px;
        }

        .people-table {
            width: 100%;
            border-collapse: collapse;
            border: 1px solid #ccc;
        }

        .people-table th {
            text-align: left;
            padding: 10px;
            font-weight: bold;
            border: 1px solid #ddd;
        }

        .people-table td {
            padding: 8px 10px;
            border: 1px solid #ddd;
        }
        #part-4 .questions-container {
            width: 80%;
        }

        /* Matching cell styling */
        .matching-cell {
            transition: all 0.2s ease;
        }
        
        .matching-cell:hover {
            background-color: #e3f2fd !important;
            transform: scale(1.02);
        }
        
        .matching-cell.selected {
            background-color: #4a90e2 !important;
            color: white !important;
            font-weight: bold;
        }

        #part-1 table td {
            line-height: 1.8;
        }
        /* Increase line height for tables in Part 4 */
        #part-4 table td {
            line-height: 2.0;
            padding-top: 10px;
            padding-bottom: 10px;
        }
        #part-4 table td div { margin: 8px 0; }
        /* Increase line height for Part 3 table (Questions 24-30) */
        #part-3 table td {
            line-height: 2.0;
            padding-top: 10px;
            padding-bottom: 10px;
            vertical-align: top;
        }
        /* Geosequestration table styling */
        .geo-table { width: 100%; border-collapse: collapse; margin-top: 10px; }
        .geo-table th, .geo-table td { border: 1px solid #e5e7eb; padding: 14px; vertical-align: top; }
        .geo-table thead th { background: #f7f9fc; text-align: center; font-weight: 700; }
        .geo-table .arrow-row td { text-align: center; font-size: 20px; color: #6b7280; }

        .person-name {
            font-size: 16px;
        }

        .question-number {
            background: white;
            border: 1px solid #4a90e2;
            padding: 4px 8px;
            border-radius: 3px;
            font-weight: bold;
            font-size: 14px;
            color: #4a90e2;
            min-width: 30px;
            text-align: center;
        }

        .assigned-responsibility {
            background: #f0f0f0;
            padding: 4px 8px;
            border-radius: 3px;
            font-size: 14px;
            border: 1px solid #ddd;
        }

        .responsibilities-section {
            margin-bottom: 30px;
        }

        .responsibility-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 8px;
            margin-bottom: 20px;
        }

        .responsibility-item {
            background: #f8f9fa;
            border: 1px solid #ddd;
            padding: 8px 12px;
            border-radius: 4px;
            cursor: move;
            font-size: 16px;
            text-align: center;
            transition: all 0.2s;
        }

        .responsibility-item:hover {
            background: #e9ecef;
            transform: translateY(-1px);
        }

        .responsibility-item.dragging {
            opacity: 0.5;
            transform: rotate(2deg);
        }

        .questions-section {
            margin-bottom: 20px;
        }

        .question-title {
            font-weight: bold;
            margin-bottom: 10px;
            font-size: 16px;
        }

        .instruction {
            margin-bottom: 20px;
            font-size: 16px;
            color: #666;
        }

        .centered-title {
            text-align: center;
            font-size: 20px;
            font-weight: bold;
            margin-bottom: 15px;
        }

        /* Map Styles */
        .map-container {
            position: relative;
            margin: 20px auto;
            width: 100%;
            max-width: 600px;
            /* display: block; */
            /* display: flex; */
        }
        .map-container img {
            width: 100%;
            display: block;
        }
        .map-drop-zone {
            position: absolute;
            width: 13%;
            height: 15%;
            border: 2px dashed #999;
            background-color: rgba(255, 255, 255, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: #555;
            border-radius: 4px;
            padding: 2px;
        }
        .map-drop-zone:hover {
            background-color: rgba(230, 244, 255, 0.7);
            border-color: #4a90e2;
        }
        .map-drop-zone .drag-item {
            font-size: 14px;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 2px;
        }
        .map-options-list {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
            margin-top: 20px;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            background-color: #f9f9f9;
        }
        .map-options-list .drag-item {
            width: calc(25% - 10px);
            text-align: center;
        }

        /* Navigation Arrows */
        .nav-arrows {
            position: fixed;
            bottom: 100px;
            right: 20px;
            display: flex;
            gap: 5px;
            z-index: 101;
        }

        .nav-arrow {
            width: 50px;
            height: 50px;
            background: #333;
            color: white;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 22px;
            font-weight: bold;
        }

        .nav-arrow:hover {
            background: #555;
        }

        .nav-arrow:disabled {
            background: #ccc;
            cursor: not-allowed;
        }

        /* Bottom Navigation - Exact Match */
        .nav-row {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: #ffffff;
        
            padding: 0;
            display: flex;
            align-items: center;
            height: 80px;
            z-index: 100;

            /* Allow horizontal scrolling on smaller screens */
            overflow-x: auto;
            overflow-y: hidden;
            white-space: nowrap;
            -webkit-overflow-scrolling: touch;
        }

        /* Prevent "Score/Band" button text overflow on small screens */
        .footer__deliverButton___3FM07 {
            max-width: 42%;
            white-space: normal;          /* allow wrapping */
            word-break: break-word;       /* break long text if needed */
            line-height: 1.2;
        }
        @media (max-width: 768px) {
            .footer__deliverButton___3FM07 {
                max-width: 55%;
                padding: 10px 12px;
                font-size: 14px;
            }
        }
        @media (max-width: 480px) {
            .footer__deliverButton___3FM07 {
                max-width: 65%;
                padding: 8px 10px;
                font-size: 13px;
            }
        }

        .footer__questionWrapper___1tZ46 {
            display: flex;
            align-items: center;
            margin-right: 20px;
            flex-shrink: 0;
        }


        .footer__questionNo___3WNct {
            background: none;
            border: none;
            padding: 10px 15px;
            font-size: 16px;
            font-weight: 600;
            color: #333;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 5px;
            transition: background-color 0.2s;
        }

        .footer__questionNo___3WNct:hover {
            background-color: #f8f9fa;
        }

        .section-prefix {
            font-size: 16px;
        }

        .sectionNr {
            font-size: 16px;
            font-weight: bold;
        }

        .attemptedCount {
            font-size: 14px;
            color: #666;
            margin-left: 5px;
            font-weight: 400; /* Normal weight */
        }

        @media (max-width: 1024px) {
            .attemptedCount {
                display: none;
            }
        }

        .footer__questionWrapper___1tZ46.selected .attemptedCount {
            display: none;
        }

        .footer__subquestionWrapper___9GgoP {
            display: none;
            gap: 2px;
            margin-left: 10px;
        }

        .footer__questionWrapper___1tZ46.selected .footer__subquestionWrapper___9GgoP {
            display: flex;
        }

        .subQuestion {
            width: 32px;
            height: 32px;
            border: 1px solid #ccc;
            background: white;
            color: #333;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
            border-radius: 2px;
        }

        .subQuestion.answered {
            background-color: #e9ecef;
            border-color: #ddd;
        }
        .subQuestion.correct {
            background-color: #28a745;
            color: white;
            border-color: #28a745;
        }
        .subQuestion.incorrect {
            background-color: #dc3545;
            color: white;
            border-color: #dc3545;
        }

        .subQuestion:hover {
            background-color: #f0f0f0;
            border-color: #999;
        }

        .subQuestion.active {
            background-color: #4a90e2;
            color: white;
            border-color: #4a90e2;
        }

        .subQuestion.completed {
            background-color: #28a745;
            color: white;
            border-color: #28a745;
        }

        /* Clickable cell styles for Questions 26-30 */
        .clickable-cell {
            transition: all 0.2s ease;
        }

        .clickable-cell:hover {
            background-color: #e9ecef !important;
        }

        .clickable-cell.selected {
            background-color: #4a90e2 !important;
            color: white !important;
        }

        .clickable-cell.correct {
            background-color: #28a745 !important;
            color: white !important;
        }

        .clickable-cell.incorrect {
            background-color: #dc3545 !important;
            color: white !important;
        }

        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }

        .footer__deliverButton___3FM07 {
            margin-left: auto;
            margin-right: 20px;
            background-color: #f0f0f0;
            color: #333;
            border: 1px solid #ccc;
            padding: 12px 20px;
            border-radius: 4px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: background-color 0.2s, border-color 0.2s;
            min-width: 170px;
            justify-content: center;
        }

        .footer__deliverButton___3FM07:hover {
            background-color: #e0e0e0;
            border-color: #bbb;
        }
        /* Success style for "My Results" button after checking */
        .footer__deliverButton___3FM07.success {
            background-color: #28a745;
            color: #fff;
            border-color: #28a745;
        }
        .footer__deliverButton___3FM07.success:hover {
            background-color: #218838;
            border-color: #1e7e34;
        }

        .footer__deliverButton___3FM07:disabled {
            background: #e9ecef;
            color: #6c757d;
            cursor: not-allowed;
            border-color: #ddd;
        }

        .fa-check::before {
            content: "✓";
        }

        .hidden {
            display: none;
        }

        /* Context Menu */
        .context-menu {
            position: absolute;
            background: white;
            border: 1px solid #ccc;
            border-radius: 6px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            z-index: 1000;
            display: none;
            min-width: 140px;
        }

        .context-menu-item {
            padding: 12px 16px;
            cursor: pointer;
            font-size: 16px;
            border-bottom: 1px solid #f0f0f0;
            transition: background-color 0.2s;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .context-menu-item:hover {
            background-color: #f8f9fa;
        }

        .context-menu-item:last-child {
            border-bottom: none;
        }

        .highlight {
            background-color: #ffff00;
        }

        .comment-highlight {
            background-color: #90EE90;
            position: relative;
            cursor: help;
        }

        .comment-tooltip {
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            background: #333;
            color: white;
            padding: 8px 12px;
            border-radius: 4px;
            font-size: 14px;
            white-space: nowrap;
            z-index: 1000;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s;
        }

        .comment-highlight:hover .comment-tooltip {
            opacity: 1;
        }

        .question {
            margin-bottom: 40px;
        }
        .question p {
            margin-bottom: 10px;
        }
        .question ul, .question .people-table {
            margin-top: 0;
        }
        .question-prompt {
            margin-bottom: 20px;
        }
        .question ul {
            list-style: none;
            padding-left: 0;
        }
        .question ul li {
            margin-bottom: 5px;
        }
        .answer-input {
            border: 1px solid #9aa3ad;
            border-radius: 4px;
            background-color: #fff;
            padding: 4px 8px;
            font-size: 16px;
            text-align: left; /* start typing from left */
            margin-right: 4px;
            width: 140px;
            max-width: 160px;
            min-width: 120px;
            word-break: break-word;
            overflow-wrap: break-word;
            white-space: normal;
            height: 28px;
            min-height: 28px;
            line-height: 1.2;
            vertical-align: middle;
            transition: border-color 0.15s ease, box-shadow 0.15s ease;
        }
        .answer-input::placeholder {
            color: #999;
            font-weight: bold;
            text-align: center; /* numbers centered until typing starts */
        }
        .answer-input:focus {
            outline: none;
            border-color: #2c6bed;
            border-width: 2px;
        }
        .answer-input.correct {
            border-color: #28a745;
            background-color: #e9f7ef;
        }
        .answer-input.incorrect {
            border-color: #dc3545;
            background-color: #f8d7da;
            color: #721c24;
        }
        .answer-input {
    z-index: 10;
    position: relative;
    pointer-events: auto;
    font-weight: 600;
}
        .drag-drop-container {
            display: flex;
            gap: 30px;
            margin-top: 20px;
            align-items: flex-start;
        }
        .recommendations-box {
            display: flex;
            flex-direction: column;
            gap: 8px;
            padding: 10px;
            min-height: 200px;
        }
        .drag-item {
            background: white;
    border: 1px solid #9c9c9c;
    font-weight: 600;
    padding: 0px 5px;
            border-radius: 4px;
            cursor: move;
            font-size: 16px;
            transition: all 0.2s;
            user-select: none;
        }
        .drag-item:hover {
            background: #e9ecef;
        }
        .drag-item.dragging {
            opacity: 0.5;
            transform: rotate(2deg);
        }
        .drop-zone {
            border: 2px dashed #aaa;
            border-radius: 4px;
            height: 25px;
            margin-top: 19px;
            margin-bottom: 5px;
            transition: background-color 0.2s, border-color 0.2s;
            padding: 0.5px 5px;
            display: flex;
            align-items: center;
            position: relative;
            color: #b3b3b3;
            font-weight: 600;
            min-width: 200px;
            width: auto;
        }
        .drop-zone.drag-over {
            background-color: #e6f4ff;
            border-color: #4a90e2;
        }
        /* Letter pill displayed inside drop-zones */
        .drop-letter {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            min-width: 22px;
            height: 20px;
            padding: 0 6px;
            border: 1px solid #4a90e2;
            color: #0f5bd7;
            background: #eef5ff;
            border-radius: 9999px;
            font-weight: 700;
            cursor: move;
            user-select: none;
        }
        .drop-zone.correct {
            background-color: #e9f7ef;
            border-color: #28a745;
            border-style: solid;
        }
        .drop-zone.incorrect {
            background-color: #f8d7da;
            border-color: #dc3545;
            border-style: solid;
        }
        .drop-zone .drag-item {
            cursor: default;
        }
        .drag-item.selected {
            border-color: #4a90e2;
            box-shadow: 0 0 0 1px #4a90e2;
        }
        .questions-container {
            width: 50%;
        }
        /* When transcription (results mode) is visible, give questions container 80% of left panel */
        .main-container.results-mode .questions-container {
            width: 80%;
        }
        audio {
            width: 100%;
            margin-bottom: 20px;
        }
        .part-header {
            background-color: #f1f2ec;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
            border: 1px solid #e0e0e0;
        }
        .part-header p {
            margin: 0;
        }

        .question li.correct {
            color: #155724;
            font-weight: bold;
        }
        .question li.incorrect {
            color: #721c24;
        }
        .question li.correct::before {
            content: '✔ ';
            color: #28a745;
        }
        .question li.incorrect::before {
            content: '✖ ';
            color: #dc3545;
        }

        .example-box {
            margin: 20px 0;
        }

        .timer-container {
            display: none; /* Timer hidden */
            color: #333;
            font-size: 16px;
            font-weight: 500;
        }
        .timer-container .timer-tooltip {
            display: none;
        }

        .audio-modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(40, 40, 40, 0.9);
            z-index: 2000;
            display: flex;
            justify-content: center;
            align-items: center;
            color: white;
            text-align: center;
        }
        .audio-modal-content {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
            max-width: 500px;
            padding: 20px;
        }
        .audio-modal-content p {
            font-size: 16px;
            line-height: 1.5;
            color: #eee;
        }
        .audio-modal-icon {
            margin-bottom: 20px;
        }
        .modal-play-btn {
            background-color: #000;
            color: white;
            border: 1px solid white;
            padding: 12px 24px;
            border-radius: 6px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: background-color 0.2s;
        }
        .modal-play-btn:hover {
            background-color: #333;
        }
        #goto-widget {
            display: flex;
            align-items: center;
            gap: 5px;
        }
        #goto-input {
            width: 80px;
            padding: 4px 8px;
            border: 1px solid #ccc;
            border-radius: 4px;
        }
        #goto-btn {
            padding: 4px 10px;
            border: 1px solid #ccc;
            background-color: #f0f0f0;
            border-radius: 4px;
            cursor: pointer;
        }

        @keyframes flash {
            0% { background-color: #e6f4ff; }
            100% { background-color: transparent; }
        }

        .question.flash {
            animation: flash 1s ease-out;
        }

        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.6);
            z-index: 2000;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        .modal-content {
            background: white;
            padding: 25px;
            border-radius: 8px;
            width: 100%;
            max-width: 800px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid #ddd;
            padding-bottom: 15px;
            margin-bottom: 20px;
        }
        .modal-header h2 {
            font-size: 24px;
            color: #333;
        }
        .modal-close-btn {
            background: none;
            border: none;
            font-size: 28px;
            cursor: pointer;
            color: #888;
            line-height: 1;
        }
        .modal-close-btn:hover {
            color: #333;
        }

        #part-2 .questions-container {
width: 75%;
        }
        #score-summary {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 20px;
        }
        #result-details table {
            width: 100%;
            border-collapse: collapse;
            font-size: 14px;
        }
        #result-details th, #result-details td {
            border: 1px solid #ddd;
            padding: 10px;
            text-align: left;
            vertical-align: middle;
        }
        #result-details th {
            background-color: #f8f9fa;
            font-weight: 600;
        }
        #result-details td:nth-child(1) {
            font-weight: bold;
            text-align: center;
        }
        .result-correct {
            color: #28a745;
            font-weight: bold;
        }
        .result-incorrect {
            color: #dc3545;
            font-weight: bold;
        }

        .context-menu-icon {
            width: 16px;
            height: 16px;
            display: inline-block;
            vertical-align: middle;
            margin-right: 8px;
        }

        .matching-container {
            display: flex;
            justify-content: space-between;
            gap: 40px;
            margin-top: 20px;
            align-items: flex-start;
        }
        /* Two-column drag-and-drop layout like screenshot */
        .dnd-col-title { font-weight: 700; margin-bottom: 10px; }
        .matching-question-container { display: flex; gap: 30px; align-items: flex-start; }
        .matching-options-bank { flex: 1; display: flex; flex-direction: column; gap: 10px; }
        .matching-questions { flex: 2; display: flex; flex-direction: column; gap: 24px; }
        .matching-questions .matching-question-item { display: flex; align-items: center; gap: 16px; padding: 6px 0; }
        .matching-questions .matching-question-item span { min-width: 180px; }
        .matching-questions .drop-zone { width: 100%; min-width: 360px; height: 34px; border: 2px dashed #aab3bd; border-radius: 4px; background: #fff; display: flex; align-items: center; padding: 0 8px; justify-content: flex-start; text-align: left; }
        .matching-questions .drop-zone .placeholder { color: #6b7280; font-weight: 700; }
        .matching-options-bank .drag-item { border-radius: 6px; padding: 6px 12px; background: #ffffff; border: 1px solid #d1d5db; font-weight: 600; box-shadow: 0 1px 0 rgba(0,0,0,0.02); }
        .matching-table {
            flex: 4;
            border-collapse: collapse;
        }
        .matching-table th, .matching-table td {
            padding: 6px 12px;
            text-align: left;
            vertical-align: middle;
        }
        .matching-table th {
            background-color: #f8f9fa;
            font-weight: 600;
        }
        .matching-table .drop-zone {
            /* Unify with global drop-zone styling */
            border: 2px dashed #aaa;
            border-radius: 4px;
            height: 25px;
            width: 100%;
            max-width: none;
            min-width: 200px;
            padding: 0.5px 5px;
            display: flex;
            align-items: center;
            justify-content: flex-start;
            flex-wrap: nowrap;
            background-color: transparent;
            word-break: break-word;
            overflow-wrap: break-word;
            text-align: left;
            line-height: 1.2;
            color: #b3b3b3;
            font-weight: 600;
        }
        .matching-table .drop-zone .drag-item {
            width: auto;
            max-width: none;
            text-align: left;
            padding: 6px 8px;
            font-size: 14px;
            line-height: 1.2;
            word-break: break-word;
            overflow-wrap: break-word;
            box-sizing: border-box;
            background: white;
            border: 1px solid #ddd;
            border-radius: 4px;
            margin: 2px;
        }
        .matching-options-list {
            display: flex;
            flex-direction: column;
            gap: 10px;
            flex: 1;
            background-color: transparent;
            padding: 0;
            border: none;
            min-height: 250px;
            min-width: 280px; /* ensure enough width for long option text to stay on one line */
        }
        .matching-options-list .drag-item {
            width: 100%;
        }
        .matching-question-item .drop-zone .placeholder {
            color: #999;
            font-weight: bold;
        }

        /* Clickable cell styles for matching questions */
        .clickable-cell {
            cursor: pointer;
            text-align: center;
            transition: all 0.2s ease;
            min-width: 50px;
            min-height: 50px;
            border: 2px solid #e0e0e0;
            position: relative;
            background-color: #f8f9fa;
            margin: 2px;
        }
       
        .clickable-cell:hover {
            background-color: #e6f4ff;
            border-color: #4a90e2;
        }
        .clickable-cell.selected {
            background-color: #75a8e4 !important;
            color: white !important;
        }
       
        .clickable-cell.correct {
            background-color: #28a745 !important;
            color: white !important;
        }
        .clickable-cell.correct::after {
            content: "✓";
            font-weight: bold;
        }
        .clickable-cell.incorrect {
            background-color: #dc3545 !important;
            color: white !important;
        }
        .clickable-cell.incorrect::after {
            content: "✗";
            font-weight: bold;
        }
        
        /* Clickable cell styles for questions 27-30 */
        .clickable-cell {
            cursor: pointer;
            text-align: center;
            transition: all 0.2s ease;
            min-width: 50px;
            min-height: 50px;
            border: 2px solid #e0e0e0;
            position: relative;
            background-color: #f8f9fa;
            margin: 2px;
        }
       
        .clickable-cell:hover {
            background-color: #e6f4ff;
            border-color: #4a90e2;
        }
        .clickable-cell.selected {
            background-color: #4a90e2 !important;
            color: white !important;
        }
        
        .clickable-cell.correct {
            background-color: #28a745 !important;
            color: white !important;
        }
        
        .clickable-cell.incorrect {
            background-color: #dc3545 !important;
            color: white !important;
        }
        

        
        .statement {
            font-weight: 500;
            padding-right: 20px;
        }

        .option strong,
        .question ul li label strong {
            display: none;
        }

        /* Mobile selection toolbar */
        .mobile-selection-menu {
            position: absolute;
            background: #333;
            color: #fff;
            padding: 6px 10px;
            border-radius: 6px;
            display: flex;
            gap: 8px;
            z-index: 3000;
            box-shadow: 0 2px 6px rgba(0,0,0,0.25);
        }
        .mobile-selection-menu button {
            background: transparent;
            border: 1px solid #fff;
            color: #fff;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 14px;
        }
        .mobile-selection-menu.hidden {
            display: none;
        }

        /* === Matching table styling for Questions 13-16 === */
        .matching-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        .matching-table th,
        .matching-table td {
            border: 1px solid #ddd;
            padding: 8px 4px;
            vertical-align: middle;
            text-align: center;
        }
        .matching-table .clickable-cell {
            padding: 8px 4px;
            min-width: 50px;
            min-height: 50px;
        }
        .matching-table th {
            background-color: #1e6de6;
            color: #ffffff;
            font-weight: 600;
            text-align: center;
        }
        .matching-table th:first-child {
            text-align: left;
            background-color: #f8f9fa;
            color: #333;
        }
        .matching-table tbody td:first-child {
            font-weight: 500;
            text-align: left;
            background-color: #f8f9fa;
        }
        .matching-table tr:nth-child(even) td {
            background-color: #f8faff;
        }

        /* === MCQ table styling for Questions 11-15 === */
        .mcq-table {
            width: 100%;
            border-collapse: collapse;
        }
        .mcq-table th,
        .mcq-table td {
            border: 1px solid #ddd;
            padding: 8px 12px;
            vertical-align: middle;
            text-align: center;
        }
        .mcq-table th {
            background-color: #1e6de6; /* vibrant blue header like screenshot */
            color: #ffffff;
            font-weight: 600;
            text-align: center;
        }
        .mcq-table th:first-child {
            text-align: left;
        }
        .mcq-table tbody td:first-child {
            font-weight: 500;
            text-align: left;
        }
        .mcq-table tr:nth-child(even) td {
            background-color: #f8faff; /* subtle alternating row colour */
        }
        .mcq-table input[type="radio"] {
            transform: scale(1.1);
            cursor: pointer;
        }
        /* list of options (A, B, C) shown above the table */
        .mcq-options {
            list-style: none;
            padding-left: 0;
            margin: 10px 0;
        }
        .mcq-options li {
            margin-bottom: 4px;
            font-size: 16px;
        }

        /* MCQ design: full-width selectable panels */
        .multi-choice-question { margin: 12px 0 18px; }
        .multi-choice-option { display:block; width:100%; padding: 12px 14px;  background-color: #fff; border: 1px solid transparent;  transition: background-color 0.2s ease, border-color 0.2s ease; }
        .multi-choice-option:hover { background-color: #f1f7ff; border-color: #c6dcfb; }
        .multi-choice-option:has(input[type="radio"]:checked) { background-color: #cfe3f9; }
        .multi-choice-option label { display: flex; align-items: center; gap: 10px; cursor: pointer; font-size: 16px; width:100%; }

        .aligned-form .question-row {
            display: flex;
            align-items: center;
            margin-bottom: 8px;
        }
        .aligned-form .question-label {
            width: 230px;
            padding-right: 10px;
        }

        /* Responsive adjustments for tablets */
        @media (max-width: 1024px) {
            .main-container {
                flex-direction: column;
            }
            .right-panel, .main-container.results-mode .right-panel {
                display: none;
            }
            .left-panel, .main-container.results-mode .left-panel {
                width: 100%;
                padding: 20px 10px;
                height: auto; /* Reset height for mobile */
            }
            .questions-container {
                width: 100%;
            }
        }

        .single-choice label.correct {
            color: #155724;
            font-weight: bold;
        }
        .single-choice label.correct::before {
            content: '✔ ';
            color: #28a745;
        }
        .single-choice label.incorrect {
            color: #721c24;
            text-decoration: line-through;
        }
        .single-choice label.incorrect::before {
            content: '✖ ';
            color: #dc3545;
        }
        .mcq-table tbody tr.correct {
            background-color: #d4edda !important;
            color: #155724;
            font-weight: bold;
        }
        .mcq-table tbody tr.incorrect {
            background-color: #f8d7da !important;
            text-decoration: line-through;
        }
        .mcq-table tbody tr.incorrect td {
            color: #721c24;
        }

        /* New Audio Player Styles */
        .audio-player-container {
            position: fixed;
            top: 65px;
            left: 50%;
            transform: translateX(-50%);
            width: 500px;
            max-width: 90%;
            height: 40px;
            background: #f9f9f9;
            border: 1px solid #ddd;
            border-radius: 8px;
            display: flex;
            align-items: center;
            padding: 0 15px;
            z-index: 99;
            gap: 10px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        .main-container {
            margin-top: 115px;
        }
        .player-btn {
            background: none;
            border: none;
            cursor: pointer;
            padding: 5px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .player-btn svg {
            width: 20px;
            height: 20px;
            fill: #333;
        }
        .progress-container {
            flex-grow: 1;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        #progress-bar {
            flex-grow: 1;
            -webkit-appearance: none;
            appearance: none;
            height: 4px;
            background: #ddd;
            outline: none;
            border-radius: 3px;
            cursor: pointer;
        }
        #progress-bar::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #4a90e2;
            cursor: pointer;
        }
        #progress-bar::-moz-range-thumb {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #4a90e2;
            cursor: pointer;
            border: none;
        }
        #current-time, #total-duration {
            font-size: 12px;
            color: #555;
            min-width: 35px;
            text-align: center;
        }
        .controls-container {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .volume-container {
            display: flex;
            align-items: center;
            position: relative;
        }
        #new-volume-slider {
            -webkit-appearance: none;
            appearance: none;
            width: 60px;
            height: 3px;
            background: #ccc;
            outline: none;
            border-radius: 2px;
            cursor: pointer;
            margin-left: 8px;
            display: block; 
        }
    
        #new-volume-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #333;
        }
        #new-volume-slider::-moz-range-thumb {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #333;
            border: none;
        }
        .speed-container {
            position: relative;
        }
        #speed-btn {
            font-size: 12px;
            font-weight: 600;
            color: #333;
            background-color: #e9ecef;
            border: 1px solid #ced4da;
            border-radius: 4px;
            padding: 4px 8px;
        }
        #speed-options {
            position: absolute;
            top: calc(100% + 5px); /* Position below the button with a small gap */
            right: 0;
            background: white;
            border: 1px solid #ccc;
            border-radius: 4px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            z-index: 100;
        }
        #speed-options div {
            padding: 8px 15px;
            cursor: pointer;
        }
        #speed-options div:hover {
            background-color: #f0f0f0;
        }

        /* Flowchart styles */
        .flowchart-container {
            border: 1px solid #ccc;
            padding: 0 20px;
        }
        .flowchart-step {
            text-align: center;
            margin: 0;
            padding: 20px 0;
            border-top: 1px solid #ddd;
        }
        .flowchart-step:first-child {
            border-top: none;
            padding-top: 20px;
            margin-top: 0;
        }
        .flowchart-arrow {
            text-align: center;
            margin: 0;
            padding: 15px 0;
            font-size: 20px;
            color: #555;
            border-top: 1px solid #ddd;
        }
        .flowchart-split {
            display: flex;
            justify-content: space-between;
            align-items: stretch;
            gap: 20px;
            border-top: 1px solid #ddd;
        }
        .flowchart-split-col {
            width: 48%;
            text-align: center;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }
        .flowchart-split .flowchart-step {
            border-top: none;
            padding-top: 0;
            margin-top: 0;
            flex-grow: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px 0;
        }
        .flowchart-split .flowchart-arrow {
            border-top: none;
            padding: 15px 0;
        }


        /* Responsive adjustments for tablets */
        @media (max-width: 1024px) {
            .main-container {
                flex-direction: column;
            }
            .right-panel, .main-container.results-mode .right-panel {
                display: none;
            }
            .left-panel, .main-container.results-mode .left-panel {
                width: 100%;
                padding: 20px 10px;
                height: auto; /* Reset height for mobile */
            }
            .questions-container {
                width: 100%;
            }
            
            /* Adjust input boxes for tablets */
            .answer-input {
                width: 90px;
                max-width: 110px;
                font-size: 15px;
            }
            
            .drop-zone {
                max-width: 110px;
                min-width: 90px;
            }
            
            .matching-table .drop-zone {
                max-width: 110px;
                min-width: 90px;
            }
        }
        
        /* Responsive adjustments for mobile phones */
        @media (max-width: 768px) {
            .answer-input {
                width: 80px;
                max-width: 100px;
                font-size: 14px;
                padding: 2px 4px;
            }
            
            .drop-zone {
                max-width: 100px;
                min-width: 80px;
                font-size: 14px;
            }
            
            .matching-table .drop-zone {
                max-width: 100px;
                min-width: 80px;
            }
            
            .drag-item {
                font-size: 13px;
                padding: 4px 6px;
            }
            
            .matching-table .drop-zone .drag-item {
                font-size: 12px;
            }
            
            /* Ensure drag-drop containers are more mobile-friendly */
            .drag-drop-container {
                flex-direction: column;
                gap: 15px;
            }
            
            .matching-container {
                flex-direction: column;
                gap: 20px;
            }
        }
        
        /* Extra small screens */
        @media (max-width: 480px) {
            .answer-input {
                width: 70px;
                max-width: 90px;
                font-size: 13px;
            }
            
            .drop-zone {
                max-width: 90px;
                min-width: 70px;
            }
            
            .matching-table .drop-zone {
                max-width: 90px;
                min-width: 70px;
            }
        }

        /* ===== Imported designs from Reading 4.html ===== */
        /* TRUE/FALSE/NOT GIVEN styles */
        .tf-question { margin-bottom: 25px; padding: 10px 0; border-radius: 4px; }
        .tf-question-line { display: flex; align-items: flex-start; margin-bottom: 15px; padding: 5px 0; border-radius: 4px; }
        .tf-question-number, .question-number-box { border: 2px solid #ccc; padding: 2px 8px; margin-right: 10px; border-radius: 3px; font-weight: bold; display: inline-block; }
        .tf-question.active-question .tf-question-number { border-color: #4a90e2; }
        .tf-question-text { padding-top: 3px; }
        .tf-options { padding-left: 5px; }
        .tf-option { display: flex; align-items: center; padding: 10px 12px; background-color: #fff; transition: background-color 0.2s ease, border-color 0.2s ease, box-shadow 0.2s ease; }
        .tf-option:hover { background-color: #f1f7ff; border-color: #c6dcfb; }
        .tf-option.correct { background-color: #d4edda !important; border-color: #28a745 !important; }
        .tf-option.incorrect { background-color: #f8d7da !important; border-color: #dc3545 !important; }
        .tf-option input[type="radio"] { margin-right: 10px; transform: scale(1.2); }
        .tf-question.correct .tf-question-line { background-color: #e9f7ef; }
        .tf-question.incorrect .tf-question-line { background-color: #f8d7da; }

        /* Multi-choice question styles */
        .multi-choice-question { margin-bottom: 20px; padding: 10px; border-radius: 4px; border: 3px solid transparent; }
        .multi-choice-question .question-prompt p > strong:first-child { display: inline-flex; align-items: center; justify-content: center; min-width: 24px; padding: 2px 6px; margin-right: 8px; border: 1px solid #d0d7e2; border-radius: 6px; background: #fff; }
        .multi-choice-question.active-question .question-prompt p > strong:first-child { border-color: #4a90e2; border-width: 2px; }
        .multi-choice-option { padding: 10px 12px; background-color: #fff; transition: background-color 0.2s ease, border-color 0.2s ease, box-shadow 0.2s ease; }
        .multi-choice-option:hover { background-color: #f1f7ff; border-color: #c6dcfb; }
        .multi-choice-option.correct { background-color: #d4edda !important;  }
        .multi-choice-option.incorrect { background-color: #f8d7da !important;  }
        .multi-choice-option label { display: flex; align-items: center; cursor: pointer; font-size: 16px; }
        .multi-choice-option input[type="checkbox"], .multi-choice-option input[type="radio"] { margin-right: 12px; transform: scale(1.3); accent-color: #4a90e2; }

        /* Checkbox TWO-answers block (match screenshot) */
        .checkbox-question .question-prompt p > strong:first-child {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            min-width: 24px;
           
            background: #fff;
        }
        .checkbox-group { display: flex; flex-direction: column;  }
        .checkbox-group label { display: flex; align-items: center; padding: 10px 12px; border: 1px solid transparent; background: #fff; transition: background-color 0.2s, border-color 0.2s; }
        .checkbox-group label:hover { background: #f1f7ff; border-color: #c6dcfb; }
        .checkbox-group label:has(input[type="checkbox"]:checked) { background: #cfe3f9; }
        .checkbox-group input[type="checkbox"] { margin-right: 10px; transform: scale(1.2); }
        .checkbox-group label.correct { background-color: #d4edda !important; }
        .checkbox-group label.incorrect { background-color: #f8d7da !important;  }
        .checkbox-group label.correct::before { content: '✔ '; color: #28a745; font-weight: 600; margin-right: 6px; }
        .checkbox-group label.incorrect::before { content: '✖ '; color: #dc3545; font-weight: 600; margin-right: 6px; }

        /* Drag & Drop enhancements */
        /* When filled, hide zone border and show a blue outlined pill around the dropped option */
        .drop-zone.filled { 
            background: transparent; 
            border: none !important; 
            padding: 0; 
            justify-content: flex-start; 
            width: auto;
            min-width: fit-content;
        }
        .drop-zone.filled .drag-item { 
            width: auto; 
            height: auto; 
            display: inline-block; 
            white-space: nowrap; 
            border: 1px solid #2c6bed; 
            border-radius: 4px; 
            padding: 2px 6px; 
            font-weight: 600; 
            background: #fff; 
            color: #222; 
        }

        /* ===== Results Modal UI ===== */
        .modal-overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.55); display: flex; align-items: center; justify-content: center; z-index: 3000; padding: 20px; }
        .modal-content { background: #ffffff; width: 100%; max-width: 900px; max-height: 85vh; border-radius: 10px; box-shadow: 0 10px 30px rgba(0,0,0,0.25); overflow: hidden; display: flex; flex-direction: column; }
        .modal-header { display: flex; align-items: center; justify-content: space-between; padding: 14px 18px; border-bottom: 1px solid #e5e7eb; background: #f8fafc; position: sticky; top: 0; z-index: 1; }
        .modal-header h2 { margin: 0; font-size: 20px; font-weight: 700; color: #111827; }
        .modal-close-btn { background: transparent; border: none; font-size: 26px; line-height: 1; cursor: pointer; color: #6b7280; }
        .modal-close-btn:hover { color: #111827; }
        .modal-body { padding: 16px 18px; overflow: auto; }
        #score-summary { font-size: 16px; font-weight: 600; color: #111827; background: #f1f5f9; border: 1px solid #e2e8f0; padding: 10px 12px; border-radius: 8px; display: inline-block; }
        .result-controls { display: flex; align-items: center; gap: 12px; margin: 12px 0; }
        .result-controls .spacer { flex: 1; }
        .result-controls label { display: inline-flex; align-items: center; gap: 6px; color: #374151; }
        .btn-secondary { padding: 6px 10px; border: 1px solid #cbd5e1; border-radius: 6px; background: #ffffff; color: #111827; cursor: pointer; }
        .btn-secondary:hover { background: #f8fafc; }
        #result-details { overflow: auto; }
        #result-details table { width: 100%; border-collapse: collapse; border: 1px solid #e5e7eb; }
        #result-details th, #result-details td { padding: 10px 12px; border-bottom: 1px solid #e5e7eb; text-align: left; font-size: 14px; }
        #result-details thead th { position: sticky; top: 0; background: #f1f5f9; z-index: 1; }
        #result-details tr:nth-child(even) td { background: #fafafa; }
        #result-details td.result-correct { color: #0f5132; font-weight: 600; }
        #result-details td.result-incorrect { color: #842029; font-weight: 600; }
    </style>
</head>
<body>
    <div class="header">
        <div class="timer-container">
            <span class="timer-display">60:00</span>
        </div>
        <h2 style="color: purple;">JUNED ACADEMY</h2>
        <div class="header-icons">
        
        </div>
    </div>

    <div class="audio-player-container">
        <button id="play-pause-btn" class="player-btn">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8 5v14l11-7z"/></svg>
        </button>
        <div class="progress-container">
            <span id="current-time">0:00</span>
            <input type="range" id="progress-bar" value="0" step="1" style="width: 100%;">
            <span id="total-duration">0:00</span>
        </div>
        <div class="controls-container">
            <div class="volume-container">
                <button id="volume-btn" class="player-btn">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"></polygon><path d="M19.07 4.93a10 10 0 0 1 0 14.14M15.54 8.46a5 5 0 0 1 0 7.07"></path></svg>
                </button>
                <input type="range" id="new-volume-slider" min="0" max="1" step="0.01" value="1">
            </div>
            <div class="speed-container">
                <button id="speed-btn" class="player-btn">1x</button>
                <div id="speed-options" class="hidden">
                    <div data-speed="0.5">0.5x</div>
                    <div data-speed="0.75">0.75x</div>
                    <div data-speed="1">1x</div>
                    <div data-speed="1.25">1.25x</div>
                    <div data-speed="1.5">1.5x</div>
                    <div data-speed="2">2x</div>
                </div>
            </div>
        </div>
    </div>

    <div class="main-container">
        <!-- Left Panel -->
        <div class="left-panel">
            
            <div id="part-1" class="question-part">
                <div class="part-header">
                    <p><strong>Part 1</strong></p>
                    <p>Listen and answer questions 1–10.</p>
                </div>
                <div class="questions-container">
                    <div class="question">
                        <div class="question-prompt">
                            <p><strong>Questions 1-10</strong></p>
                            <p>Complete the notes below.</p>
                            <p>Write <strong>ONE WORD AND/OR A NUMBER</strong> for each answer.</p>
                        </div>
                        
                        <div style="margin-top: 20px;">
                            <p class="centered-title"><strong>Riverdale Pre-school</strong></p>
                            
                            <div class="example-box" style="background-color: #f8f9fa; padding: 15px; border: 1px solid #ddd; border-radius: 4px; margin-bottom: 20px;">
                                <p><strong>Example</strong></p>
                                <p>Children: 20 in a class</p>
                            </div>

                            <div style="margin-bottom: 20px;">
                                <p><strong>Classes:</strong></p>
                                <ul style="list-style-type: none; padding-left: 0;">
                                    <li style="margin-bottom: 10px;">First group - Mrs. Oliver</li>
                                    <li style="margin-bottom: 10px;">Second group - Mrs. <input type="text" id="q1" class="answer-input" placeholder="1" autocomplete="off"></li>
                                </ul>
                            </div>

                            <div style="margin-bottom: 20px;">
                                <p><strong>Hours & Days:</strong></p>
                                <ul style="list-style-type: none; padding-left: 0;">
                                    <li style="margin-bottom: 10px;">Suzie will attend 3 days a week for a total of <input type="text" id="q2" class="answer-input" placeholder="2" autocomplete="off"> hours</li>
                                </ul>
                            </div>

                            <div style="margin-bottom: 20px;">
                                <p><strong>Activities:</strong></p>
                                <p><em>Outside time</em></p>
                                <ul style="list-style-type: disc; padding-left: 20px; margin-bottom: 10px;">
                                    <li style="margin-bottom: 5px;">running, playing, or something quieter</li>
                                    <li style="margin-bottom: 5px;">just got a new piece of equipment</li>
                                    <li style="margin-bottom: 10px;">intend to make a <input type="text" id="q3" class="answer-input" placeholder="3" autocomplete="off"></li>
                                </ul>
                                <p><em>Indoors</em></p>
                                <ul style="list-style-type: disc; padding-left: 20px; margin-bottom: 10px;">
                                    <li style="margin-bottom: 5px;">this year, <input type="text" id="q4" class="answer-input" placeholder="4" autocomplete="off"> activities are popular</li>
                                    <li style="margin-bottom: 10px;">they hear a <input type="text" id="q5" class="answer-input" placeholder="5" autocomplete="off"> every day</li>
                                </ul>
                            </div>

                            <div style="margin-bottom: 20px;">
                                <p><strong>Fees:</strong></p>
                                <ul style="list-style-type: none; padding-left: 0;">
                                    <li style="margin-bottom: 10px;">Now costs $<input type="text" id="q6" class="answer-input" placeholder="6" autocomplete="off"> per term</li>
                                </ul>
                                <p><em>Fees include:</em></p>
                                <ul style="list-style-type: disc; padding-left: 20px; margin-bottom: 10px;">
                                    <li style="margin-bottom: 5px;">a trip to a <input type="text" id="q7" class="answer-input" placeholder="7" autocomplete="off"> this year</li>
                                    <li style="margin-bottom: 10px;">chance to take home a <input type="text" id="q8" class="answer-input" placeholder="8" autocomplete="off"> every week</li>
                                </ul>
                            </div>

                            <div style="margin-bottom: 20px;">
                                <p><strong>Do not forget:</strong></p>
                                <ul style="list-style-type: disc; padding-left: 20px;">
                                    <li style="margin-bottom: 10px;">Put a <input type="text" id="q9" class="answer-input" placeholder="9" autocomplete="off">, in Suzie's bag</li>
                                    <li style="margin-bottom: 10px;">Arrange a visit; phone number: <input type="text" id="q10" class="answer-input" placeholder="10" autocomplete="off"></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div id="part-2" class="question-part hidden">
                <div class="part-header">
                    <p><strong>Part 2</strong></p>
                    <p>Listen and answer questions 11–20.</p>
                </div>
                <div class="questions-container">
                    <div class="question">
                        <div class="question-prompt">
                            <p><strong>Questions 11-15</strong></p>
                            <p>Complete the sentences below.</p>
                            <p>Write <strong>NO MORE THAN TWO WORDS AND/OR A NUMBER</strong> for each answer.</p>
                        </div>
                        
                        <div style="margin-top: 20px;">
                            <ul style="list-style-type: none; padding-left: 0;">
                                <li style="margin-bottom: 15px;">
                                    <strong>11</strong>&nbsp;&nbsp;Special conditions may apply to <input type="text" id="q11" class="answer-input" placeholder="11" autocomplete="off"> students looking for a job.
                                </li>
                                <li style="margin-bottom: 15px;">
                                    <strong>12</strong>&nbsp;&nbsp;The university Job Centre is located on the <input type="text" id="q12" class="answer-input" placeholder="12" autocomplete="off"> Campus.
                                </li>
                                <li style="margin-bottom: 15px;">
                                    <strong>13</strong>&nbsp;&nbsp;The Job Centre remains open until <input type="text" id="q13" class="answer-input" placeholder="13" autocomplete="off"> every evening.
                                </li>
                                <li style="margin-bottom: 15px;">
                                    <strong>14</strong>&nbsp;&nbsp;The only day the employment lawyer is available is <input type="text" id="q14" class="answer-input" placeholder="14" autocomplete="off"> .
                                </li>
                                <li style="margin-bottom: 15px;">
                                    <strong>15</strong>&nbsp;&nbsp;The university <input type="text" id="q15" class="answer-input" placeholder="15" autocomplete="off"> regularly advertises new jobs.
                                </li>
                            </ul>
                        </div>
                    </div>

                    <div class="question">
                        <div class="question-prompt" style="margin-top: 40px;">
                            <p><strong>Questions 16-20</strong></p>
                            <p>Choose the correct answer.</p>
                        </div>
                        
                        <div style="margin-top: 20px;">
                            <div class="mcq-item" style="margin-bottom: 20px;">
                                <p><strong>16</strong>&nbsp;&nbsp;At present, the university is offering part-time work in</p>
                                <div class="options" style="margin-left: 20px;">
                                    <div class="multi-choice-option"><label><input type="radio" name="q16" value="A"> its offices.</label></div>
                                    <div class="multi-choice-option"><label><input type="radio" name="q16" value="B"> the IT centre.</label></div>
                                    <div class="multi-choice-option"><label><input type="radio" name="q16" value="C"> the car parks.</label></div>
                                </div>
                            </div>

                            <div class="mcq-item" style="margin-bottom: 20px;">
                                <p><strong>17</strong>&nbsp;&nbsp;Local employers visit the university</p>
                                <div class="options" style="margin-left: 20px;">
                                    <div class="multi-choice-option"><label><input type="radio" name="q17" value="A"> only in the first term.</label></div>
                                    <div class="multi-choice-option"><label><input type="radio" name="q17" value="B"> twice a term.</label></div>
                                    <div class="multi-choice-option"><label><input type="radio" name="q17" value="C"> throughout the year.</label></div>
                                </div>
                            </div>

                            <div class="mcq-item" style="margin-bottom: 20px;">
                                <p><strong>18</strong>&nbsp;&nbsp;According to the speaker, a part-time job can</p>
                                <div class="options" style="margin-left: 20px;">
                                    <div class="multi-choice-option"><label><input type="radio" name="q18" value="A"> lead to a full-time job after graduation.</label></div>
                                    <div class="multi-choice-option"><label><input type="radio" name="q18" value="B"> provide a useful work record for the future.</label></div>
                                    <div class="multi-choice-option"><label><input type="radio" name="q18" value="C"> give the chance to develop team-work skills.</label></div>
                                </div>
                            </div>

                            <div class="mcq-item" style="margin-bottom: 20px;">
                                <p><strong>19</strong>&nbsp;&nbsp;Students who work part-time</p>
                                <div class="options" style="margin-left: 20px;">
                                    <div class="multi-choice-option"><label><input type="radio" name="q19" value="A"> will be taxed.</label></div>
                                    <div class="multi-choice-option"><label><input type="radio" name="q19" value="B"> will be paid every week.</label></div>
                                    <div class="multi-choice-option"><label><input type="radio" name="q19" value="C"> will need private insurance.</label></div>
                                </div>
                            </div>

                            <div class="mcq-item" style="margin-bottom: 20px;">
                                <p><strong>20</strong>&nbsp;&nbsp;Part-time student workers are advised to</p>
                                <div class="options" style="margin-left: 20px;">
                                    <div class="multi-choice-option"><label><input type="radio" name="q20" value="A"> give notice in writing.</label></div>
                                    <div class="multi-choice-option"><label><input type="radio" name="q20" value="B"> communicate by email.</label></div>
                                    <div class="multi-choice-option"><label><input type="radio" name="q20" value="C"> have a mobile phone.</label></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div id="part-3" class="question-part hidden">
                <div class="part-header">
                    <p><strong>Part 3</strong></p>
                    <p>Listen and answer questions 21–30.</p>
                </div>
                <div class="questions-container">
                    <div class="question">
                        <div class="question-prompt">
                            <p><strong>Questions 21-26</strong></p>
                            <p>Choose the correct answer.</p>
                        </div>
                        
                        <div style="margin-top: 20px;">
                            <p class="centered-title"><strong>Research Project</strong></p>
                            
                            <div class="mcq-item" style="margin-bottom: 20px;">
                                <p><strong>21</strong>&nbsp;&nbsp;How did John choose the topic of his research project?</p>
                                <div class="options" style="margin-left: 20px;">
                                    <div class="multi-choice-option"><label><input type="radio" name="q21" value="A"> He thought the information would be useful for town planning.</label></div>
                                    <div class="multi-choice-option"><label><input type="radio" name="q21" value="B"> He has a special interest in the use of public services.</label></div>
                                    <div class="multi-choice-option"><label><input type="radio" name="q21" value="C"> He read about a similar study which had been done earlier.</label></div>
                                </div>
                            </div>

                            <div class="mcq-item" style="margin-bottom: 20px;">
                                <p><strong>22</strong>&nbsp;&nbsp;During his research, John is expecting to find that</p>
                                <div class="options" style="margin-left: 20px;">
                                    <div class="multi-choice-option"><label><input type="radio" name="q22" value="A"> The use of public services has altered very little.</label></div>
                                    <div class="multi-choice-option"><label><input type="radio" name="q22" value="B"> A group of people has changed its habits.</label></div>
                                    <div class="multi-choice-option"><label><input type="radio" name="q22" value="C"> The most frequently used facility is the library.</label></div>
                                </div>
                            </div>

                            <div class="mcq-item" style="margin-bottom: 20px;">
                                <p><strong>23</strong>&nbsp;&nbsp;What is the problem with using official records?</p>
                                <div class="options" style="margin-left: 20px;">
                                    <div class="multi-choice-option"><label><input type="radio" name="q23" value="A"> They may be lacking in detail.</label></div>
                                    <div class="multi-choice-option"><label><input type="radio" name="q23" value="B"> They may not be readily available.</label></div>
                                    <div class="multi-choice-option"><label><input type="radio" name="q23" value="C"> They may be difficult to analyse.</label></div>
                                </div>
                            </div>

                            <div class="mcq-item" style="margin-bottom: 20px;">
                                <p><strong>24</strong>&nbsp;&nbsp;What does the tutor think about John using a questionnaire to get information?</p>
                                <div class="options" style="margin-left: 20px;">
                                    <div class="multi-choice-option"><label><input type="radio" name="q24" value="A"> He needs to do a course in questionnaire design first.</label></div>
                                    <div class="multi-choice-option"><label><input type="radio" name="q24" value="B"> He should use this method instead of looking at public records.</label></div>
                                    <div class="multi-choice-option"><label><input type="radio" name="q24" value="C"> He will find the practice he gets useful the following year.</label></div>
                                </div>
                            </div>

                            <div class="mcq-item" style="margin-bottom: 20px;">
                                <p><strong>25</strong>&nbsp;&nbsp;Which new variable does John agree to add to his investigation?</p>
                                <div class="options" style="margin-left: 20px;">
                                    <div class="multi-choice-option"><label><input type="radio" name="q25" value="A"> Occupation</label></div>
                                    <div class="multi-choice-option"><label><input type="radio" name="q25" value="B"> Income group</label></div>
                                    <div class="multi-choice-option"><label><input type="radio" name="q25" value="C"> Qualifications</label></div>
                                </div>
                            </div>

                            <div class="mcq-item" style="margin-bottom: 20px;">
                                <p><strong>26</strong>&nbsp;&nbsp;How many questionnaires will John distribute?</p>
                                <div class="options" style="margin-left: 20px;">
                                    <div class="multi-choice-option"><label><input type="radio" name="q26" value="A"> The same number as in the previous study</label></div>
                                    <div class="multi-choice-option"><label><input type="radio" name="q26" value="B"> A greater number than he needs for analysis</label></div>
                                    <div class="multi-choice-option"><label><input type="radio" name="q26" value="C"> The number recommended in the project guidelines</label></div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="question">
                        <div class="question-prompt" style="margin-top: 40px;">
                            <p><strong>Questions 27-30</strong></p>
                            <p>Choose <strong>TWO</strong> answers.</p>
                            <p><strong>27-28</strong>&nbsp;&nbsp;Which <strong>TWO</strong> strategies will John use to encourage people to fill out his questionnaire?</p>
                        </div>
                        
                        <div class="checkbox-group" style="margin-top: 15px; display: flex; flex-direction: column; gap: 10px;">
                            <label><input type="checkbox" name="q27-28" value="A"> Using simple language</label>
                            <label><input type="checkbox" name="q27-28" value="B"> Delivering the questionnaires in person</label>
                            <label><input type="checkbox" name="q27-28" value="C"> Making the questionnaires anonymous</label>
                            <label><input type="checkbox" name="q27-28" value="D"> Providing return envelopes</label>
                            <label><input type="checkbox" name="q27-28" value="E"> Trialing the questionnaire on friends</label>
                        </div>
                    </div>

                    <div class="question">
                        <div class="question-prompt" style="margin-top: 40px;">
                            <p><strong>29-30</strong>&nbsp;&nbsp;Which <strong>TWO</strong> pieces of advice does the tutor give John about his questionnaire?</p>
                        </div>
                        
                        <div class="checkbox-group" style="margin-top: 15px; display: flex; flex-direction: column; gap: 10px;">
                            <label><input type="checkbox" name="q29-30" value="A"> There should be a mixture of question types.</label>
                            <label><input type="checkbox" name="q29-30" value="B"> Some questions should elicit personal information.</label>
                            <label><input type="checkbox" name="q29-30" value="C"> There should be an introduction to explain the survey's purpose.</label>
                            <label><input type="checkbox" name="q29-30" value="D"> A telephone number should be provided for queries.</label>
                            <label><input type="checkbox" name="q29-30" value="E"> The questions should only take a few minutes to answer.</label>
                        </div>
                    </div>
                </div>
            </div>

            <div id="part-4" class="question-part hidden">
                <div class="part-header">
                    <p><strong>Part 4</strong></p>
                    <p>Listen and answer questions 31–40.</p>
                </div>
                <div class="questions-container">
                    <div class="question">
                        <div class="question-prompt">
                            <p><strong>Questions 31-33</strong></p>
                            <p>Complete the sentences below.</p>
                            <p>Write <strong>NO MORE THAN TWO WORDS</strong> for each answer.</p>
                        </div>
                        
                        <div style="margin-top: 20px;">
                            <p class="centered-title"><strong>Driverless vehicle competition</strong></p>
                            
                            <ul style="list-style-type: none; padding-left: 0;">
                                <li style="margin-bottom: 15px;">
                                    <strong>31</strong>&nbsp;&nbsp;Undergraduates from both the engineering school and the <input type="text" id="q31" class="answer-input" placeholder="31" autocomplete="off"> department can definitely take part in the project.
                                </li>
                                <li style="margin-bottom: 15px;">
                                    <strong>32</strong>&nbsp;&nbsp;The automated vehicles will have to avoid obstacles such as <input type="text" id="q32" class="answer-input" placeholder="32" autocomplete="off"> .
                                </li>
                                <li style="margin-bottom: 15px;">
                                    <strong>33</strong>&nbsp;&nbsp;The tutor mentions one vehicle which used technology such as <input type="text" id="q33" class="answer-input" placeholder="33" autocomplete="off"> , lasers, and laptops to measure its surroundings.
                                </li>
                            </ul>
                        </div>
                    </div>

                    <div class="question">
                        <div class="question-prompt" style="margin-top: 40px;">
                            <p><strong>Questions 34-36</strong></p>
                            <p>Choose the correct answer.</p>
                        </div>

                        <div style="margin-top: 20px;">
                            <div class="mcq-item" style="margin-bottom: 20px;">
                                <p><strong>34</strong>&nbsp;&nbsp;The purpose of holding the race is to</p>
                                <div class="options" style="margin-left: 20px;">
                                    <div class="multi-choice-option"><label><input type="radio" name="q34" value="A"> Interest students in careers in industry.</label></div>
                                    <div class="multi-choice-option"><label><input type="radio" name="q34" value="B"> Help provide finance for universities.</label></div>
                                    <div class="multi-choice-option"><label><input type="radio" name="q34" value="C"> Find useful new design features.</label></div>
                                </div>
                            </div>
                            
                            <div class="mcq-item" style="margin-bottom: 20px;">
                                <p><strong>35</strong>&nbsp;&nbsp;The tutor says success will depend on</p>
                                <div class="options" style="margin-left: 20px;">
                                    <div class="multi-choice-option"><label><input type="radio" name="q35" value="A"> The software design.</label></div>
                                    <div class="multi-choice-option"><label><input type="radio" name="q35" value="B"> Good, solid construction.</label></div>
                                    <div class="multi-choice-option"><label><input type="radio" name="q35" value="C"> Sophisticated mechanisms.</label></div>
                                </div>
                            </div>

                            <div class="mcq-item" style="margin-bottom: 20px;">
                                <p><strong>36</strong>&nbsp;&nbsp;This year's competitors were surprised that the vehicles</p>
                                <div class="options" style="margin-left: 20px;">
                                    <div class="multi-choice-option"><label><input type="radio" name="q36" value="A"> Were so easy to design.</label></div>
                                    <div class="multi-choice-option"><label><input type="radio" name="q36" value="B"> Were as successful as they were.</label></div>
                                    <div class="multi-choice-option"><label><input type="radio" name="q36" value="C"> Took such a short time to construct.</label></div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="question">
                        <div class="question-prompt" style="margin-top: 40px;">
                            <p><strong>Questions 37-40</strong></p>
                            <p>Complete the table below.</p>
                            <p>Write <strong>ONE WORDS ONLY</strong> for each answer.</p>
                        </div>
                        
                        <div style="margin-top: 20px;">
                            <p class="centered-title"><strong>Schedule</strong></p>
                            
                            <table style="width: 100%; border-collapse: collapse; border: 1px solid #ddd;">
                                <tbody>
                                    <tr>
                                        <td style="border: 1px solid #ddd; padding: 10px; font-weight: bold; width: 30%;">Early May</td>
                                        <td style="border: 1px solid #ddd; padding: 10px;">Introductory <input type="text" id="q37" class="answer-input" placeholder="37" autocomplete="off"> about the project</td>
                                    </tr>
                                    <tr>
                                        <td style="border: 1px solid #ddd; padding: 10px; font-weight: bold;">Late May</td>
                                        <td style="border: 1px solid #ddd; padding: 10px;">Essay giving information about relevant experience</td>
                                    </tr>
                                    <tr>
                                        <td style="border: 1px solid #ddd; padding: 10px; font-weight: bold;">June</td>
                                        <td style="border: 1px solid #ddd; padding: 10px;">Visit to a factory</td>
                                    </tr>
                                    <tr>
                                        <td style="border: 1px solid #ddd; padding: 10px; font-weight: bold;"><input type="text" id="q38" class="answer-input" placeholder="38" autocomplete="off"></td>
                                        <td style="border: 1px solid #ddd; padding: 10px;">Workshop</td>
                                    </tr>
                                    <tr>
                                        <td style="border: 1px solid #ddd; padding: 10px; font-weight: bold;">September</td>
                                        <td style="border: 1px solid #ddd; padding: 10px;">
                                            <ul style="list-style-type: disc; padding-left: 20px; margin: 0;">
                                                <li style="margin-bottom: 5px;">discuss <input type="text" id="q39" class="answer-input" placeholder="39" autocomplete="off"></li>
                                                <li>learn to use design package</li>
                                            </ul>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td style="border: 1px solid #ddd; padding: 10px; font-weight: bold;">December</td>
                                        <td style="border: 1px solid #ddd; padding: 10px;">Submission of initial designs</td>
                                    </tr>
                                    <tr>
                                        <td style="border: 1px solid #ddd; padding: 10px; font-weight: bold;">January</td>
                                        <td style="border: 1px solid #ddd; padding: 10px;">Selection of the <input type="text" id="q40" class="answer-input" placeholder="40" autocomplete="off"></td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

        <!-- Right Panel -->
    </div>
    <div class="right-panel">
        <div id="transcription-container">
            <h2>Transcription</h2>
            <div id="transcription-text"></div>
        </div>
    </div>

    <div id="transcription-data" style="display:none;">
        <div data-part="1"><strong>SECTION 1</strong>
<br><br>
Teacher: Hello, Riverdale Pre-school.
<br><br>
Parent: Oh hello, I'd like to enquire about your school for my daughter Suzie.
<br><br>
Teacher: Certainly. We have 20 children in a class.
<br><br>
Parent: And who are the teachers?
<br><br>
Teacher: The first group is with Mrs. Oliver. And the second group is with Mrs. <strong>Keogh</strong> (Q1). That's K-E-O-G-H.
<br><br>
Parent: Right.
<br><br>
Teacher: Classes are 3 days a week. Suzie will attend for a total of <strong>15</strong> (Q2) hours.
<br><br>
Parent: What about activities?
<br><br>
Teacher: Well, outside, they do running and playing. We just got some new equipment. And we intend to make a <strong>garden</strong> (Q3) soon.
<br><br>
Parent: Oh lovely.
<br><br>
Teacher: And indoors, this year <strong>music</strong> (Q4) activities are very popular.
<br><br>
Parent: And do they have stories?
<br><br>
Teacher: Yes, they hear a <strong>story</strong> (Q5) every day.
<br><br>
Parent: How much are the fees?
<br><br>
Teacher: It now costs $<strong>470</strong> (Q6) per term.
<br><br>
Parent: Does that include trips?
<br><br>
Teacher: Yes, fees include a trip to a <strong>farm</strong> (Q7) this year.
<br><br>
Parent: And can they borrow books?
<br><br>
Teacher: Well, they have the chance to take home a <strong>toy</strong> (Q8) every week.
<br><br>
Parent: What should I put in her bag?
<br><br>
Teacher: Please put a <strong>pillow</strong> (Q9) in Suzie's bag for rest time.
<br><br>
Parent: Great. Can I arrange a visit?
<br><br>
Teacher: Yes, you can arrange a visit. My phone number is <strong>0914638520</strong> (Q10).
<br><br>
Parent: Thank you!
        </div>
        <div data-part="2"><strong>SECTION 2</strong>

Hello everyone, and welcome to the University of New South Wales.
The first thing I'd like to do at today's Orientation Session is get you all oriented! That means tell you the location of some useful facilities and services. So, first of all, take out the maps we gave you all as you came in the door. The map is the big yellow sheet of paper.
As you can see on the map, North is at the top, South at the bottom, et cetera. Which way is North? Well, look through that window on my left, your right. See the rising sun? That would have to be East. So North must be directly behind me.
Now, we are at the campus's Main Gate. The Recreational Facilities are on my right hand and its opposite is the Student Centre (Q11). No questions? Good. Pretty easy, right?
OK, did everyone eat breakfast at the Student Food Service this morning? Was the food good? Yes, yes. I am joking. I've eaten there, too.
So after a meal like that, you must be eager to go to a doctor. Right?
Well, I have good news for you: the Student Health Centre is located about half a kilometre straight north of here (Q12). Look on your maps. You see the street on the east side of this building? Ned Kelly Avenue?
Just follow that about 500 metres, and the Health Centre will be on your left at the third cross street. (Q12)
Now, I know you all just got here. So you must be wondering how to tell your folks you've arrived safely, how much you miss the dog, and how you already need more money. If you don't have an Iphone, you probably are wondering where to find a computer. Well, I have good news. If you go straight out of its door and walk down the Garden Street, you'll see the Internet Unit on your left side, just next to the Gym (Q13). The hours are posted on the door, and the computers are free, but you must bring your student ID card with you. Like I tell everyone, if you need help with anything, you can probably find it right here in the Student Centre.
Do you see the four buildings there between the Student Centre and the library? Those are the dormitories. The men's dorms are the two on the south; the women's the two on the north.
OK, I'm sorry to have to tell you, but the university has been doing a lot of repairs and remodelling, and it's not all done yet. So there may be some small problems with your dorm rooms. Maybe the window doesn't open. Maybe an air conditioner is missing or does not work. If there are any problems, you can go to the Complaint Office, which is right beside the Teaching Building between the Parker Street and the Crammer Street (Q14). Just tell them your problem and they should have it fixed by the time you graduate in four years. I'm joking, but please be patient. There are a lot of little things they need to take care of.
Tired of the school food? No? Give it a week. Or maybe you just need a place to get coffee in the wee hours of the night during one of those marathon study sessions. Either way, you definitely have to check out the little Cafe just past the women's dormitories (Q15). They've got free Wi-Fi, so a lot of students saddle up with coffee and a bagel for hours on end to get work done.
As for the dorm rooms, I have some bad news and some good news.
The bad news is the rooms are small and you'll probably be sharing space with at least three other students. The good news is that each room has its own bathroom (Q16). What's good about sharing a bathroom with three strangers? Hmmm… good question. OK, call it bad news and worse news.
Hey, maybe try this for good news: each dorm has a kitchen. If you want to make snacks or meals, you can do it there. You can buy food containers (Q17) at any campus convenience store, so you can store your food in the kitchen. But a word of warning: you should definitely write your name on your food containers. Sad to say, there are food thieves among your fellow students. Speaking of thieves, a word about security. I mean this is Australia and we do get drunken bushrangers wandering onto campus. Each of you will be given a key for your dorm room. Don't lose it. You have to pay for any replacement and fill out a bunch of papers, too. Red tape, huh? Your key does not work for the front door of your dorm, however. To the right of each door, there is a keypad with numbers. When you move in, they will tell you the code (Q18) you use to enter the door. Please do not tell the code to people who do not live in the dorm.
Let's see. Have I forgotten anything? Oh, yes. Most of you are not rich, correct? So when your clothes get dirty, you can't just throw them away and buy new ones. That means you have to learn to do laundry. Or, men, that means you have to hurry up and get married.
If you decide to wash those clothes and not get married, there are laundries in each dorm. Where? Oh, I almost forgot to tell you. The laundry for each dorm is in the basement (Q19). Some real good news this time: if you are a student, it is free. You do have to buy your own soap, however. The laundry closes, by the by, at 11:30.
And, now that I've mentioned 11:30, please remember the dorm doors are locked at Q20 11:30 p.m. Your code will not work. If you want to get in, you'll have to call the night watchman. Don't worry, you can get that number at the Dorm Office. Yes, the Dorm Office and the Complaint Office are the same office. All right, then. Before we continue, are there any questions?
        </div>
        <div data-part="3"><strong>SECTION 3</strong>

Carlos:                 OK, everyone. Let's look at what presentation tips we have come up with for our next seminar. Melissa?
Melissa:               OK, here's my first tip. Show up early (Q21). Some experience presenters say that something good is bound to happen! I'm not sure about that, but…
David:                  Well, … you may have a chance to head off some technical problem. Also, at the beginning, before you actually begin your presentation, people filter in slowly. It's a great time to introduce yourself.
Melissa:               Can't argue with that! Simona had some ideas about opening.
Simona:               Have a strong opening. I picked up a few ideas for structuring your opening. First, never apologize (Q22). If you're worried the presentation won't go well, keep it to yourself and give it your best shot. Besides, people are usually too preoccupied with their own problems to notice yours.
Carlos:                 I like that!
Simona:               Open by addressing the following three questions: What's the problem? Who cares? What's your solution?
Carlos:                 Excellent suggestion! David? You've gone quiet!
David:                  Well, my next suggestion is PGP. That means that with every subtopic, you should move from the Particular to the General and back to the Particular (Q23). Even though the purpose of a subtopic is to convey the general information, bracing it with particulars is a good way to draw attention and promote retention. (Q24)
Melissa:               I've got another one. This might not be a tip so much as a law. Give everyone at least one piece of paper. A piece of paper is a record from your presentation. People can use that to help recall the details of the presentation, or better yet to tell others about it.
Carlos:                 The next tip that I have is know your audience (Q25). This is, of course, a general piece of advice for public speaking. See if you can find out what styles of information presentation they are most familiar and comfortable with. Adapting your presentation to those styles will leave fewer barriers to the direct communication of your material.
Simona:               I like that idea. We mentioned possible technical problems before. My next point is that maybe speakers should rethink the overhead projector. Is one really necessary?
David:                  I think that often it is. but I agree with your basic point (Q26), Simona. Don't use one just because it's there. Maybe a good tip is to consider carefully what you are putting on your slides.
Simona:               Yes, David, that's a very good point to make. Slide content is … well, you don't want too much … too little. Carlos?
Carlos:                 Good points, both of you. Another point I have is to respect the audience. Don't condescend by "dumbing down" your lecture. Show them respect by saying what you believe and what you know to be the whole story.
Melissa:               I also have a point about humor. I think that humour is generally good, but be careful with it. Humour in a presentation works best (Q27) when it actually drives the presentation forward. If you find you're using canned jokes that don't depend on the context, of the presentation, eliminate them David?
David:                  Maybe, Melissa, but always be very careful about jokes that. put. down a class of people. If you're going to alienate your audience, do it on the merits of your content.
Simona:               Also, avoid masculine-or even feminine pronouns as universal. It can be a nuisance to half the audience. As universal, use the plural "they". The Oxford English Dictionary has allowed "they" as a gender neutral singular pronoun for years.
Carlos:                 Thanks, Simona. Thinking towards the end. Take care with questions (Q28). Many people judge the quality of your talk not by the twenty minutes of presentation, but on the thirty seconds you spend answering their question (Q28). Be sure to allow long pauses for questions. Ten seconds may seem like a long pause when you're at the front of the room, but. it flows naturally from the audience's point of view.
Simona:               Let people know you believe your material. Speak with conviction. Believing your subject, matter is one of the best ways to speak more effectively!
Melissa:               Finish early, and something good is almost bound to happen (Q29). If nothing else, people will be able to leave early, and suddenly they'll have an extra couple of minutes to do things they didn't think they'd get to. People will really like you if you do that.
David:                  I think we have missed a key point. Practice! Practice over and over and over. If you can, record your presentation. Play it back and watch yourself. You'll discover a thousand horrible things you never knew about yourself. Now watch it again without the sound. Why are your hands flying around like that? Now listen to it without the picture. Get rid of those urns! Now watch it at twice the normal speed. This emphasizes low frequency cycles in your gestures.
Carlos:                 David, those were excellent points! I have one more. Something quite simple, but often overlooked. I read that the two most dehydrating things you can do in modern civilization are live presentations and air travel. I don't know if it's really true, but the message is that, the way to stay sharp is to drink lots of water (Q30). Take care of your body, especially your voice. If possible, avoid alcohol too.
Melissa:               So, we've got to organise these points now…
        </div>
        <div data-part="4"><strong>SECTION 4</strong>
<br><br>
Tutor: Hello, everyone. I have an exciting announcement to make. The university has decided to enter an international driverless vehicle competition next year, and we are going to need some enthusiastic undergraduates to help us with the project.
<br><br>
Student: What kind of competition is it?
<br><br>
Tutor: The competition is to make an automated vehicle, a kind of robot that will be able to move quickly and accurately on its own. All the vehicles will then enter a race which will take place here in the U.S.
<br><br>
Student: Which departments are involved?
<br><br>
Tutor: So, the engineering school will be collaborating with the <strong>computer science</strong> department (Q31) and possibly the Automotive Design Department, although that's yet to be confirmed.
<br><br>
Student: Is it a difficult race?
<br><br>
Tutor: To give you an idea of how tough this race is, one vehicle last year only managed 12 kilometers of the 280-kilometer stretch of California desert that forms the racetrack. The vehicles in the race must cover the whole distance without a human driver, and quite autonomously identify and steer around corners, and avoid unexpected hazards. Things like <strong>rocks</strong> (Q32), for example. It's a challenging task because there are lots of obstacles of this kind along the route.
<br><br>
Student: What kind of technology do they use?
<br><br>
Tutor: In the race held earlier this year, there was one design which we will be analyzing carefully in seminars. Its strength was in its onboard technology. That particular vehicle built a three-dimensional picture of its surroundings using <strong>video cameras</strong> (Q33), lasers, and laptops. It was equipped with seven laptop computers, which analyze the incoming information ten times a second.
<br><br>
Student: Why do they hold this race?
<br><br>
Tutor: The competition is open to all universities and there's a prize of $2 million for the winner. But it's really about more than that. The sponsors are hoping to see innovative design ideas that they can transfer into commercial production. So, primarily, it's to find <strong>useful new design features</strong> (Q34).
<br><br>
Student: What determines the winner?
<br><br>
Tutor: The tutor says success will depend on the <strong>software design</strong> (Q35). It's not just about speed or ruggedness; it's about the intelligence of the system.
<br><br>
Student: How did the teams feel about their performance last year?
<br><br>
Tutor: Even though no vehicle completed the entire course in the earlier event, this year's competitors were surprised that the vehicles <strong>were as successful as they were</strong> (Q36). They didn't expect to get as far as they did.
<br><br>
Student: What's the timeline for the project?
<br><br>
Tutor: Okay, let's look at the schedule. In Early May, there will be an introductory <strong>seminar</strong> (Q37) about the project. All interested students should attend.
<br><br>
Student: And after that?
<br><br>
Tutor: In Late May, you'll need to submit an essay giving information about your relevant experience and skills. Then in June, we will pay a visit to a factory to see some real-world applications.
<br><br>
Student: Is there anything in the summer?
<br><br>
Tutor: Yes, in <strong>July</strong> (Q38), there will be a Workshop. This is crucial for getting hands-on practice.
<br><br>
Student: And when do we start the design?
<br><br>
Tutor: In September, we will meet to discuss <strong>ideas</strong> (Q39) and learn to use the design package. By December, we expect the submission of initial designs.
<br><br>
Student: When is the final team chosen?
<br><br>
Tutor: Finally, in January, there will be the selection of the <strong>team</strong> (Q40) that will build and race the vehicle.
        </div>
    </div>

    <!-- Answer Key -->
    <div id="answer-key" style="display:none;">
        <h3>Correct Answers:</h3>
        <p><strong>Part 1:</strong></p>
        <p>1. keogh<br>2. 15<br>3. garden<br>4. music<br>5. story<br>6. 470<br>7. farm<br>8. toy<br>9. pillow<br>10. 0914638520</p>
        
        <p><strong>Part 2:</strong></p>
        <p>11. overseas<br>12. WOODSIDE<br>13. 8<br>14. tuesday<br>15. website<br>16. C<br>17. C<br>18. B<br>19. A<br>20. C</p>
        
        <p><strong>Part 3:</strong></p>
        <p>21. C<br>22. B<br>23. A<br>24. C<br>25. C<br>26. B<br>27-28. D, E<br>29-30. B, C</p>
        
        <p><strong>Part 4:</strong></p>
        <p>31. computer science<br>32. rocks<br>33. video cameras<br>34. C<br>35. A<br>36. B<br>37. seminar<br>38. skills<br>39. ideas<br>40. team</p>
    </div>

    <audio id="global-audio-player" class="hidden"></audio>

    <!-- Navigation Arrows -->
    <div class="nav-arrows">
        <button class="nav-arrow" onclick="previousPart()" id="prevBtn">‹</button>
        <button class="nav-arrow" onclick="nextPart()" id="nextBtn">›</button>
    </div>

    <!-- Bottom Navigation -->
    <nav class="nav-row perScorableItem" aria-label="Questions">
        <div class="footer__questionWrapper___1tZ46 multiple" role="tablist">
            <button role="tab" class="footer__questionNo___3WNct" onclick="switchToPart(1)">
                <span>
                    <span aria-hidden="true" class="section-prefix">Part </span>
                    <span class="sectionNr" aria-hidden="true">1</span>
                    <span class="attemptedCount" aria-hidden="true">0 of 10</span>
                </span>
            </button>
            <div class="footer__subquestionWrapper___9GgoP">
                <button class="subQuestion scorable-item" onclick="goToQuestion(1)"><span class="sr-only">Question 1</span><span aria-hidden="true">1</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(2)"><span class="sr-only">Question 2</span><span aria-hidden="true">2</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(3)"><span class="sr-only">Question 3</span><span aria-hidden="true">3</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(4)"><span class="sr-only">Question 4</span><span aria-hidden="true">4</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(5)"><span class="sr-only">Question 5</span><span aria-hidden="true">5</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(6)"><span class="sr-only">Question 6</span><span aria-hidden="true">6</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(7)"><span class="sr-only">Question 7</span><span aria-hidden="true">7</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(8)"><span class="sr-only">Question 8</span><span aria-hidden="true">8</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(9)"><span class="sr-only">Question 9</span><span aria-hidden="true">9</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(10)"><span class="sr-only">Question 10</span><span aria-hidden="true">10</span></button>
            </div>
        </div>
        
        <div class="footer__questionWrapper___1tZ46 selected multiple" role="tablist">
            <button role="tab" class="footer__questionNo___3WNct" onclick="switchToPart(2)">
                <span>
                    <span aria-hidden="true" class="section-prefix">Part </span>
                    <span class="sectionNr" aria-hidden="true">2</span>
                    <span class="attemptedCount" aria-hidden="true">0 of 10</span>
                </span>
            </button>
            <div class="footer__subquestionWrapper___9GgoP">
                <button class="subQuestion scorable-item" onclick="goToQuestion(11)"><span class="sr-only">Question 11</span><span aria-hidden="true">11</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(12)">
                    <span class="sr-only">Question 12</span>
                    <span aria-hidden="true">12</span>
                </button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(13)">
                    <span class="sr-only">Question 13</span>
                    <span aria-hidden="true">13</span>
                </button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(14)">
                    <span class="sr-only">Question 14</span>
                    <span aria-hidden="true">14</span>
                </button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(15)">
                    <span class="sr-only">Question 15</span>
                    <span aria-hidden="true">15</span>
                </button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(16)">
                    <span class="sr-only">Question 16</span>
                    <span aria-hidden="true">16</span>
                </button>
                <button class="subQuestion active scorable-item" onclick="goToQuestion(17)">
                    <span class="sr-only">Question 17</span>
                    <span aria-hidden="true">17</span>
                </button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(18)">
                    <span class="sr-only">Question 18</span>
                    <span aria-hidden="true">18</span>
                </button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(19)">
                    <span class="sr-only">Question 19</span>
                    <span aria-hidden="true">19</span>
                </button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(20)">
                    <span class="sr-only">Question 20</span>
                    <span aria-hidden="true">20</span>
                </button>
            </div>
        </div>
        
        <div class="footer__questionWrapper___1tZ46 multiple" role="tablist">
            <button role="tab" class="footer__questionNo___3WNct" onclick="switchToPart(3)">
                <span>
                    <span aria-hidden="true" class="section-prefix">Part </span>
                    <span class="sectionNr" aria-hidden="true">3</span>
                    <span class="attemptedCount" aria-hidden="true">0 of 10</span>
                </span>
            </button>
            <div class="footer__subquestionWrapper___9GgoP">
                <button class="subQuestion scorable-item" onclick="goToQuestion(21)"><span class="sr-only">Question 21</span><span aria-hidden="true">21</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(22)"><span class="sr-only">Question 22</span><span aria-hidden="true">22</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(23)"><span class="sr-only">Question 23</span><span aria-hidden="true">23</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(24)"><span class="sr-only">Question 24</span><span aria-hidden="true">24</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(25)"><span class="sr-only">Question 25</span><span aria-hidden="true">25</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(26)"><span class="sr-only">Question 26</span><span aria-hidden="true">26</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(27)"><span class="sr-only">Question 27</span><span aria-hidden="true">27</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(28)"><span class="sr-only">Question 28</span><span aria-hidden="true">28</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(29)"><span class="sr-only">Question 29</span><span aria-hidden="true">29</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(30)"><span class="sr-only">Question 30</span><span aria-hidden="true">30</span></button>
            </div>
        </div>
        
        <div class="footer__questionWrapper___1tZ46 multiple" role="tablist">
            <button role="tab" class="footer__questionNo___3WNct" onclick="switchToPart(4)">
                <span>
                    <span aria-hidden="true" class="section-prefix">Part </span>
                    <span class="sectionNr" aria-hidden="true">4</span>
                    <span class="attemptedCount" aria-hidden="true">0 of 10</span>
                </span>
            </button>
            <div class="footer__subquestionWrapper___9GgoP">
                <button class="subQuestion scorable-item" onclick="goToQuestion(31)"><span class="sr-only">Question 31</span><span aria-hidden="true">31</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(32)"><span class="sr-only">Question 32</span><span aria-hidden="true">32</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(33)"><span class="sr-only">Question 33</span><span aria-hidden="true">33</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(34)"><span class="sr-only">Question 34</span><span aria-hidden="true">34</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(35)"><span class="sr-only">Question 35</span><span aria-hidden="true">35</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(36)"><span class="sr-only">Question 36</span><span aria-hidden="true">36</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(37)"><span class="sr-only">Question 37</span><span aria-hidden="true">37</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(38)"><span class="sr-only">Question 38</span><span aria-hidden="true">38</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(39)"><span class="sr-only">Question 39</span><span aria-hidden="true">39</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(40)"><span class="sr-only">Question 40</span><span aria-hidden="true">40</span></button>
            </div>
        </div>
        
        <button id="deliver-button" aria-label="Review your answers" class="footer__deliverButton___3FM07">
            <i class="fa fa fa-check" aria-hidden="true"></i>
            <span>Check Answers</span>
        </button>
    </nav>

    <!-- Context Menu -->
    <div id="contextMenu" class="context-menu">
        <div class="context-menu-item" id="highlight-item" onclick="highlightText()">
            <span class="context-menu-icon">
                <svg viewBox="0 0 24 24" fill="black"><path d="M15.24 12.32L12.28 9.36l-1.04 1.04-1.04-1.04-1.04 1.04-1.04-1.04-1.04 1.04-1.04-1.04-3.12 3.12c-.59.58-1.54.58-2.12 0l-1.04-1.04c-.58-.59-.58-1.54 0-2.12L7.88.88c.59-.58 1.54-.58 2.12 0l1.04 1.04 1.04-1.04 1.04 1.04 1.04-1.04 1.04 1.04 1.04-1.04 3.12 3.12c.58.59.58 1.54 0 2.12l-1.04 1.04c-.58.59-1.54.59-2.12 0zM12 15l-3 3-7-7 3-3 7 7zm-9-5l-2.29 2.29c-.39.39-.39 1.02 0 1.41l8.29 8.29c.39.39 1.02.39 1.41 0L22.7 8.41c.39-.39.39-1.02 0-1.41L14.42.29c-.39-.39-1.02-.39-1.41 0L3 10z"/></svg>
            </span>
            <span>Highlight</span>
        </div>
        <div class="context-menu-item" id="comment-item" onclick="addComment()">
            <span class="context-menu-icon">
                <svg viewBox="0 0 24 24" fill="black"><path d="M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-1 12H5.17L4 15.17V4h16v10z"/></svg>
            </span>
            <span>Comment</span>
        </div>
        <div class="context-menu-item" id="clear-item" onclick="clearHighlight()" style="display:none;">
            <span class="context-menu-icon">
                <svg viewBox="0 0 24 24" fill="black"><path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/></svg>
            </span>
            <span>Clear</span>
        </div>
        <div class="context-menu-item" onclick="clearAllHighlights()">
            <span class="context-menu-icon">
                <svg viewBox="0 0 24 24" fill="black"><path d="M16 9h-2.29l3-3-1.42-1.42-3 3V5h-2v2.29l-3-3-1.42 1.42 3 3H5v2h2.29l-3 3 1.42 1.42 3-3V17h2v-2.29l3 3 1.42-1.42-3-3H17V9h-2zm-4 4h-2v-2h2v2z"/></svg>
            </span>
            <span>Clear All</span>
        </div>
    </div>

    <!-- Mobile highlight/comment toolbar -->
    <div id="mobile-selection-menu" class="mobile-selection-menu hidden">
        <button onclick="highlightText()">Highlight</button>
        <button onclick="addComment()">Comment</button>
    </div>

    <!-- Result Modal -->
    <div id="result-modal" class="modal-overlay" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Your Results</h2>
                <button id="modal-close-button" class="modal-close-btn">&times;</button>
            </div>
            <div class="modal-body">
                <p id="score-summary"></p>
                <div id="result-details"></div>
            </div>
        </div>
    </div>

    <!-- Hidden Transcription Data -->
    <div id="transcription-data" style="display: none;">
        <div data-part="1">
You will hear a number of different recordings, and you will have to answer questions on what you hear. There will be time for you to read the instructions and questions, and you will have a chance to check your work. All the recordings will be played once only.

The test is in four sections. Write all your answers in the Listening Question Booklet. At the end of the test, you will be given ten minutes to transfer your answers to an answer sheet.

Now turn to section 1 on page 2 of your question booklet. Section 1 You will hear a man phoning to ask about a festival in a town called Beechin. First you have some time to look at questions 1 to 6 on page 2. You will see that there is an example that has been done for you.

On this occasion only, the conversation relating to this will be played first. Beechin Festival Office Oh, hello. I want to check some details about the festival.

I know tickets are running out fast, and I haven't got access to the internet at present, my computer's down. OK. Well, the first activity is on June the 19th at 7pm, and it's a concert with local musicians performing.

Oh, lovely. The activity on June the 19th is a concert, so concert has been written in the space. Now we shall begin.

You should answer the questions as you listen, because you will not hear the recording a second time. Listen carefully and answer questions 1 to 6. Beechin Festival Office Oh, hello. I want to check some details about the festival.

I know tickets are running out fast, and I haven't got access to the internet at present, my computer's down. OK. Well, the first activity is on June the 19th at 7pm, and it's a concert with local musicians performing.

Oh, lovely. Is it in the theatre, like last year? Yes, that's right. And for the next activity, on the 20th, the times changed.

Is that the tour? Yes. Now, it does say on the tickets that it's a 3.40 start, but that's an error. There wasn't time to update them, unfortunately, so it should say 4.30 instead.

The correct time is on the website, though. Oh, right. Because one of my friends wants to go on that, to see Beechin with an expert and find out about the town and its history.

Does she need to get a ticket in advance? No, just turn up at the station where the guide will be waiting. They'll start from there, and I think the plan is to stop for a break in the park. And there's no charge for the tour.

And the tour will finish with a visit to the 16th century mill where they used to make flour. It's recently been restored. Fine.

And then on the 21st, there's an all-day event for children. Oh, that could be good for my visitors. They're bringing theirs, you see.

Right. Well, the plan was to have a painting competition for the kids, but it's now going to be cooking instead. And there'll be prizes for all the different age groups.

Oh, great. And it's in Beechin Community Centre. Oh, yes, I know where that is.

They don't need to bring any ingredients, but they'll need to have a plate to put whatever they've made on so they can display it and then take it home. Sounds good. And are they going ahead with the fireworks in the evening, or is that cancelled? There was an article in the paper after last year's display which suggested it might not be happening again.

That's right. No, that's still on. It's getting more popular each year, and having it in the town square was starting to be a bit difficult because of the numbers, which is why it's next to the river this time.

It'll be easy for large numbers of people to get to. Yes, of course. I'm sure there's lots to look forward to.

Before you hear the rest of the conversation, you have some time to look at questions 7 to 10 on page 2. Now listen and answer questions 7 to 10. OK, now I just want to check how it's going to impact on me as a local resident. I mean, some people last year thought it was too noisy at night.

Yes, I know. And that's why this year evening events won't go on beyond 11.15. I know previously some activities lasted until 11.45, and the new time applies now to all the events, every evening. OK.

And another change, perhaps you know about this already, is that because of high visitor numbers, parking in the town centre isn't going to be allowed. It'll be outside town. Oh, yes, to keep the streets clear, I suppose, for all the visitors.

I did know, actually, and it's not really going to be a problem for me. Right. I mean, I can just walk into town from my home.

OK. Well, anyway, if you want to check any more details about the festival, once you're back online, you can look at www.events.com and you'll be able to comment on what activities you enjoyed and that kind of thing. This will help the organisers would be if people could use the website to give feedback about what they enjoyed and that kind of thing. This will help them plan for next year.

That's probably a good idea. And with pricing, I know... That is the end of Section 1. You now have half a minute to check your answers.
        </div>
        <div data-part="2">
Now turn to Section 2 on page 3. Section 2 You will hear a tour guide talking to some tourists who are going on a walking holiday in Spain.

First you have some time to look at questions 11 to 14 on page 3. Now listen carefully and answer questions 11 to 14. Well, good evening, everyone. My name's Gary Payne and I'll be the leader for your walking holiday in Spain.

And the purpose of this evening's meeting is for us all to get to know each other in advance and for you to ask any questions you may have about the holiday. So I'll begin by telling you a little bit about what to expect. Now, the ferry crossing from England to Santander in Spain takes about 24 hours.

We'll be sailing on the Prince Regent, which was first launched in the 1980s. As well as the crew of 160, it can accommodate about 2,000 people and 600 cars. And it sails at an average speed of 37 km an hour.

There'll be an on-board map on one of the decks, which charts the ship's progress during the voyage. Although our minibus will be on one of the vehicle decks in the boat, access to these decks is prohibited during the crossing, so when you leave our bus, you'll have to take everything that you're likely to need with you, like toiletries or books and magazines. In fact, it's probably a good idea to put these things in a separate bag beforehand.

You shouldn't need snacks on board as meals are provided and they're quite substantial. And if you don't feel well or get a headache, you can get tablets from me. I always carry an adequate supply.

Now, once we're in Spain, we'll be based at a hostel in a small village called La Vega de Libana, about 120 km from Santander. It's a very picturesque area that's retained a lot of its traditional industry and culture. The hostel accommodation's fairly simple.

There are bunk beds and each room holds four to eight people. But the bathrooms and showers are of a high standard. The hostel residents have the use of tennis courts nearby, if you feel like a game.

We'll be given breakfast and an evening meal at the hostel. In general, the hostel is relaxed, but there are a few rules which the owners enforce strictly. Smoking is not allowed anywhere inside the building and food and drink is banned in the dormitories.

Any chairs or tables which you take outside into the gardens must be returned every evening to their original place. And finally, the doors are locked after midnight out of consideration for other guests who are trying to sleep. Before you hear the rest of the talk, you have some time to look at questions 15 to 20 on page 4. Now listen and answer questions 15 to 20.

Now, that's enough about travel and accommodation. But before I move on, I should say something briefly about equipment. There's a list in the guidebook you've been sent, but I'll just elaborate on one or two items.

First, boots. Make sure that the ones you bring have thick soles. That's the most important thing.

Don't bring trainers for walking in. Apart from anything else, they're dangerous because they slip. It's important to bring spare socks.

Then, about waterproofs. I'd strongly advise you not to come with anything heavy, you know, with a thick lining. The ideal things are those lightweight ones, because they fold up small, and although they do keep the wind out, they don't make you too hot.

Right? Next, sun cream. This is absolutely essential. And regarding the strength, make sure you get what's known as total block.

Even factor 25 isn't good enough for those latitudes in July. Then, let's see. Bring a folder to keep your map and other papers in, you know, one of those plastic ones.

It's not very likely to rain, but if it does, you'll find it soaks everything. So, that's the practicalities over. Now let me tell you a little bit about the area in Spain where we'll be walking, the Picos de Europa.

It's a very popular area for tourists because of its spectacular peaks. Although they're only 25 kilometres from the sea, the highest peaks are more than 2,600 metres high and have year-round snow caps. On the highest peaks, you've got alpine plants that are only free of their snow cover for a few months a year.

Then you've got meadows that are full of wildflowers at certain times of the year. Then the northern slopes are covered by woodlands, giving homes to rare species such as wolves and bears. And because of the variety of plant life, which survives in that part of Europe due to the traditional way of life there... That is the end of Section 2. You now have half a minute to check your answers.
        </div>
        <div data-part="3">
Now turn to Section 3 on page 5. Section 3 You will hear two students called Sally and Steve discussing Sally's project on peer assessment, a system where students mark each other's work. First you have some time to look at questions 21 to 24 on page 5. Now listen carefully and answer questions 21 to 24. I can't believe you're still in the library, Sally.

You've been here all day. Are you still working on your peer assessment project? Hi, Steve. Yes, I'm still here and I'm nowhere near finished.

I'm still processing the reading I've done on peer assessment. I'm interested to see if students marking each other's work is beneficial. I know a lot of the other students are pretty sceptical about its value as a way of assessing their performance.

They think the tutors are in favour of it because they don't have to spend so long marking. But I disagree. I think we can learn a great deal from it.

Yes, I can see one advantage being that it saves time spent going over things in class. Well, initially it doesn't seem to work that way and it can be quite a time-consuming business because sometimes things have to be marked again if the tutor thinks the student's assessments aren't reliable. The real gain is the fact that the students learn to stand back and assess their own assignments objectively because they're much more familiar with the marking system.

Yes, I can see that. It gives them an opportunity to reflect on their own performance. And how do they feel about having another student mark their work? Is that good for rapport? In some cases yes, in some cases no.

I think more research is needed to answer that question. What happens if a tutor notices that the marks for a particular assignment seem wrong? Should the students mark them again? That might not make any difference. So in that case the tutor would have to remark all those assignments and then go through the marking criteria really carefully with the students on the next assignment with some sample answers.

I've been reading about a research project on peer assessment. The researchers invited a group of students from two different universities to attend a one-day conference. They also invited some university lecturers to attend.

Each student gave a short presentation on a project of their choice. Each of these presentations was assessed individually by all the participants, both students and lecturers. To support their marking, they used a set of assessment guidelines that had been prepared the day before by a random selection of students.

Before you hear the rest of the discussion, you have some time to look at questions 25 to 30 on page 6. Now listen and answer questions 25 to 30. So were the student markers reliable? Well, comparisons were made between certain categories of student markers and the group as a whole, including the lecturers. The findings showed that there were some variations in the way different groups marked.

Gender did come into play, for example. I expect the male students were more generous when marking female presenters, were they? Quite the reverse, actually. They were harder on the female presenters than on the males, which wasn't what I'd expected either.

Did female students show any bias towards male presenters? Interestingly not. So does that suggest women are fairer and more reliable markers than men? Well, I wouldn't go that far. It's only a small sample.

But significantly, the results showed that when women marked other women, this didn't affect the grades they gave. What about age? Were you able to come to any conclusions about that? Yes, because we had some mature students presenting and we found the marks awarded to them by their younger peers were rather more generous. I wonder why that is.

Now, you said there were groups of students from two universities. Did they tend to favour students making presentations from their own universities? It didn't seem to influence marking one way or the other, which is quite encouraging. We'd been interested to see if students' personal relationships affected their objectivity.

One striking variation, though, was in the students who'd been asked to help devise the criteria for the marking scheme. They were actually the toughest markers of all, marking consistently below the tutors. Really? Well, it sounds as if it's generated lots of useful data.

I expect you'll be here for... That is the end of section 3. You now have half a minute to check your answers.
        </div>
        <div data-part="4">
Now turn to section 4 on page 7. Section 4 You will hear part of a linguistics lecture about a language called Bishlama that is spoken in the Pacific Islands. First, you have some time to look at questions 31-40 on page 7. Now listen carefully and answer questions 31-40.

Good morning and welcome back to this series of linguistics lectures. Today I will be talking about the language Bishlama, which is a form of pidgin English. Linguists use the term pidgin to describe new languages that are created by combining two or more existing languages, often in a simplified form.

The study of pidgin languages is important because it provides us with information about language change and modification. The pidgin English known as Bishlama is used in the South Pacific nation of Vanuatu, a group of islands where 81 first languages are still regularly used by the local people. There are a further 17 local languages that are in danger of dying out and 8 that have been identified as extinct.

This gives a total of 106 first languages in all, a very high number for a small country with a population of just 200,000 people. Then thinking about foreign languages, English is the most important and has official status largely because it is the medium for all education purposes. However, it is Bishlama that is the most widely spoken language in the country, used regularly by more than 90% of the population.

We should note here that in earlier times some people had negative feelings towards the language. In fact, for many years it was commonly referred to as a broken language and its use was discouraged. But attitudes have changed dramatically and today the people of Vanuatu are very proud of this unique language.

It is only when we understand the historical context that we can comprehend just why Bishlama developed in Vanuatu. The first form of Pidgin English in this region can be traced to around 1800 when foreign traders arrived and local people were recruited to work as sailors. On board multilingual ships there was an obvious need for a common tongue and Pidgin English was born.

This early form of Bishlama continued to spread as trade in the Pacific developed in sandalwood and other local commodities. Then from about 1860 a lot of people from Vanuatu travelled to Australia to work on the new plantations as labourers. Again, because of the multilingual nature of these workplaces it was very important to have a common language.

Finally, in modern times there have been other pressures that have maintained the need for a common language. Like many other parts of the world from about the 1950s Vanuatu experienced a significant migration of its people from small villages into the city and it has been here that Bishlama has really established itself as the country's first language. So then, how can we describe the language itself? In general terms Pidgin languages can be defined as extremely simple versions of the original language.

However, this is not a satisfactory definition in this case and linguists prefer to describe Bishlama as a developed pidgin because it has more rules and ideas than most simple pidgin languages found in other parts of the world. Let's think first about the vocabulary. Because Britain was the colonial power the majority of Bishlama's vocabulary is derived from English.

However, some care needs to be taken here. For example, the word from in Bishlama can also mean because of so we need to be aware that words can have a wider range of meanings in Bishlama. Indeed, there are numerous other potentially misleading terms and English is not the only contributor to the vocabulary.

Again, because of the region's history there are some words, around 5-10% that are derived from French. Then, a relatively small number of words have been taken from local, Pacific languages. Usually, this is the case where there is no English equivalent for naturally occurring phenomena or to describe some aspect of the culture that is unique to the country.

Finally, a word about grammar. Although the vocabulary is based largely on English it's important to note that the grammatical structure of Bishlama is derived from patterns common in the local languages of Vanuatu. So, for example, there are two distinct pronouns meaning we, one means I and you and another means I and some others but not you.

Sounds confusing in English but in the local languages such distinctions are common. A different example concerns the word long. It is almost the only preposition in Bishlama and may be used in place of a whole range of English words such as at, to, with, on, in and so on.

Well, that is the end of the formal part of the lecture. If you have any questions now, I'll be most happy to answer them. That is the end of section four.

You now have half a minute to check your answers. That is the end of the listening test. You now have ten minutes to transfer your answers to the listening answer sheet.
        </div>
    </div>

    <script>
        let currentPart = 1;
        let currentQuestion = 1;
        let selectedText = '';
        let selectedRange = null;
        let draggedElement = null;
        let testStarted = false;
        let timeInSeconds = 3600;
        let isHovering = false;
        let timerInterval;
        let contextElement = null;

        function updateAnsweredIndicators() {
            for (let qNum = 1; qNum <= 40; qNum++) {
                const btn = document.querySelector(`.subQuestion[onclick="goToQuestion(${qNum})"]`);
                if (!btn) continue;

                // Do not change style if it's already marked correct or incorrect
                if (btn.classList.contains('correct') || btn.classList.contains('incorrect')) {
                    continue;
                }

                let isAnswered = false;
                const textInput = document.getElementById(`q${qNum}`);
                const radioInput = document.querySelector(`input[name="q${qNum}"]:checked`);
                const dropZone = document.querySelector(`.drop-zone[data-question-id="${qNum}"]`);
                const clickableCell = document.querySelector(`.clickable-cell[data-question="${qNum}"].selected`);

                // Check for radio button questions first (questions 15-16, 17-20, etc.)
                if (radioInput) {
                    isAnswered = true;
                    if (qNum >= 15 && qNum <= 20) {
                        console.log(`Question ${qNum} radio detected as answered: ${radioInput.value}`);
                    }
                // Check for checkbox questions with multiple answer requirements
                } else if (textInput && typeof textInput.value === 'string' && textInput.value.trim() !== '') {
                    isAnswered = true;
                } else if (dropZone && dropZone.querySelector('.drag-item')) {
                    isAnswered = true;
                } else if (clickableCell) {
                    isAnswered = true;
                    if (qNum >= 13 && qNum <= 16 || qNum >= 25 && qNum <= 30) {
                        console.log(`Question ${qNum} clickable cell detected as answered: ${clickableCell.getAttribute('data-value')}`);
                        console.log(`Clickable cell element:`, clickableCell);
                    }
                }

                if (isAnswered) {
                    btn.classList.add('answered');
                } else {
                    btn.classList.remove('answered');
                }
            }
            // Keep attempted count in sync with latest interactions
            updateAttemptedCount(currentPart);
        }

        const audioPlayer = document.getElementById('global-audio-player');
        const timerContainer = document.querySelector('.timer-container');
        const timerDisplay = document.querySelector('.timer-display');
        const volumeSlider = document.getElementById('new-volume-slider');
        const playPauseBtn = document.getElementById('play-pause-btn');
        const progressBar = document.getElementById('progress-bar');
        const currentTimeEl = document.getElementById('current-time');
        const totalDurationEl = document.getElementById('total-duration');
        const speedBtn = document.getElementById('speed-btn');
        const speedOptions = document.getElementById('speed-options');
        const volumeBtn = document.getElementById('volume-btn');

        const audioSource = 'https://ia601706.us.archive.org/4/items/mix-29m-15s-audio-joiner.com-copy-copy-copy-copy-copy-copy-copy-copy-copy-copy-c/mix_29m15s%20%28audio-joiner.com%29%20-%20CopyCopyCopyCopyCopyCopyCopyCopyCopyCopyCopyCopyCopyCopyCopyCopyCopyCopyCopyCopyCopy.mp3';
        audioPlayer.src = audioSource;



                function setupCheckboxLimits() {
                const groupsWithLimits = [
                    { name: 'q18-20', max: 3},
                    { name: 'q27-28', max: 2},
                    { name: 'q29-30', max: 2}
                ];

            groupsWithLimits.forEach(({ name, max }) => {
                const checkboxes = Array.from(document.querySelectorAll(`input[type="checkbox"][name="${name}"]`));
                if (checkboxes.length === 0) return;

                const applyLimitState = () => {
                    const checkedCount = checkboxes.filter(c => c.checked).length;
                    if (checkedCount >= max) {
                        // Disable all remaining unchecked options when limit reached
                        checkboxes.forEach(c => { if (!c.checked) c.disabled = true; });
                    } else {
                        // Re-enable options when below limit
                        checkboxes.forEach(c => { c.disabled = false; });
                    }
                    updateAnsweredIndicators();
                };

                checkboxes.forEach(cb => {
                    cb.addEventListener('change', applyLimitState);
                });

                // Initialize on load
                applyLimitState();
            });
        }

        // Ensure checkbox limits are applied once the DOM is ready
        document.addEventListener('DOMContentLoaded', setupCheckboxLimits);

        // Test function to verify clickable cells are working
        function testClickableCells() {
            console.log('Testing clickable cells...');
            const cells = document.querySelectorAll('.clickable-cell');
            console.log(`Found ${cells.length} clickable cells`);
            cells.forEach((cell, index) => {
                const question = cell.getAttribute('data-question');
                const value = cell.getAttribute('data-value');
                console.log(`Cell ${index}: question=${question}, value=${value}`);
            });
        }
        
        function selectCell(cell, questionNumber, value) {
            // Remove previous selection for this question
            const questionRow = cell.closest('tr');
            const cellsInRow = questionRow.querySelectorAll('.clickable-cell');
            cellsInRow.forEach(cell => {
                cell.classList.remove('selected');
                cell.style.backgroundColor = '#f8f9fa';
                cell.style.color = 'black';
            });
            
            // Select the clicked cell
            cell.classList.add('selected');
            cell.style.backgroundColor = '#4a90e2';
            cell.style.color = 'white';
            
            // Persist selection in hidden input (for answered state and grading if needed)
            const hiddenInput = document.getElementById(`q${questionNumber}`);
            if (hiddenInput) {
                hiddenInput.value = value;
            }
            
            // Update answered indicators
            updateAnsweredIndicators();
        }

        function switchToPart(partNumber, andPlay = false) {
            if (currentPart !== partNumber) {
                const firstQuestionOfPart = (partNumber - 1) * 10 + 1;
                currentQuestion = firstQuestionOfPart;
            }
            
            currentPart = partNumber;

            updateNavigation();
            document.querySelectorAll('.question-part').forEach(part => part.classList.add('hidden'));
            const partToShow = document.getElementById(`part-${partNumber}`);
            if (partToShow) {
                partToShow.classList.remove('hidden');
            }

            if (document.querySelector('.main-container.results-mode')) {
                const transcriptionSource = document.querySelector(`#transcription-data [data-part="${partNumber}"]`);
                const transcriptionTarget = document.getElementById('transcription-text');
                if (transcriptionSource && transcriptionTarget) {
                    transcriptionTarget.innerHTML = transcriptionSource.innerHTML;
                }
            }

            updateNavigation();
        }

        function updateNavigation() {
            document.querySelectorAll('.footer__questionWrapper___1tZ46').forEach((wrapper, index) => {
                wrapper.classList.remove('selected');
                updateAttemptedCount(index + 1);
            });
            const currentWrapper = document.querySelectorAll('.footer__questionWrapper___1tZ46')[currentPart - 1];
            if (currentWrapper) {
                currentWrapper.classList.add('selected');
            }
            document.getElementById('prevBtn').disabled = currentQuestion === 1;
            document.getElementById('nextBtn').disabled = currentQuestion === 40;
        }

        function goToQuestion(questionNumber) {
            currentQuestion = questionNumber;
            let partNumber = 1;
            if (questionNumber > 10 && questionNumber <= 20) partNumber = 2;
            else if (questionNumber > 20 && questionNumber <= 30) partNumber = 3;
            else if (questionNumber > 30) partNumber = 4;
            if (currentPart !== partNumber) {
                switchToPart(partNumber);
            }
            document.querySelectorAll('.subQuestion').forEach(btn => btn.classList.remove('active'));
            const questionBtn = document.querySelector(`.subQuestion[onclick="goToQuestion(${questionNumber})"]`);
            if (questionBtn) questionBtn.classList.add('active');

            // Scroll to the question
            let questionElement;
            if (questionNumber >= 27 && questionNumber <= 28) {
               questionElement = document.querySelector('input[name="q27-28"]');
            } else if (questionNumber >= 29 && questionNumber <= 30) {
               questionElement = document.querySelector('input[name="q29-30"]');
            } else {
                questionElement = document.getElementById(`q${questionNumber}`) || // text inputs
                                document.querySelector(`[data-question-id="${questionNumber}"]`) || // drag-drop
                                document.querySelector(`input[name="q${questionNumber}"]`) || // radio buttons
                                document.querySelector(`.clickable-cell[data-question="${questionNumber}"]`); // clickable cells (27-30)
            }
            
            if (questionElement) {
                const questionContainer = questionElement.closest('.question');
                if(questionContainer) {
                    questionContainer.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    questionContainer.classList.add('flash');
                    setTimeout(() => {
                        questionContainer.classList.remove('flash');
                    }, 1000);
                }
            }
            updateNavigation();
        }

        function nextPart() {
            if (currentQuestion < 40) {
                goToQuestion(currentQuestion + 1);
            }
        }

        function previousPart() {
            if (currentQuestion > 1) {
                goToQuestion(currentQuestion - 1);
            }
        }

        function highlightText() {
            if (!selectedRange || selectedRange.collapsed) {
                closeContextMenu();
                return;
            }
            
            try {
                // Check if selection spans multiple elements
                const startContainer = selectedRange.startContainer;
                const endContainer = selectedRange.endContainer;
                
                if (startContainer === endContainer && startContainer.nodeType === Node.TEXT_NODE) {
                    // Simple case: selection within a single text node
                    const span = document.createElement('span');
                    span.className = 'highlight';
                    selectedRange.surroundContents(span);
                } else {
                    // Complex case: selection spans multiple elements
                    // Handle partial text selections and complex DOM structures
                    
                    // First, handle partial text at the start
                    const startOffset = selectedRange.startOffset;
                    const endOffset = selectedRange.endOffset;
                    
                    if (startContainer.nodeType === Node.TEXT_NODE && startOffset > 0) {
                        // Split the start text node if selection starts in the middle
                        const startText = startContainer.textContent;
                        const beforeText = startText.substring(0, startOffset);
                        const selectedStartText = startText.substring(startOffset);
                        
                        const beforeNode = document.createTextNode(beforeText);
                        const selectedNode = document.createTextNode(selectedStartText);
                        
                        const parent = startContainer.parentNode;
                        parent.insertBefore(beforeNode, startContainer);
                        parent.insertBefore(selectedNode, startContainer);
                        parent.removeChild(startContainer);
                        
                        // Update the range to start from the new node
                        selectedRange.setStart(selectedNode, 0);
                    }
                    
                    if (endContainer.nodeType === Node.TEXT_NODE && endOffset < endContainer.textContent.length) {
                        // Split the end text node if selection ends in the middle
                        const endText = endContainer.textContent;
                        const selectedEndText = endText.substring(0, endOffset);
                        const afterText = endText.substring(endOffset);
                        
                        const selectedNode = document.createTextNode(selectedEndText);
                        const afterNode = document.createTextNode(afterText);
                        
                        const parent = endContainer.parentNode;
                        parent.insertBefore(selectedNode, endContainer);
                        parent.insertBefore(afterNode, endContainer);
                        parent.removeChild(endContainer);
                        
                        // Update the range to end at the new node
                        selectedRange.setEnd(selectedNode, selectedNode.textContent.length);
                    }
                    
                    // Now extract the contents and highlight all text nodes
                    const fragment = selectedRange.extractContents();
                    
                    // Create a tree walker to find all text nodes
                    const walker = document.createTreeWalker(
                        fragment,
                        NodeFilter.SHOW_TEXT,
                        {
                            acceptNode: function(node) {
                                // Accept text nodes that have content (not just whitespace)
                                return node.textContent.trim() ? NodeFilter.FILTER_ACCEPT : NodeFilter.FILTER_SKIP;
                            }
                        },
                        false
                    );
                    
                    const textNodes = [];
                    let node;
                    while (node = walker.nextNode()) {
                        textNodes.push(node);
                    }
                    
                    // Wrap each text node in a highlight span
                    textNodes.forEach(textNode => {
                        const span = document.createElement('span');
                        span.className = 'highlight';
                        const parent = textNode.parentNode;
                        if (parent) {
                            parent.insertBefore(span, textNode);
                            span.appendChild(textNode);
                        }
                    });
                    
                    // Insert the highlighted fragment back
                    selectedRange.insertNode(fragment);
                }
            } catch(err) {
                console.warn('Primary highlighting failed, trying robust fallback:', err);
                
                // Robust fallback for complex selections
                try {
                    const selection = window.getSelection();
                    if (selection.rangeCount > 0) {
                        const range = selection.getRangeAt(0);
                        
                        // Get all nodes in the selection
                        const startContainer = range.startContainer;
                        const endContainer = range.endContainer;
                        const commonAncestor = range.commonAncestorContainer;
                        
                        // Create a temporary range to work with
                        const tempRange = document.createRange();
                        tempRange.selectNodeContents(commonAncestor);
                        
                        // Find the start and end positions
                        const startPos = range.startOffset;
                        const endPos = range.endOffset;
                        
                        // Extract and highlight the content
                        const contents = range.extractContents();
                        
                        // Recursively highlight all text content
                        function highlightAllText(node) {
                            if (node.nodeType === Node.TEXT_NODE) {
                                if (node.textContent.trim()) {
                                    const span = document.createElement('span');
                                    span.className = 'highlight';
                                    span.style.backgroundColor = '#ffff00';
                                    const parent = node.parentNode;
                                    if (parent) {
                                        parent.insertBefore(span, node);
                                        span.appendChild(node);
                                    }
                                }
                            } else if (node.nodeType === Node.ELEMENT_NODE) {
                                Array.from(node.childNodes).forEach(child => {
                                    highlightAllText(child);
                                });
                            }
                        }
                        
                        highlightAllText(contents);
                        range.insertNode(contents);
                    }
                } catch(e2) {
                    console.warn('Robust fallback failed, using final method:', e2);
                    // Final fallback - use execCommand
                    try {
                        document.execCommand('backColor', false, 'yellow');
                    } catch(e3) {
                        console.error('All highlighting methods failed:', e3);
                        // Show user feedback
                        alert('Highlighting failed for this selection. Please try selecting smaller portions of text.');
                    }
                }
            }
            
            window.getSelection().removeAllRanges();
            closeContextMenu();
        }

        function addComment() {
            const commentText = prompt('Enter your comment:');
            if (!commentText || !selectedRange || selectedRange.collapsed) {
                closeContextMenu();
                return;
            }
            try {
                const span = document.createElement('span');
                span.className = 'comment-highlight';
                const tooltip = document.createElement('span');
                tooltip.className = 'comment-tooltip';
                tooltip.textContent = commentText;
                span.appendChild(tooltip);
                selectedRange.surroundContents(span);
            }catch(err){
                console.warn('Complex selection – cannot comment');
            }
            window.getSelection().removeAllRanges();
            closeContextMenu();
        }

        function clearHighlight() {
           const elementToClear = contextElement;
           if (!elementToClear) {
               closeContextMenu();
               return;
           }
           const parent = elementToClear.parentNode;
           
           while (elementToClear.firstChild) {
               if (!elementToClear.firstChild.classList?.contains('comment-tooltip')) {
                   parent.insertBefore(elementToClear.firstChild, elementToClear);
               } else {
                   elementToClear.removeChild(elementToClear.firstChild);
               }
           }
           parent.removeChild(elementToClear);
           parent.normalize();
           closeContextMenu();
        }

        function clearAllHighlights() {
            document.querySelectorAll('.highlight, .comment-highlight').forEach(element => {
                const parent = element.parentNode;
                const fragment = document.createDocumentFragment();

                while (element.firstChild) {
                    if (element.firstChild.nodeType === 1 && element.firstChild.classList.contains('comment-tooltip')) {
                        element.removeChild(element.firstChild);
                    } else {
                        fragment.appendChild(element.firstChild);
                    }
                }
                parent.replaceChild(fragment, element);
            });
            closeContextMenu();
        }
        
        function closeContextMenu() {
            document.getElementById('contextMenu').style.display = 'none';
            contextElement = null;
        }

        function updateAttemptedCount(partNumber) {
            const partContainer = document.getElementById(`part-${partNumber}`);
            if (!partContainer) return;
            const inputs = partContainer.querySelectorAll('input.answer-input:not([disabled]):not([type="hidden"]), input[type="radio"]:not([disabled]), input[type="checkbox"]:not([disabled])');
            let answeredCount = 0;
            const answeredGroups = {};
            inputs.forEach(input => {
                if (input.type === 'radio' || input.type === 'checkbox') {
                    if (input.name === 'q27-28') {
                        const checkedCount = partContainer.querySelectorAll('input[name="q27-28"]:checked').length;
                        const keyFirst = 'q27-28-first';
                        const keySecond = 'q27-28-second';
                        if (checkedCount >= 1 && !answeredGroups[keyFirst]) {
                            answeredCount++;
                            answeredGroups[keyFirst] = true;
                        }
                        if (checkedCount >= 2 && !answeredGroups[keySecond]) {
                            answeredCount++;
                            answeredGroups[keySecond] = true;
                        }
                    } else if (input.name === 'q29-30') {
                        const checkedCount = partContainer.querySelectorAll('input[name="q29-30"]:checked').length;
                        const keyFirst = 'q29-30-first';
                        const keySecond = 'q29-30-second';
                        if (checkedCount >= 1 && !answeredGroups[keyFirst]) {
                            answeredCount++;
                            answeredGroups[keyFirst] = true;
                        }
                        if (checkedCount >= 2 && !answeredGroups[keySecond]) {
                            answeredCount++;
                            answeredGroups[keySecond] = true;
                        }
                    } else if (input.name === 'q31-32') {
                        const checkedCount = partContainer.querySelectorAll('input[name="q31-32"]:checked').length;
                        // Represent q31 and q32 as two separate questions in the footer count
                        const keyFirst = 'q31-32-first';
                        const keySecond = 'q31-32-second';
                        if (checkedCount >= 1 && !answeredGroups[keyFirst]) {
                            answeredCount++;
                            answeredGroups[keyFirst] = true;
                        }
                        if (checkedCount >= 2 && !answeredGroups[keySecond]) {
                            answeredCount++;
                            answeredGroups[keySecond] = true;
                        }
                    } else if (input.checked && !answeredGroups[input.name]) {
                        answeredCount++;
                        answeredGroups[input.name] = true;
                    }
                } else {
                    if (input.value.trim() !== '') answeredCount++;
                }
            });
            // Include drag/drop filled zones as answered
            const zones = partContainer.querySelectorAll('.drop-zone[data-question-id]');
            zones.forEach(zone => {
                if (zone.querySelector('.drag-item')) {
                    answeredCount++;
                }
            });
            
            // Include clickable cells as answered (includes Questions 26-30)
            const clickableCells = partContainer.querySelectorAll('.clickable-cell.selected');
            clickableCells.forEach(cell => {
                const questionNum = cell.getAttribute('data-question');
                if (questionNum && !answeredGroups[`clickable-${questionNum}`]) {
                    answeredCount++;
                    answeredGroups[`clickable-${questionNum}`] = true;
                }
            });
            
            // Include map questions (11-15) as answered if they have a selection
            for (let i = 11; i <= 15; i++) {
                const selectElement = partContainer.querySelector(`#q${i}`);
                if (selectElement && selectElement.value && selectElement.value !== '' && !answeredGroups[`map-${i}`]) {
                    answeredCount++;
                    answeredGroups[`map-${i}`] = true;
                }
            }
            const countDisplay = document.querySelector(`.footer__questionWrapper___1tZ46:nth-child(${partNumber}) .attemptedCount`);
            if (countDisplay) countDisplay.textContent = `${answeredCount} of 10`;
        }

        // === Answer key and question type mapping ===
        const correctAnswers = {
            // Part 1
            q1: 'keogh',
            q2: '15',
            q3: 'garden',
            q4: 'music',
            q5: 'story',
            q6: '470',
            q7: 'farm',
            q8: 'toy',
            q9: 'pillow',
            q10: '0914638520',
            // Part 2
            q11: 'overseas',
            q12: 'WOODSIDE',
            q13: '8',
            q14: 'tuesday',
            q15: 'website',
            q16: 'C',
            q17: 'C',
            q18: 'B',
            q19: 'A',
            q20: 'C',
            // Part 3 MCQ
            q21: 'C',
            q22: 'B',
            q23: 'A',
            q24: 'C',
            q25: 'C',
            q26: 'B',
            // Part 3 Checkbox
            'q27-28': ['D', 'E'],
            'q29-30': ['B', 'C'],
            // Part 4 text
            q31: 'computer science',
            q32: 'rocks',
            q33: 'video cameras',
            q34: 'C',
            q35: 'A',
            q36: 'B',
            q37: 'seminar',
            q38: 'skills',
            q39: 'ideas',
            q40: 'team'
        };

        const questionTypes = {
            // Part 1
            q1: 'text', q2: 'text', q3: 'text', q4: 'text', q5: 'text',
            q6: 'text', q7: 'text', q8: 'text', q9: 'text', q10: 'text',
            // Part 2
            q11: 'text', q12: 'text', q13: 'text', q14: 'text', q15: 'text',
            q16: 'mcq', q17: 'mcq', q18: 'mcq', q19: 'mcq', q20: 'mcq',
            // Part 3
            q21: 'mcq', q22: 'mcq', q23: 'mcq', q24: 'mcq', q25: 'mcq', q26: 'mcq',
            'q27-28': 'checkbox', 'q29-30': 'checkbox',
            // Part 4
            q31: 'text', q32: 'text', q33: 'text', q34: 'mcq', q35: 'mcq', q36: 'mcq', q37: 'text', q38: 'text', q39: 'text', q40: 'text'
        };

        function checkAnswers() {
            let score = 0;
            let resultsData = [];
            document.querySelectorAll('.correct, .incorrect, .correct-answer-text, .correct-inline').forEach(el => {
                if (el.classList.contains('correct-answer-text') || el.classList.contains('correct-inline')) {
                    el.remove();
                } else {
                    el.classList.remove('correct', 'incorrect');
                }
            });
            
            Object.keys(correctAnswers).forEach(key => {
                const correctAnswer = correctAnswers[key];
                let userAnswer = '';
                let isCorrect = false;
                const questionType = questionTypes[key];
                
                // Handle different question types
                if (key.includes('-')) {
                    // Multi-question keys like 'q11-12', 'q13-14'
                    const [startQ, endQ] = key.split('-').map(q => parseInt(q.replace('q', '')));
                    
                    switch(questionType) {
                        case 'checkbox':
                            const checkedBoxes = document.querySelectorAll(`input[name="${key}"]:checked`);
                            const userAnswers = Array.from(checkedBoxes).map(cb => cb.value).sort();
                            userAnswer = userAnswers.join(', ');
                            const correctAnswersSorted = Array.isArray(correctAnswer) ? [...correctAnswer].sort() : [correctAnswer];
                            
                            // Count how many correct answers the user selected
                            const correctUserAnswers = userAnswers.filter(ans => correctAnswersSorted.includes(ans));
                            
                            // Additive-only scoring: 1 point per correct selected; no penalty for incorrect
                            const questionScore = correctUserAnswers.length;
                            score += questionScore;
                            
                            // Mark group as fully correct only if all correct options are selected and no extra are selected
                            isCorrect = (correctUserAnswers.length === correctAnswersSorted.length && userAnswers.length === correctAnswersSorted.length);
                            
                            // Mark individual checkboxes
                            checkedBoxes.forEach(cb => {
                                const label = cb.closest('label');
                                if (label) {
                                    if (correctAnswersSorted.includes(cb.value)) {
                                        label.classList.add('correct');
                                    } else {
                                        label.classList.add('incorrect');
                                    }
                                }
                            });
                            
                            // Mark correct answers that weren't selected
                            correctAnswersSorted.forEach(correctVal => {
                                const correctCheckbox = document.querySelector(`input[name="${key}"][value="${correctVal}"]`);
                                if (correctCheckbox && !correctCheckbox.checked) {
                                    const correctLabel = correctCheckbox.closest('label');
                                    if (correctLabel) {
                                        correctLabel.classList.add('correct');
                                    }
                                }
                            });
                            break;
                    }
                    
                    // Mark buttons for the question range
                    for (let qNum = startQ; qNum <= endQ; qNum++) {
                        const btn = document.querySelector(`.subQuestion[onclick="goToQuestion(${qNum})"]`);
                        if (btn) {
                            btn.classList.remove('answered');
                            btn.classList.add(isCorrect ? 'correct' : 'incorrect');
                        }
                    }
                    
                    resultsData.push({
                        question: `${startQ}-${endQ}`,
                        userAnswer: userAnswer || 'No Answer',
                        correctAnswer: Array.isArray(correctAnswer) ? correctAnswer.join(', ') : String(correctAnswer),
                        isCorrect: isCorrect
                    });
                    
                    // For checkbox questions in multi-question keys, score was already added in switch statement
                    // Don't add additional score here - return to next iteration of forEach
                    return;
                }
                
                   const qNum = parseInt(key.replace('q', ''));
                   const btn = document.querySelector(`.subQuestion[onclick="goToQuestion(${qNum})"]`);
                   const element = document.getElementById(key) || document.querySelector(`input[name="${key}"]`);

                   // Determine question type: prefer explicit mapping over DOM input type
                   if (!questionType) {
                       if (element?.type === 'radio') questionType = 'mcq';
                       else if (element?.type === 'text') questionType = 'text';
                   }
                   
                    switch (questionType) {
                       case 'text':
                           userAnswer = element.value.trim();
                           const acceptedAnswers = Array.isArray(correctAnswer) ? correctAnswer : [String(correctAnswer)];
                           isCorrect = acceptedAnswers.some(ans => ans.toLowerCase() === userAnswer.toLowerCase());
                           element.classList.add(isCorrect ? 'correct' : 'incorrect');
                           if (!isCorrect) {
                                const correctAnswerSpan = document.createElement('span');
                                correctAnswerSpan.className = 'correct-inline';
                                correctAnswerSpan.textContent = acceptedAnswers[0];
                                element.insertAdjacentElement('afterend', correctAnswerSpan);
                           }
                           break;
                        case 'mcq':
                            // For map questions (11-20), use the select dropdown selection instead of radios
                            if (qNum >= 11 && qNum <= 20) {
                                const selectElement = document.getElementById(key);
                                if (selectElement) {
                                    userAnswer = (selectElement.value || '').trim();
                                    isCorrect = userAnswer === correctAnswer;
                                    selectElement.classList.add(isCorrect ? 'correct' : 'incorrect');
                                    if (!isCorrect) {
                                        const correctAnswerSpan = document.createElement('span');
                                        correctAnswerSpan.className = 'correct-inline';
                                        correctAnswerSpan.textContent = String(correctAnswer);
                                        selectElement.insertAdjacentElement('afterend', correctAnswerSpan);
                                    }
                                    break;
                                }
                            }

                            // Default MCQ grading via radio inputs
                            const radioChecked = document.querySelector(`input[name="${key}"]:checked`);
                            userAnswer = radioChecked ? radioChecked.value : 'No Answer';
                            isCorrect = userAnswer === correctAnswer;
                            const radios = document.querySelectorAll(`input[name="${key}"]`);
                            radios.forEach(radio => {
                                const label = radio.closest('label');
                                const wrapper = radio.closest('.multi-choice-option') || label;
                                if (radio.value === correctAnswer) {
                                    wrapper.classList.add('correct');
                                } else if (radio.checked) {
                                    wrapper.classList.add('incorrect');
                                }
                            });
                            break;
                        case 'dragdrop': {
                            const dz = document.querySelector(`.drop-zone[data-question-id="${qNum}"]`);
                            const dropped = dz ? dz.querySelector('.drag-item') : null;
                            // Prefer hidden input (kept in sync on drop), then dataset/attribute
                            const hiddenVal = element ? element.value.trim() : '';
                            if (hiddenVal) {
                                userAnswer = hiddenVal;
                            } else if (dropped) {
                                const dataLetter = dropped.getAttribute('data-letter') || dropped.dataset.letter;
                                userAnswer = (dataLetter && dataLetter.trim()) || dropped.textContent.trim();
                            } else {
                                userAnswer = '';
                            }
                            const accepted = Array.isArray(correctAnswer) ? correctAnswer.map(a=>String(a).toLowerCase()) : [String(correctAnswer).toLowerCase()];
                            isCorrect = userAnswer && accepted.includes(String(userAnswer).toLowerCase());
                            if (!isCorrect) {
                                const correctAnswerSpan = document.createElement('span');
                                correctAnswerSpan.className = 'correct-inline';
                                // show canonical uppercase answer for letters
                                const showVal = Array.isArray(correctAnswer) ? String(correctAnswer[0]) : String(correctAnswer);
                                correctAnswerSpan.textContent = showVal;
                                // Make sure it sits inline with the question row
                                correctAnswerSpan.style.display = 'inline-block';
                                correctAnswerSpan.style.marginLeft = '8px';
                                const anchor = dz || element; // prefer drop-zone, fallback to hidden input
                                if (anchor) {
                                    anchor.insertAdjacentElement('afterend', correctAnswerSpan);
                                }
                            }
                            break; }
                       case 'clickable':
                           const selectedCell = document.querySelector(`.clickable-cell[data-question="${qNum}"].selected`);
                           userAnswer = selectedCell ? selectedCell.getAttribute('data-value') : 'No Answer';
                           isCorrect = userAnswer === correctAnswer;
                           
                           // Mark cells as correct/incorrect
                           const allCells = document.querySelectorAll(`.clickable-cell[data-question="${qNum}"]`);
                           allCells.forEach(cell => {
                               if (cell.getAttribute('data-value') === correctAnswer) {
                                   cell.classList.add('correct');
                               } else if (cell.classList.contains('selected')) {
                                   cell.classList.add('incorrect');
                               }
                           });
                           break;
                       case 'checkbox':
                           const checkedBoxes = document.querySelectorAll(`input[name="${key}"]:checked`);
                           const userAnswers = Array.from(checkedBoxes).map(cb => cb.value).sort();
                           userAnswer = userAnswers.join(', ');
                           const correctAnswersSorted = Array.isArray(correctAnswer) ? correctAnswer.sort() : [correctAnswer];
                           
                           // Count how many correct answers the user selected
                           const correctUserAnswers = userAnswers.filter(ans => correctAnswersSorted.includes(ans));
                           
                           // Additive-only scoring: 1 point per correct selected; no penalty for incorrect
                           const questionScore = correctUserAnswers.length;
                           score += questionScore;
                           
                           // Mark group as fully correct only if all correct options are selected and no extra are selected
                           isCorrect = (correctUserAnswers.length === correctAnswersSorted.length && userAnswers.length === correctAnswersSorted.length);
                           
                           // Mark individual checkboxes
                           checkedBoxes.forEach(cb => {
                               const label = cb.closest('label');
                               if (label) {
                                   if (correctAnswersSorted.includes(cb.value)) {
                                       label.classList.add('correct');
                                   } else {
                                       label.classList.add('incorrect');
                                   }
                               }
                           });
                           
                           // Mark correct answers that weren't selected
                           correctAnswersSorted.forEach(correctVal => {
                               const correctCheckbox = document.querySelector(`input[name="${key}"][value="${correctVal}"]`);
                               if (correctCheckbox && !correctCheckbox.checked) {
                                   const correctLabel = correctCheckbox.closest('label');
                                   if (correctLabel) {
                                       correctLabel.classList.add('correct');
                                   }
                               }
                           });
                           break;
                   }

                   if (btn) {
                       btn.classList.remove('answered');
                       btn.classList.add(isCorrect ? 'correct' : 'incorrect');
                   }

                   resultsData.push({
                       question: qNum,
                       userAnswer: userAnswer || 'No Answer',
                       correctAnswer: Array.isArray(correctAnswer) ? correctAnswer.join(' / ') : String(correctAnswer),
                       isCorrect: isCorrect
                   });

                // For checkbox questions, score was already added in the switch statement
                // Only add score for non-checkbox questions
                if (questionType !== 'checkbox' && isCorrect) {
                   score++;
               }
            });

            const deliverButton = document.getElementById('deliver-button');
            const band = (function(raw){
                if(raw>=39) return 9;
                if(raw>=37) return 8.5;
                if(raw>=35) return 8;
                if(raw>=32) return 7.5;
                if(raw>=30) return 7;
                if(raw>=26) return 6.5;
                if(raw>=23) return 6;
                if(raw>=18) return 5.5;
                if(raw>=16) return 5;
                if(raw>=13) return 4.5;
                if(raw>=10) return 4;
                if(raw>=8)  return 3.5;
                if(raw>=6)  return 3;
                if(raw>=4)  return 2.5;
                if(raw>=2)  return 2;
                if(raw===1) return 1.5;
                return 0;
            })(score);

            // Disable all inputs after grading
            document.querySelectorAll('.answer-input, input[type="radio"], input[type="checkbox"]').forEach(input => {
                input.disabled = true;
            });
            document.querySelectorAll('.drag-item').forEach(item => {
                item.setAttribute('draggable', 'false');
                item.style.cursor = 'default';
            });
            document.querySelectorAll('.drop-zone').forEach(zone => {
                zone.classList.remove('drag-over'); // Ensure no lingering hover styles
            });

            // Results mode layout with transcription
            document.querySelector('.main-container').classList.add('results-mode');
            switchToPart(currentPart); // Show the transcription for the current part

            // Populate modal content (but do not force-open yet)
            const modal = document.getElementById('result-modal');
            const scoreSummary = document.getElementById('score-summary');
            const resultDetails = document.getElementById('result-details');
            
            scoreSummary.textContent = `You scored ${score} out of 40 (Band ${band}).`;
            
            let tableHTML = '<table><thead><tr><th>Question</th><th>Your Answer</th><th>Correct Answer</th><th>Result</th></tr></thead><tbody>';
            resultsData.sort((a,b) => parseInt(a.question, 10) - parseInt(b.question, 10)).forEach(res => {
                tableHTML += `
                    <tr>
                        <td>${res.question}</td>
                        <td>${res.userAnswer}</td>
                        <td>${res.correctAnswer}</td>
                        <td class="${res.isCorrect ? 'result-correct' : 'result-incorrect'}">
                            ${res.isCorrect ? '✔ Correct' : '✖ Incorrect'}
                        </td>
                    </tr>
                `;
            });
            tableHTML += '</tbody></table>';
            // Controls: filter toggles and export
            const controls = document.createElement('div');
            controls.className = 'result-controls';
            controls.innerHTML = `
                <label><input type="checkbox" id="toggle-correct" checked> Show correct</label>
                <label><input type="checkbox" id="toggle-incorrect" checked> Show incorrect</label>
                <span class="spacer"></span>
                <button id="export-csv" class="btn-secondary">Export CSV</button>
            `;
            // Apply to modal
            resultDetails.innerHTML = '';
            resultDetails.appendChild(controls);
            const tableContainer = document.createElement('div');
            tableContainer.innerHTML = tableHTML;
            resultDetails.appendChild(tableContainer);
            
            // Wire up filters
            const toggleCorrect = controls.querySelector('#toggle-correct');
            const toggleIncorrect = controls.querySelector('#toggle-incorrect');
            function applyFilters(){
                tableContainer.querySelectorAll('tbody tr').forEach(row => {
                    const isCorrect = row.querySelector('td.result-correct') !== null;
                    const isIncorrect = row.querySelector('td.result-incorrect') !== null;
                    let visible = true;
                    if (isCorrect && !toggleCorrect.checked) visible = false;
                    if (isIncorrect && !toggleIncorrect.checked) visible = false;
                    row.style.display = visible ? '' : 'none';
                });
            }
            toggleCorrect.addEventListener('change', applyFilters);
            toggleIncorrect.addEventListener('change', applyFilters);
            applyFilters();
            
            // CSV export
            controls.querySelector('#export-csv').addEventListener('click', () => {
                const rows = [['Question','Your Answer','Correct Answer','Result']];
                tableContainer.querySelectorAll('tbody tr').forEach(tr => {
                    if (tr.style.display === 'none') return; // respect filters
                    const tds = tr.querySelectorAll('td');
                    const resultCell = tds[3];
                    const resultText = resultCell.classList.contains('result-correct') ? 'Correct' : 'Incorrect';
                    rows.push([tds[0].textContent.trim(), tds[1].textContent.trim(), tds[2].textContent.trim(), resultText]);
                });
                const csv = rows.map(r => r.map(v => '"' + v.replace(/"/g,'""') + '"').join(',')).join('\n');
                const blob = new Blob([csv], {type: 'text/csv;charset=utf-8;'});
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'listening_results.csv';
                a.click();
                URL.revokeObjectURL(url);
            });
            resultDetails.innerHTML = tableHTML;

            // Turn the deliver button into a green "My Results" button
            deliverButton.classList.add('success');
            deliverButton.innerHTML = '<span>My Results</span>';
            deliverButton.disabled = false;

            // Rebind click handler to open the results modal from now on
            const myResultsBtn = deliverButton.cloneNode(true);
            deliverButton.parentNode.replaceChild(myResultsBtn, deliverButton);
            myResultsBtn.addEventListener('click', () => {
                const modalEl = document.getElementById('result-modal');
                if (modalEl) modalEl.style.display = 'flex';
            });

            // Open the modal immediately after grading
            modal.style.display = 'flex';
        }
        
        function startTimer() {
            timerInterval = setInterval(() => {
                timeInSeconds--;
                const minutes = Math.floor(timeInSeconds / 60);
                const seconds = timeInSeconds % 60;
                timerDisplay.textContent = `${minutes}:${seconds < 10 ? '0' : ''}${seconds}`;
                if (timeInSeconds <= 0) {
                    clearInterval(timerInterval);
                    timerDisplay.textContent = "Time's up!";
                    checkAnswers();
                }
            }, 1000);
        }

        function formatTime(seconds) {
            const minutes = Math.floor(seconds / 60);
            const remainingSeconds = Math.floor(seconds % 60);
            return `${minutes}:${remainingSeconds < 10 ? '0' : ''}${remainingSeconds}`;
        }

        // Event Listeners
        playPauseBtn.addEventListener('click', () => {
            if (!testStarted) {
                testStarted = true; // Timer removed, skip startTimer
                switchToPart(currentPart, true);
            } else {
                if (audioPlayer.paused) {
                    // If paused, ensure the audio source is for the current part
                    if (!audioPlayer.src.includes(audioSource)) {
                        audioPlayer.src = audioSource;
                    }
                    audioPlayer.play();
                } else {
                    audioPlayer.pause();
                }
            }
        });
        
        audioPlayer.addEventListener('play', () => {
            playPauseBtn.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z"/></svg>`;
        });

        audioPlayer.addEventListener('pause', () => {
            playPauseBtn.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8 5v14l11-7z"/></svg>`;
        });

        audioPlayer.addEventListener('ended', () => {
            if (currentPart < 4) {
                switchToPart(currentPart + 1, true);
            }
        });

        audioPlayer.addEventListener('loadedmetadata', () => {
            progressBar.max = audioPlayer.duration;
            totalDurationEl.textContent = formatTime(audioPlayer.duration);
        });

        audioPlayer.addEventListener('timeupdate', () => {
            progressBar.value = audioPlayer.currentTime;
            currentTimeEl.textContent = formatTime(audioPlayer.currentTime);
        });

        progressBar.addEventListener('input', () => {
            audioPlayer.currentTime = progressBar.value;
        });

        volumeSlider.addEventListener('input', (e) => audioPlayer.volume = e.target.value);

        speedBtn.addEventListener('click', (e) => {
            e.stopPropagation();
            speedOptions.classList.toggle('hidden');
        });

        speedOptions.addEventListener('click', (e) => {
            if (e.target.dataset.speed) {
                const speed = parseFloat(e.target.dataset.speed);
                audioPlayer.playbackRate = speed;
                speedBtn.textContent = `${speed}x`;
                speedOptions.classList.add('hidden');
            }
        });
        
        document.addEventListener('click', () => {
            if (!speedOptions.classList.contains('hidden')) {
                speedOptions.classList.add('hidden');
            }
        });

        document.getElementById('deliver-button').addEventListener('click', checkAnswers);
        
        // ===== Drag & Drop handlers for Questions 17-20 =====
        (function initDragDrop(){
            // make items draggable with data transfer id
            function handleDragStart(e){
                const id = e.target.id;
                if (!id) {
                    // ensure each option has an id
                    const letter = e.target.getAttribute('data-letter') || e.target.getAttribute('data-value');
                    e.target.id = 'opt_' + letter;
                }
                e.dataTransfer.setData('text/plain', e.target.id);
            }
            function handleDragOver(e){
                e.preventDefault();
                const zone = e.currentTarget;
                zone.classList.add('drag-over');
            }
            function handleDragLeave(e){
                e.currentTarget.classList.remove('drag-over');
            }
            function placeItemInZone(itemEl, zone){
                // Only allow one item per zone
                const existing = zone.querySelector('.drag-item');
                if (existing){
                    // move existing back to options box
                    const partId = zone.closest('.question-part').id;
                    const bank = partId === 'part-2' ? document.getElementById('part2-options-box') : document.getElementById('part3-options-box');
                    if (bank) bank.appendChild(existing);
                }
                // ensure letter badge is visible along with text
                // keep full item so it remains draggable and shows its letter
                itemEl.classList.add('in-zone');
                zone.textContent = '';
                zone.appendChild(itemEl);
                // sync hidden input for this question
                const qid = zone.getAttribute('data-question-id') || zone.getAttribute('data-question');
                const hidden = document.getElementById('q' + qid);
                if (hidden){
                    const letter = itemEl.getAttribute('data-letter') || itemEl.getAttribute('data-value');
                    hidden.value = letter;
                }
                updateAnsweredIndicators();
            }
            function handleDrop(e){
                e.preventDefault();
                const zone = e.currentTarget;
                zone.classList.remove('drag-over');
                const id = e.dataTransfer.getData('text/plain');
                const itemEl = document.getElementById(id);
                if (!itemEl) return;
                placeItemInZone(itemEl, zone);
                const ph = zone.querySelector('.placeholder');
                if (ph) ph.style.display = 'none';
            }
            function handleBankDrop(e){
                e.preventDefault();
                const bank = e.currentTarget;
                const id = e.dataTransfer.getData('text/plain');
                const itemEl = document.getElementById(id);
                if (!itemEl) return;
                // If coming from a zone, clear that zone's hidden input
                const fromZone = itemEl.parentElement && itemEl.parentElement.classList.contains('drop-zone') ? itemEl.parentElement : null;
                if (fromZone){
                    const qid = fromZone.getAttribute('data-question-id') || fromZone.getAttribute('data-question');
                    const hidden = document.getElementById('q' + qid);
                    if (hidden) hidden.value = '';
                    // Restore the drop zone to show placeholder
                    fromZone.classList.remove('filled');
                    fromZone.innerHTML = '';
                    const placeholder = document.createElement('span');
                    placeholder.className = 'placeholder';
                    placeholder.innerHTML = '&nbsp;';
                    fromZone.appendChild(placeholder);
                }
                itemEl.classList.remove('in-zone');
                bank.appendChild(itemEl);
                updateAnsweredIndicators();
            }
            // Attach listeners for Part 2
            document.querySelectorAll('#part-2 .drag-item').forEach(el=>{
                el.addEventListener('dragstart', handleDragStart);
            });
            document.querySelectorAll('#part-2 .drop-zone').forEach(zone=>{
                zone.addEventListener('dragover', handleDragOver);
                zone.addEventListener('dragleave', handleDragLeave);
                zone.addEventListener('drop', handleDrop);
            });
            const bank2 = document.getElementById('part2-options-box');
            if (bank2){
                bank2.addEventListener('dragover', handleDragOver);
                bank2.addEventListener('dragleave', handleDragLeave);
                bank2.addEventListener('drop', handleBankDrop);
            }
            
            // Attach listeners for Part 3
            document.querySelectorAll('#part-3 .drag-item').forEach(el=>{
                el.addEventListener('dragstart', handleDragStart);
            });
            document.querySelectorAll('#part-3 .drop-zone').forEach(zone=>{
                zone.addEventListener('dragover', handleDragOver);
                zone.addEventListener('dragleave', handleDragLeave);
                zone.addEventListener('drop', handleDrop);
            });
            const bank3 = document.getElementById('part3-options-box');
            if (bank3){
                bank3.addEventListener('dragover', handleDragOver);
                bank3.addEventListener('dragleave', handleDragLeave);
                bank3.addEventListener('drop', handleBankDrop);
            }
        })();
        
        // Go To Question Widget Logic
        const gotoWidget = document.getElementById('goto-widget');
        const gotoInput = document.getElementById('goto-input');
        const gotoBtn = document.getElementById('goto-btn');

        document.addEventListener('keydown', (e) => {
            if (e.key >= '0' && e.key <= '9' && document.activeElement.tagName !== 'INPUT') {
                e.preventDefault();
                gotoWidget.classList.remove('hidden');
                gotoInput.focus();
                gotoInput.value = e.key;
            }
            if (e.key === 'Enter' && document.activeElement === gotoInput) {
                gotoBtn.click();
            }
            if (e.key === 'Escape') {
                gotoWidget.classList.add('hidden');
                gotoInput.value = '';
            }
        });

        if (gotoBtn) {
            gotoBtn.addEventListener('click', () => {
                const qNum = parseInt(gotoInput.value, 10);
                if (qNum >= 1 && qNum <= 40) {
                    goToQuestion(qNum);
                    gotoWidget.classList.add('hidden');
                    gotoInput.value = '';
                } else {
                    alert('Please enter a number between 1 and 40.');
                }
            });
        }

        // Add listener for the modal close button
        document.getElementById('modal-close-button').addEventListener('click', () => {
            document.getElementById('result-modal').style.display = 'none';
        });

        // === Tap-to-select & tap-to-drop for drag items (mobile support) ===
            document.body.addEventListener('click', function(e){
            const item = e.target.closest('.drag-item');
            if(item && item.getAttribute('draggable')){
                // Toggle selection
                document.querySelectorAll('.drag-item.selected').forEach(i=>i.classList.remove('selected'));
                item.classList.add('selected');
                draggedElement = item;
                return;
            }
            const dz = e.target.closest('.drop-zone');
            if(dz && draggedElement){
                // Skip if this is a Part 2 drop zone (let the Part 2 specific handler handle it)
                if (dz.closest('#part-2')) {
                    return;
                }
                // If already filled, move old back
                const container = dz.closest('.matching-container') || dz.closest('.matching-question-container') || document;
                const optionsList = container.querySelector('.matching-options-list') || document.querySelector('.matching-options-list');
                if(dz.children.length>0 && dz.firstElementChild!==draggedElement){
                    // restore original label (with letter) when returning to bank
                    const old = dz.firstElementChild;
                    if (old && old.dataset && old.dataset.fullLabel) {
                        old.textContent = old.dataset.fullLabel;
                    }
                    optionsList.appendChild(old);
                    // clear hidden value for the zone now emptied
                    const qIdOld = dz.getAttribute('data-question-id');
                    const hiddenOld = document.getElementById(`q${qIdOld}`);
                    if (hiddenOld) hiddenOld.value = '';
                    // Restore the drop zone to show placeholder
                    dz.classList.remove('filled');
                    dz.innerHTML = '';
                    const placeholder = document.createElement('span');
                    placeholder.className = 'placeholder';
                    placeholder.innerHTML = '&nbsp;';
                    dz.appendChild(placeholder);
                }
                // save full label before mutating
                if (!draggedElement.dataset.fullLabel) {
                    draggedElement.dataset.fullLabel = draggedElement.textContent.trim();
                }
                // show only the option text (strip leading "A. ", "B. ", etc.)
                const full = draggedElement.dataset.fullLabel;
                const letter = (full.match(/^\s*([A-G])\s*[\.)-]?/i) || [,''])[1].toUpperCase();
                const plain = full.replace(/^\s*[A-G]\s*[\.)-]?\s*/i, '');
                if (!draggedElement.dataset.letter && letter) {
                    draggedElement.dataset.letter = letter;
                }
                                    // Create a new element with the letter pill and plain text
                    const newElement = document.createElement('div');
                    newElement.className = 'drag-item';
                    newElement.setAttribute('draggable', 'true');
                    newElement.setAttribute('data-letter', letter);
                    newElement.setAttribute('data-value', letter);
                    newElement.setAttribute('data-fullLabel', full);
                    newElement.style.width = 'auto';
                    newElement.style.minWidth = 'fit-content';
                    
                    // Create the letter pill
                    const letterPill = document.createElement('span');
                    letterPill.className = 'drop-letter';
                    letterPill.textContent = letter;
                    
                    // Create the text span
                    const textSpan = document.createElement('span');
                    textSpan.textContent = plain;
                    textSpan.style.marginLeft = '8px';
                    textSpan.style.whiteSpace = 'nowrap';
                    
                    newElement.appendChild(letterPill);
                    newElement.appendChild(textSpan);
                    
                    // Replace the original element
                    draggedElement.parentNode.replaceChild(newElement, draggedElement);
                    draggedElement = newElement;
                dz.appendChild(draggedElement);
                draggedElement.classList.remove('selected');
                draggedElement=null;
                // style as filled pill and hide placeholder
                dz.classList.add('filled');
                const placeholder = dz.querySelector('.placeholder');
                if (placeholder) placeholder.style.display = 'none';
                // sync hidden input to the letter
                const qId = dz.getAttribute('data-question-id');
                const hiddenInput = document.getElementById(`q${qId}`);
                if (hiddenInput) hiddenInput.value = letter || '';
                updateAnsweredIndicators();
            }
        });

        // === Mobile highlight/comment toolbar ===
        const mobileToolbar = document.getElementById('mobile-selection-menu');
        function positionToolbar(){
            const sel = window.getSelection();
            if(sel.rangeCount===0 || sel.isCollapsed){
                mobileToolbar.classList.add('hidden');
                return;
            }
            const range = sel.getRangeAt(0);
            const rect = range.getBoundingClientRect();
            mobileToolbar.style.top = window.scrollY + rect.top - mobileToolbar.offsetHeight - 8 + 'px';
            mobileToolbar.style.left = window.scrollX + rect.left + 'px';
            mobileToolbar.classList.remove('hidden');
        }
        document.addEventListener('selectionchange', () => {
            const sel = window.getSelection();
            if(sel && sel.rangeCount>0 && !sel.isCollapsed){
                selectedRange = sel.getRangeAt(0);
                selectedText = sel.toString();
            }
            if('ontouchstart' in window || navigator.maxTouchPoints>0){
                setTimeout(positionToolbar, 0);
            }
        });
        document.addEventListener('click', (e)=>{
            if(!e.target.closest('#mobile-selection-menu')){
                mobileToolbar.classList.add('hidden');
            }
        });

        /* ---------------- Drag and Drop for Matching Questions ---------------- */

        (function initDragAndDrop() {
            const container = document.querySelector('.left-panel');
            if (!container) return;

            container.addEventListener('dragstart', (e) => {
                if (e.target.classList.contains('drag-item')) {
                    draggedElement = e.target;
                    setTimeout(() => {
                        e.target.classList.add('dragging');
                    }, 0);
                }
            });

            container.addEventListener('dragend', (e) => {
                if (draggedElement) {
                    draggedElement.classList.remove('dragging');
                    draggedElement = null;
                }
            });

            container.addEventListener('dragover', (e) => {
                e.preventDefault();
                const target = e.target;
                const dropZone = target.closest('.drop-zone');
                const optionsList = target.closest('.matching-options-list');

                if (dropZone || optionsList) {
                    const overElement = dropZone || optionsList;
                    document.querySelectorAll('.drag-over').forEach(el => el.classList.remove('drag-over'));
                    overElement.classList.add('drag-over');
                }
            });

            container.addEventListener('dragleave', (e) => {
                const target = e.target;
                const dropZone = target.closest('.drop-zone');
                const optionsList = target.closest('.matching-options-list');
                if (dropZone || optionsList) {
                    const overElement = dropZone || optionsList;
                    overElement.classList.remove('drag-over');
                }
            });


            container.addEventListener('drop', (e) => {
                e.preventDefault();
                if (!draggedElement) return;

                const dropTarget = e.target.closest('.drop-zone, .matching-options-list');
                if (!dropTarget) {
                    draggedElement.classList.remove('dragging');
                    draggedElement = null;
                    return;
                }

                // Skip if this is a Part 2 drop zone (let the Part 2 specific handler handle it)
                if (dropTarget.closest('#part-2')) {
                    draggedElement.classList.remove('dragging');
                    draggedElement = null;
                    return;
                }

                document.querySelectorAll('.drag-over').forEach(el => el.classList.remove('drag-over'));
                
                const existingItem = dropTarget.matches('.drop-zone') ? dropTarget.querySelector('.drag-item') : null;
                const originalParent = draggedElement.parentNode;

                // If there's an item in the target dropzone, swap them
                if (existingItem) {
                    // when moving existing item back, restore its full label
                    if (existingItem.dataset && existingItem.dataset.fullLabel) {
                        existingItem.textContent = existingItem.dataset.fullLabel;
                    }
                    
                    // If the original parent is a drop-zone, we need to handle it properly
                    if (originalParent.classList && originalParent.classList.contains('drop-zone')) {
                        // Clear the original drop zone first
                        originalParent.innerHTML = '';
                        originalParent.classList.remove('filled');
                        
                        // Restore placeholder
                        const placeholder = document.createElement('span');
                        placeholder.className = 'placeholder';
                        placeholder.innerHTML = '&nbsp;';
                        originalParent.appendChild(placeholder);
                        
                        // Clear the hidden input
                        const qId = originalParent.getAttribute('data-question-id');
                        const hiddenInput = document.getElementById(`q${qId}`);
                        if (hiddenInput) hiddenInput.value = '';
                        
                        // Now place the existing item in the original drop zone
                        originalParent.appendChild(existingItem);
                        
                        // Update the original drop zone to show it's filled
                        originalParent.classList.add('filled');
                        if (placeholder) placeholder.style.display = 'none';
                        
                        // Update the hidden input for the original drop zone
                        const existingItemValue = existingItem.getAttribute('data-value') || 
                                               existingItem.getAttribute('data-letter') || 
                                               (existingItem.dataset.fullLabel ? existingItem.dataset.fullLabel.trim().charAt(0).toUpperCase() : '');
                        if (hiddenInput) hiddenInput.value = existingItemValue;
                    } else {
                        // If original parent is not a drop zone, just append normally
                        originalParent.appendChild(existingItem);
                    }
                } else {
                    // If there's no existing item in the target drop zone, but the dragged item is coming from a drop zone,
                    // we need to restore the original drop zone to its empty state
                    if (originalParent.classList && originalParent.classList.contains('drop-zone')) {
                        // Clear the original drop zone
                        originalParent.innerHTML = '';
                        originalParent.classList.remove('filled');
                        
                        // Restore placeholder
                        const placeholder = document.createElement('span');
                        placeholder.className = 'placeholder';
                        placeholder.innerHTML = '&nbsp;';
                        originalParent.appendChild(placeholder);
                        
                        // Clear the hidden input
                        const qId = originalParent.getAttribute('data-question-id');
                        const hiddenInput = document.getElementById(`q${qId}`);
                        if (hiddenInput) hiddenInput.value = '';
                    }
                }
                
                dropTarget.appendChild(draggedElement);

                if(dropTarget.matches('.drop-zone')) {
                    const placeholder = dropTarget.querySelector('.placeholder');
                    if (placeholder) placeholder.style.display = 'none';
                    dropTarget.classList.add('filled');
                    // save full label once and show plain text only inside zone
                    if (!draggedElement.dataset.fullLabel) {
                        draggedElement.dataset.fullLabel = draggedElement.textContent.trim();
                    }
                    const full = draggedElement.dataset.fullLabel;
                    const letter = (full.match(/^\s*([A-G])\s*[\.)-]?/i) || [,''])[1].toUpperCase();
                    const plain = full.replace(/^\s*[A-G]\s*[\.)-]?\s*/i, '');
                    if (!draggedElement.dataset.letter && letter) {
                        draggedElement.dataset.letter = letter;
                    }
                    // Create a new element with the letter pill and plain text
                    const newElement = document.createElement('div');
                    newElement.className = 'drag-item';
                    newElement.setAttribute('draggable', 'true');
                    newElement.setAttribute('data-letter', letter);
                    newElement.setAttribute('data-value', letter);
                    newElement.setAttribute('data-fullLabel', full);
                    newElement.style.width = 'auto';
                    newElement.style.minWidth = 'fit-content';
                    
                    // Create the letter pill
                    const letterPill = document.createElement('span');
                    letterPill.className = 'drop-letter';
                    letterPill.textContent = letter;
                    
                    // Create the text span
                    const textSpan = document.createElement('span');
                    textSpan.textContent = plain;
                    textSpan.style.marginLeft = '8px';
                    textSpan.style.whiteSpace = 'nowrap';
                    
                    newElement.appendChild(letterPill);
                    newElement.appendChild(textSpan);
                    
                    // Replace the original element
                    draggedElement.parentNode.replaceChild(newElement, draggedElement);
                    draggedElement = newElement;
                    // sync hidden input (use data-letter if present, else text)
                    const qId = dropTarget.getAttribute('data-question-id');
                    const hiddenInput = document.getElementById(`q${qId}`);
                    if (hiddenInput) {
                        const val = draggedElement.getAttribute('data-letter') || letter || (draggedElement.dataset.fullLabel ? draggedElement.dataset.fullLabel.trim().charAt(0).toUpperCase() : draggedElement.textContent.trim());
                        hiddenInput.value = val;
                    }
                }

                draggedElement.classList.remove('dragging');
                draggedElement = null;
                updateAnsweredIndicators();
            });
        })();


        document.addEventListener('DOMContentLoaded', () => {
            switchToPart(1);
            goToQuestion(1);
            setupCheckboxLimits();
            
            // Initialize drag and drop and clickable cells
            initAllDragAndDrop();
            ensureClickableHiddenInputs();
            
            // Test clickable cells after a short delay
            setTimeout(() => {
                testClickableCells();
            }, 1000);

            document.body.addEventListener('contextmenu', function (e) {
                const text = window.getSelection().toString();
                if (!text) return;
                e.preventDefault();
                const menu = document.getElementById('contextMenu');
                menu.style.left = e.pageX + 'px';
                menu.style.top = e.pageY + 'px';
                menu.style.display = 'block';

                const target = e.target;
                const clearItem = document.getElementById('clear-item');
                contextElement = target.closest('.highlight, .comment-highlight');
                if(contextElement){
                    clearItem.style.display = 'block';
                } else {
                    clearItem.style.display = 'none';
                }
            });
            
            document.body.addEventListener('click', function(e) {
                if (e.target.closest('.context-menu')) return;
                document.getElementById('contextMenu').style.display = 'none';
            });
        });

        // Initial setup on DOM load
        document.addEventListener('DOMContentLoaded', function() {
            updateAnsweredIndicators();
            ensureClickableHiddenInputs();
            
            // Add specific event listeners for questions 17-20 radio buttons
            document.querySelectorAll('input[name="q17"], input[name="q18"], input[name="q19"], input[name="q20"]').forEach(radio => {
                radio.addEventListener('change', function() {
                    const questionNumber = this.name.substring(1); // Remove 'q' prefix
                    const hiddenInput = document.getElementById(`q${questionNumber}`);
                    if (hiddenInput) {
                        hiddenInput.value = this.value;
                        console.log(`Question ${questionNumber} selected: ${this.value}`);
                    }
                });
            });
        });

        document.querySelectorAll('.mcq-table td').forEach(cell => {
            cell.addEventListener('click', (e) => {
                if (e.target.tagName !== 'INPUT') {
                    const radio = cell.querySelector('input[type="radio"]');
                    if (radio && !radio.disabled) {
                        radio.checked = true;
                    }
                }
            });
        });

        document.querySelectorAll('.answer-input, input[type="radio"], input[type="checkbox"], select').forEach(input => {
            input.addEventListener('input', updateAnsweredIndicators);
            input.addEventListener('change', updateAnsweredIndicators);
        });

        function initAllDragAndDrop() {
            // Initialize clickable cells for questions 27-31
            initClickableCells();
            
            // Add event listeners for map questions (11-15)
            for (let i = 11; i <= 15; i++) {
                const selectElement = document.getElementById(`q${i}`);
                if (selectElement) {
                    selectElement.addEventListener('change', updateAnsweredIndicators);
                }
            }
        }

        function initClickableCells() {
            const clickableCells = document.querySelectorAll('.clickable-cell');
            clickableCells.forEach(cell => {
                cell.addEventListener('click', function() {
                    const questionNumber = this.getAttribute('data-question');
                    const value = this.getAttribute('data-value');
                    selectCell(this, questionNumber, value);
                });
            });
        }


        function ensureClickableHiddenInputs() {
            for (let q = 26; q <= 30; q++) {
                if (!document.getElementById(`q${q}`)) {
                    const input = document.createElement('input');
                    input.type = 'hidden';
                    input.id = `q${q}`;
                    document.body.appendChild(input);
                }
            }
        }

        // Initialize matching cells when DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            // This is now handled by initClickableCells() which is called in initAllDragAndDrop()
        });

        function findParentOptionsList(element) {
            // Specific for map
            if (element.closest('#map-drag-container')) {
                return document.getElementById('map-options-q11-15');
            }
            // Specific for Part 3
            if (element.closest('#part-3')) {
                return document.getElementById('part3-options-box');
            }
            // Generic for matching
            const container = element.closest('.matching-container');
            if (container) {
                return container.querySelector('.matching-options-list');
            }
            return null;
        }

        let transcriptionHighlighted = false;
        function highlightAnswersInTranscription() {
            if (transcriptionHighlighted) return;

            const highlightedTranscripts = { 1: '', 2: '', 3: '', 4: '' };

            for (let i = 1; i <= 4; i++) {
                const partElement = document.querySelector(`#transcription-data [data-part="${i}"]`);
                if (partElement) highlightedTranscripts[i] = partElement.innerHTML;
            }

            for (const key in correctAnswers) {
                const answers = Array.isArray(correctAnswers[key]) ? correctAnswers[key] : [correctAnswers[key]];
                if (answers.every(answer => /^[A-G]$/.test(answer))) {
                    continue;
                }

                const qNum = parseInt(key.match(/\d+/)[0]);
                let partNumber = 1;
                if (qNum > 10 && qNum <= 20) partNumber = 2;
                else if (qNum > 20 && qNum <= 30) partNumber = 3;
                else if (qNum > 30) partNumber = 4;

                if (!highlightedTranscripts[partNumber]) continue;

                let answersToHighlight = correctAnswers[key];
                if (!Array.isArray(answersToHighlight)) {
                    answersToHighlight = [answersToHighlight];
                }

                for (const answer of answersToHighlight) {
                    if (/^[A-G]$/.test(answer)) continue;
                    
                    let searchTerm = answer.replace(/[-\/\\^$*+?.()|[\]{}]/g, '\\$&');
                    searchTerm = searchTerm.replace(/\\\(s\\\)/g, '(s)?');
                    
                    const regex = new RegExp(`\\b(${searchTerm})\\b`, 'gi');
                    
                    highlightedTranscripts[partNumber] = highlightedTranscripts[partNumber].replace(
                        regex,
                        '<span class="highlight">$1</span>'
                    );
                }
            }

            for (let i = 1; i <= 4; i++) {
                const partElement = document.querySelector(`#transcription-data [data-part="${i}"]`);
                if(partElement) partElement.innerHTML = highlightedTranscripts[i];
            }
            transcriptionHighlighted = true;
        }
        
        function closeContextMenu() {
            document.getElementById('contextMenu').style.display = 'none';
            contextElement = null;
        }
        
// ========== SIMPLE AUTOSAVE ==========
(function() {
    console.log('🔄 Autosave initialized');
    
    // Save to localStorage every 30 seconds
    const AUTOSAVE_INTERVAL = 30000; // 30 seconds
    const STORAGE_KEY = 'ielts-reading-autosave';
    
    // Function to save all answers
    function saveAnswers() {
        const saveData = {
            timestamp: new Date().toISOString(),
            answers: {}
        };
        
        // Save text inputs
        document.querySelectorAll('.answer-input[type="text"]').forEach(input => {
            if (input.value.trim()) {
                saveData.answers[input.id] = input.value;
            }
        });
        
        // Save select dropdowns
        document.querySelectorAll('.answer-input[type="select"], select.answer-input').forEach(select => {
            if (select.value) {
                saveData.answers[select.id] = select.value;
            }
        });
        
        // Save radio buttons
        document.querySelectorAll('input[type="radio"]:checked').forEach(radio => {
            saveData.answers[radio.name] = radio.value;
        });
        
        // Save drag & drop answers
        document.querySelectorAll('.drop-zone.filled .drag-item').forEach(item => {
            const dropZone = item.closest('.drop-zone, .summary-drop-zone');
            const questionId = dropZone?.dataset.qStart || dropZone?.dataset.question;
            if (questionId) {
                saveData.answers[`drag-${questionId}`] = item.dataset.value;
            }
        });
        
        // Save to localStorage
        localStorage.setItem(STORAGE_KEY, JSON.stringify(saveData));
        console.log('💾 Autosaved at', new Date().toLocaleTimeString());
    }
    
    // Function to load saved answers
    function loadSavedAnswers() {
        const saved = localStorage.getItem(STORAGE_KEY);
        if (!saved) {
            console.log('📭 No saved data found');
            return;
        }
        
        try {
            const saveData = JSON.parse(saved);
            const answers = saveData.answers;
            
            // Load text inputs
            Object.keys(answers).forEach(key => {
                if (key.startsWith('q')) {
                    const input = document.getElementById(key);
                    if (input && (input.type === 'text' || input.tagName === 'SELECT')) {
                        input.value = answers[key];
                    }
                }
                
                // Load radio buttons
                if (!key.startsWith('drag-')) {
                    const radio = document.querySelector(`input[name="${key}"][value="${answers[key]}"]`);
                    if (radio) radio.checked = true;
                }
                
                // Load drag & drop (simplified - just marks as answered)
                if (key.startsWith('drag-')) {
                    const questionNum = key.replace('drag-', '');
                    const navBtn = document.querySelector(`.subQuestion[onclick="goToQuestion(${questionNum})"]`);
                    if (navBtn) navBtn.classList.add('answered');
                }
            });
            
            console.log('📂 Loaded saved answers from', new Date(saveData.timestamp).toLocaleString());
            updateAllIndicators(); // Update the answer counts
        } catch (error) {
            console.error('❌ Error loading saved answers:', error);
        }
    }
    
    // Auto-save every 30 seconds
    setInterval(saveAnswers, AUTOSAVE_INTERVAL);
    
    // Save when user leaves the page
    window.addEventListener('beforeunload', saveAnswers);
    
    // Save when user interacts with inputs
    document.addEventListener('input', () => {
        clearTimeout(window.saveTimeout);
        window.saveTimeout = setTimeout(saveAnswers, 2000); // Debounce: save 2 seconds after last input
    });
    
    // Load saved answers when page loads
    setTimeout(loadSavedAnswers, 500); // Small delay to ensure DOM is ready
    
    // Add a simple status indicator to the timer area
    const statusIndicator = document.createElement('span');
    statusIndicator.id = 'autosave-status';
    statusIndicator.style.cssText = 'margin-left: 15px; font-size: 12px; color: #666;';
    statusIndicator.innerHTML = '💾 Autosave: <span style="color: green;">ON</span>';
    document.querySelector('.timer-container').appendChild(statusIndicator);
    
    // Visual feedback when saving
    let saveCount = 0;
    setInterval(() => {
        const statusText = statusIndicator.querySelector('span');
        if (saveCount % 2 === 0) {
            statusText.style.color = '#4CAF50';
            statusText.textContent = 'ON';
        } else {
            statusText.style.color = '#666';
            statusText.textContent = 'ON';
        }
        saveCount++;
    }, 15000);
    
    console.log('✅ Autosave enabled - saving every 30 seconds');
})();
    </script>
</body>
</html>
